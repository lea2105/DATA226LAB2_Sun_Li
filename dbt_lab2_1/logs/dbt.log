[0m00:56:08.004629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c590>]}


============================== 00:56:08.011843 | 1c3d0db0-9174-471d-9855-68806eb270bd ==============================
[0m00:56:08.011843 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:56:08.012907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:56:08.018360 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m00:56:08.036821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.104834795, "process_in_blocks": "0", "process_kernel_time": 0.262119, "process_mem_max_rss": "106561536", "process_out_blocks": "0", "process_user_time": 1.141815}
[0m00:56:08.037421 [debug] [MainThread]: Command `dbt run` failed at 00:56:08.037332 after 0.11 seconds
[0m00:56:08.037716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c980>]}
[0m00:56:08.038003 [debug] [MainThread]: Flushing usage events
[0m00:56:08.464496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:56.221459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ffc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ffed0>]}


============================== 01:11:56.225850 | ede5cb16-a700-4f04-ae40-3fbe8193da03 ==============================
[0m01:11:56.225850 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:11:56.226347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:11:56.230242 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m01:11:56.232715 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.07242537, "process_in_blocks": "0", "process_kernel_time": 0.164423, "process_mem_max_rss": "91193344", "process_out_blocks": "0", "process_user_time": 1.039397}
[0m01:11:56.233119 [debug] [MainThread]: Command `dbt seed` failed at 01:11:56.233038 after 0.07 seconds
[0m01:11:56.233394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936ce20>]}
[0m01:11:56.233839 [debug] [MainThread]: Flushing usage events
[0m01:11:56.586273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:12:37.232992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9fed0>]}


============================== 01:12:37.237263 | 076eb7c7-50e8-4ac2-9e84-7cc0d512b798 ==============================
[0m01:12:37.237263 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:12:37.237750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:12:38.238819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '076eb7c7-50e8-4ac2-9e84-7cc0d512b798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0bbbb0>]}
[0m01:12:38.344222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '076eb7c7-50e8-4ac2-9e84-7cc0d512b798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7de580>]}
[0m01:12:38.345265 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:12:38.448080 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:12:38.448786 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:12:38.449078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '076eb7c7-50e8-4ac2-9e84-7cc0d512b798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c024f50>]}
[0m01:12:39.361273 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'stock_data_source.daily_prices' which was not found
[0m01:12:39.363543 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.1903908, "process_in_blocks": "0", "process_kernel_time": 0.290929, "process_mem_max_rss": "131907584", "process_out_blocks": "0", "process_user_time": 2.21158}
[0m01:12:39.363896 [debug] [MainThread]: Command `dbt seed` failed at 01:12:39.363813 after 2.19 seconds
[0m01:12:39.364174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b79b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e87e70>]}
[0m01:12:39.364654 [debug] [MainThread]: Flushing usage events
[0m01:12:39.718397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:52.730854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108853c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108853ed0>]}


============================== 01:13:52.735142 | c1229140-1c52-44ca-a1fa-7fb350279170 ==============================
[0m01:13:52.735142 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:13:52.735623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:13:53.146894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1229140-1c52-44ca-a1fa-7fb350279170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109757bb0>]}
[0m01:13:53.188557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1229140-1c52-44ca-a1fa-7fb350279170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109606580>]}
[0m01:13:53.189485 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:13:53.273557 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:13:53.274233 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:13:53.274517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1229140-1c52-44ca-a1fa-7fb350279170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c0f50>]}
[0m01:13:54.209780 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:13:54.212248 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.5402951, "process_in_blocks": "0", "process_kernel_time": 0.248352, "process_mem_max_rss": "131203072", "process_out_blocks": "0", "process_user_time": 2.179853}
[0m01:13:54.212626 [debug] [MainThread]: Command `dbt seed` failed at 01:13:54.212546 after 1.54 seconds
[0m01:13:54.212926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097523f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873be70>]}
[0m01:13:54.213195 [debug] [MainThread]: Flushing usage events
[0m01:13:54.721664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:20.743574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088abed0>]}


============================== 01:14:20.748598 | dfdf954b-2043-4258-a11b-fd5308a98c88 ==============================
[0m01:14:20.748598 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:14:20.749306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:14:21.285191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfdf954b-2043-4258-a11b-fd5308a98c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097afbb0>]}
[0m01:14:21.328615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfdf954b-2043-4258-a11b-fd5308a98c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965e580>]}
[0m01:14:21.329551 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:14:21.447325 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:14:21.448081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:14:21.448382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfdf954b-2043-4258-a11b-fd5308a98c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971cf50>]}
[0m01:14:22.497802 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'user_db_marmot.lab2_stock_data' which was not found
[0m01:14:22.501162 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.8215644, "process_in_blocks": "0", "process_kernel_time": 0.299535, "process_mem_max_rss": "122224640", "process_out_blocks": "0", "process_user_time": 2.307016}
[0m01:14:22.501559 [debug] [MainThread]: Command `dbt seed` failed at 01:14:22.501479 after 1.82 seconds
[0m01:14:22.501879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109613890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097aa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108793e70>]}
[0m01:14:22.502161 [debug] [MainThread]: Flushing usage events
[0m01:14:22.845185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:55.176766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118246510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bbbed0>]}


============================== 01:15:55.181646 | d5e16073-b55f-4e22-9a22-2f140a5174c9 ==============================
[0m01:15:55.181646 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:15:55.182249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:15:55.906440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5e16073-b55f-4e22-9a22-2f140a5174c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfbbbb0>]}
[0m01:15:55.962206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5e16073-b55f-4e22-9a22-2f140a5174c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cede580>]}
[0m01:15:55.963644 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:15:56.090752 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:15:56.091559 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:15:56.091892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5e16073-b55f-4e22-9a22-2f140a5174c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cf28f50>]}
[0m01:15:57.202579 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'user_db_marmot.lab2_stock_data' which was not found
[0m01:15:57.205511 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.097278, "process_in_blocks": "0", "process_kernel_time": 0.497, "process_mem_max_rss": "120143872", "process_out_blocks": "0", "process_user_time": 2.709444}
[0m01:15:57.205960 [debug] [MainThread]: Command `dbt seed` failed at 01:15:57.205854 after 2.10 seconds
[0m01:15:57.206350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce9b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfb63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199a3e70>]}
[0m01:15:57.206670 [debug] [MainThread]: Flushing usage events
[0m01:15:57.737648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:10.833331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104946510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbbed0>]}


============================== 01:31:10.838003 | 93fa0b18-fbb5-4c2e-bd2a-f5c5059b7a00 ==============================
[0m01:31:10.838003 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:31:10.838482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:11.248137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93fa0b18-fbb5-4c2e-bd2a-f5c5059b7a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188bbbb0>]}
[0m01:31:11.291616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93fa0b18-fbb5-4c2e-bd2a-f5c5059b7a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187e2580>]}
[0m01:31:11.292527 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:31:11.381237 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:31:11.381929 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:31:11.382215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93fa0b18-fbb5-4c2e-bd2a-f5c5059b7a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118828f50>]}
[0m01:31:12.304188 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'user_db_marmot.lab2_stock_data' which was not found
[0m01:31:12.306460 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.5341729, "process_in_blocks": "0", "process_kernel_time": 0.288777, "process_mem_max_rss": "129843200", "process_out_blocks": "0", "process_user_time": 2.181364}
[0m01:31:12.306859 [debug] [MainThread]: Command `dbt seed` failed at 01:31:12.306774 after 1.53 seconds
[0m01:31:12.307150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11879b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188b63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba3e70>]}
[0m01:31:12.307415 [debug] [MainThread]: Flushing usage events
[0m01:31:12.702073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:45.859065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbed0>]}


============================== 01:31:45.863539 | 8fe87342-933a-44ba-a948-2a90037c4975 ==============================
[0m01:31:45.863539 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:31:45.864078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:31:46.263680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fe87342-933a-44ba-a948-2a90037c4975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e33bb0>]}
[0m01:31:46.304663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fe87342-933a-44ba-a948-2a90037c4975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce2580>]}
[0m01:31:46.305430 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:31:46.390629 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:31:46.391312 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:31:46.391595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8fe87342-933a-44ba-a948-2a90037c4975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da0f50>]}
[0m01:31:47.321471 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'user_db_marmot.lab2_stock_data' which was not found
[0m01:31:47.326540 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.5260196, "process_in_blocks": "0", "process_kernel_time": 0.278342, "process_mem_max_rss": "131825664", "process_out_blocks": "0", "process_user_time": 2.186425}
[0m01:31:47.326910 [debug] [MainThread]: Command `dbt seed` failed at 01:31:47.326835 after 1.53 seconds
[0m01:31:47.327207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa3e70>]}
[0m01:31:47.327615 [debug] [MainThread]: Flushing usage events
[0m01:31:47.727078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:32:24.909775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f3e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132bbed0>]}


============================== 01:32:24.914020 | 01273dfc-9c9d-4986-ad15-5842a1a6be71 ==============================
[0m01:32:24.914020 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:32:24.914508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:32:25.301853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01273dfc-9c9d-4986-ad15-5842a1a6be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144bbbb0>]}
[0m01:32:25.343484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01273dfc-9c9d-4986-ad15-5842a1a6be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142e2580>]}
[0m01:32:25.344719 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:32:25.428655 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:32:25.429338 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:32:25.429616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01273dfc-9c9d-4986-ad15-5842a1a6be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114428f50>]}
[0m01:32:26.388411 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'stock_data_source.lab2_stock_data' which was not found
[0m01:32:26.390417 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.5397844, "process_in_blocks": "0", "process_kernel_time": 0.248658, "process_mem_max_rss": "131006464", "process_out_blocks": "0", "process_user_time": 2.182032}
[0m01:32:26.390758 [debug] [MainThread]: Command `dbt seed` failed at 01:32:26.390687 after 1.54 seconds
[0m01:32:26.391038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114297890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a3e70>]}
[0m01:32:26.391302 [debug] [MainThread]: Flushing usage events
[0m01:32:26.736583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:32:53.437246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bbed0>]}


============================== 01:32:53.441896 | 2f6b5b33-742c-4c51-913a-425c6e3bfbf4 ==============================
[0m01:32:53.441896 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:32:53.442421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:32:53.857304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f6b5b33-742c-4c51-913a-425c6e3bfbf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126bbbb0>]}
[0m01:32:53.899973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f6b5b33-742c-4c51-913a-425c6e3bfbf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e2580>]}
[0m01:32:53.901628 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:32:54.075767 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:32:54.076571 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:32:54.076951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f6b5b33-742c-4c51-913a-425c6e3bfbf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112628f50>]}
[0m01:32:55.048622 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:32:55.052095 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.6789261, "process_in_blocks": "0", "process_kernel_time": 0.275387, "process_mem_max_rss": "128106496", "process_out_blocks": "0", "process_user_time": 2.283635}
[0m01:32:55.052490 [debug] [MainThread]: Command `dbt seed` failed at 01:32:55.052404 after 1.68 seconds
[0m01:32:55.052804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11259b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126b63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a3e70>]}
[0m01:32:55.053089 [debug] [MainThread]: Flushing usage events
[0m01:32:55.430274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:33:08.537511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105802510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bbed0>]}


============================== 01:33:08.541683 | b05b7ac2-e056-43fe-add7-e26a545fec25 ==============================
[0m01:33:08.541683 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:33:08.542144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:33:08.941557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b05b7ac2-e056-43fe-add7-e26a545fec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cefbb0>]}
[0m01:33:08.982788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b05b7ac2-e056-43fe-add7-e26a545fec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e2580>]}
[0m01:33:08.983590 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:33:09.066573 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:33:09.067247 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:33:09.067529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b05b7ac2-e056-43fe-add7-e26a545fec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5cf50>]}
[0m01:33:10.010756 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:33:10.013095 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.5350351, "process_in_blocks": "0", "process_kernel_time": 0.249391, "process_mem_max_rss": "130777088", "process_out_blocks": "0", "process_user_time": 2.174622}
[0m01:33:10.013476 [debug] [MainThread]: Command `dbt seed` failed at 01:33:10.013400 after 1.54 seconds
[0m01:33:10.013773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11119b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cea3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a3e70>]}
[0m01:33:10.014051 [debug] [MainThread]: Flushing usage events
[0m01:33:10.376391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:13.630961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3bed0>]}


============================== 01:37:13.635230 | 337c06a6-656c-4976-87be-acacfd736c0c ==============================
[0m01:37:13.635230 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:37:13.635707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:37:14.080569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '337c06a6-656c-4976-87be-acacfd736c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593fbb0>]}
[0m01:37:14.121735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '337c06a6-656c-4976-87be-acacfd736c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ee580>]}
[0m01:37:14.122753 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:37:14.206953 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:37:14.207697 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:37:14.208013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '337c06a6-656c-4976-87be-acacfd736c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a8f50>]}
[0m01:37:15.242250 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:37:15.244963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.673101, "process_in_blocks": "0", "process_kernel_time": 0.308099, "process_mem_max_rss": "123584512", "process_out_blocks": "0", "process_user_time": 2.251816}
[0m01:37:15.245327 [debug] [MainThread]: Command `dbt run` failed at 01:37:15.245248 after 1.67 seconds
[0m01:37:15.245690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104923e70>]}
[0m01:37:15.245984 [debug] [MainThread]: Flushing usage events
[0m01:37:15.727974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:55.199839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ca510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725fed0>]}


============================== 01:37:55.204222 | 8de3b000-d022-4d58-9cf1-78f52a0e116c ==============================
[0m01:37:55.204222 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:37:55.204691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:37:55.594791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8de3b000-d022-4d58-9cf1-78f52a0e116c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108163bb0>]}
[0m01:37:55.636079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8de3b000-d022-4d58-9cf1-78f52a0e116c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108012580>]}
[0m01:37:55.636929 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:37:55.721155 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:37:55.721867 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:37:55.722171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8de3b000-d022-4d58-9cf1-78f52a0e116c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d0f50>]}
[0m01:37:56.636783 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:37:56.638538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4983577, "process_in_blocks": "0", "process_kernel_time": 0.257371, "process_mem_max_rss": "132136960", "process_out_blocks": "0", "process_user_time": 2.171365}
[0m01:37:56.638918 [debug] [MainThread]: Command `dbt run` failed at 01:37:56.638832 after 1.50 seconds
[0m01:37:56.639208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147e70>]}
[0m01:37:56.639471 [debug] [MainThread]: Flushing usage events
[0m01:37:56.988084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:45.130609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbed0>]}


============================== 01:38:45.135592 | c84a4aed-aff2-4e65-9708-ab0e75905a90 ==============================
[0m01:38:45.135592 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:38:45.136117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:38:45.724188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84a4aed-aff2-4e65-9708-ab0e75905a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbbbb0>]}
[0m01:38:45.779811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c84a4aed-aff2-4e65-9708-ab0e75905a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bde580>]}
[0m01:38:45.780966 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:38:45.881111 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:38:45.881854 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:38:45.882154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c84a4aed-aff2-4e65-9708-ab0e75905a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c29050>]}
[0m01:38:46.915178 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:38:46.917902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.856542, "process_in_blocks": "0", "process_kernel_time": 0.327083, "process_mem_max_rss": "121339904", "process_out_blocks": "0", "process_user_time": 2.344469}
[0m01:38:46.918426 [debug] [MainThread]: Command `dbt run` failed at 01:38:46.918329 after 1.86 seconds
[0m01:38:46.918787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a3e70>]}
[0m01:38:46.919074 [debug] [MainThread]: Flushing usage events
[0m01:38:47.418699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:23.812609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a76510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690bed0>]}


============================== 01:39:23.817684 | e7fdfa8a-0af4-4e6b-ae2e-699bd4abf72d ==============================
[0m01:39:23.817684 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:39:23.818249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:39:24.302843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7fdfa8a-0af4-4e6b-ae2e-699bd4abf72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780fce0>]}
[0m01:39:24.348241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7fdfa8a-0af4-4e6b-ae2e-699bd4abf72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076be580>]}
[0m01:39:24.349201 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:39:24.448073 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:39:24.448786 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:39:24.449077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7fdfa8a-0af4-4e6b-ae2e-699bd4abf72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107779050>]}
[0m01:39:25.493077 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:39:25.495637 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 1.7619935, "process_in_blocks": "0", "process_kernel_time": 0.378037, "process_mem_max_rss": "121290752", "process_out_blocks": "0", "process_user_time": 2.439086}
[0m01:39:25.496026 [debug] [MainThread]: Command `dbt source freshness` failed at 01:39:25.495940 after 1.76 seconds
[0m01:39:25.496371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107677980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107806030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f20b0>]}
[0m01:39:25.496677 [debug] [MainThread]: Flushing usage events
[0m01:39:25.860779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:43.002417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cee510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bbed0>]}


============================== 01:39:43.010308 | fdf4ba4b-7543-4f9a-84ac-cc2a031d5088 ==============================
[0m01:39:43.010308 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:39:43.012499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:39:43.433408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf4ba4b-7543-4f9a-84ac-cc2a031d5088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bbbb0>]}
[0m01:39:43.492531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf4ba4b-7543-4f9a-84ac-cc2a031d5088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fde580>]}
[0m01:39:43.498005 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:39:43.625613 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:39:43.626394 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:39:43.626749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdf4ba4b-7543-4f9a-84ac-cc2a031d5088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106129050>]}
[0m01:39:44.653957 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'dev.lab2_stock_data' which was not found
[0m01:39:44.656733 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7192065, "process_in_blocks": "0", "process_kernel_time": 0.346617, "process_mem_max_rss": "124616704", "process_out_blocks": "0", "process_user_time": 2.416191}
[0m01:39:44.657386 [debug] [MainThread]: Command `dbt test` failed at 01:39:44.657288 after 1.72 seconds
[0m01:39:44.657766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f93890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3e70>]}
[0m01:39:44.658138 [debug] [MainThread]: Flushing usage events
[0m01:39:45.019388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:28.135210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107922510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bbbed0>]}


============================== 01:40:28.140626 | 854b7c0f-5ebf-46ba-85f0-695c763849f2 ==============================
[0m01:40:28.140626 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:40:28.141556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m01:40:28.890402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854b7c0f-5ebf-46ba-85f0-695c763849f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d47ce0>]}
[0m01:40:28.970611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854b7c0f-5ebf-46ba-85f0-695c763849f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6e580>]}
[0m01:40:28.972478 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:40:29.248869 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:40:29.252572 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:40:29.253974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '854b7c0f-5ebf-46ba-85f0-695c763849f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb5050>]}
[0m01:40:30.451315 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m01:40:30.460171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '854b7c0f-5ebf-46ba-85f0-695c763849f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c23980>]}
[0m01:40:30.536729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:40:30.541049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:40:30.557378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '854b7c0f-5ebf-46ba-85f0-695c763849f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205d710>]}
[0m01:40:30.557751 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 474 macros
[0m01:40:30.557996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854b7c0f-5ebf-46ba-85f0-695c763849f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffd710>]}
[0m01:40:30.559280 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:40:30.583989 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:40:30.585174 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:40:30.587350 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/sources.json
[0m01:40:30.587586 [info ] [MainThread]: Done.
[0m01:40:30.589787 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 2.5409462, "process_in_blocks": "0", "process_kernel_time": 0.467893, "process_mem_max_rss": "129417216", "process_out_blocks": "0", "process_user_time": 2.802969}
[0m01:40:30.590120 [debug] [MainThread]: Command `dbt source freshness` succeeded at 01:40:30.590051 after 2.54 seconds
[0m01:40:30.590411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cf710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee9c80>]}
[0m01:40:30.590691 [debug] [MainThread]: Flushing usage events
[0m01:40:30.995510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:39.663541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106696510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abbed0>]}


============================== 01:40:39.668252 | 6e66e017-3a2f-4f35-9feb-a8d35cb9c513 ==============================
[0m01:40:39.668252 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:40:39.668767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:40:40.032599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e66e017-3a2f-4f35-9feb-a8d35cb9c513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b33bb0>]}
[0m01:40:40.075734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e66e017-3a2f-4f35-9feb-a8d35cb9c513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e2580>]}
[0m01:40:40.076665 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:40:40.167687 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:40:40.299719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:40:40.300485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:40:40.305783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m01:40:40.399684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e66e017-3a2f-4f35-9feb-a8d35cb9c513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa0e50>]}
[0m01:40:40.478554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:40:40.481138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:40:40.507295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e66e017-3a2f-4f35-9feb-a8d35cb9c513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e05d60>]}
[0m01:40:40.507737 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 474 macros
[0m01:40:40.507998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e66e017-3a2f-4f35-9feb-a8d35cb9c513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e59630>]}
[0m01:40:40.509613 [info ] [MainThread]: 
[0m01:40:40.509903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:40.510145 [info ] [MainThread]: 
[0m01:40:40.510513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:40:40.514212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT_dev'
[0m01:40:40.573840 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m01:40:40.574198 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m01:40:40.574439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:42.199171 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.623 seconds
[0m01:40:42.209027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e66e017-3a2f-4f35-9feb-a8d35cb9c513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0375f0>]}
[0m01:40:42.213179 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:40:42.213626 [info ] [Thread-1 (]: 1 of 10 START test not_null_lab2_stock_data_close .............................. [RUN]
[0m01:40:42.214060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6)
[0m01:40:42.214365 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:40:42.237694 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"
[0m01:40:42.239250 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:40:42.267399 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"
[0m01:40:42.269316 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"
[0m01:40:42.269797 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_MARMOT.dev.lab2_stock_data
where close is null



      
    ) dbt_internal_test
[0m01:40:42.733405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m01:40:42.745109 [info ] [Thread-1 (]: 1 of 10 PASS not_null_lab2_stock_data_close .................................... [[32mPASS[0m in 0.53s]
[0m01:40:42.745857 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:40:42.746276 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:40:42.746697 [info ] [Thread-1 (]: 2 of 10 START test not_null_lab2_stock_data_date ............................... [RUN]
[0m01:40:42.747216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6, now test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76)
[0m01:40:42.747539 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:40:42.750959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"
[0m01:40:42.751847 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:40:42.754420 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"
[0m01:40:42.755222 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"
[0m01:40:42.755517 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_MARMOT.dev.lab2_stock_data
where date is null



      
    ) dbt_internal_test
[0m01:40:43.061182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m01:40:43.063940 [info ] [Thread-1 (]: 2 of 10 PASS not_null_lab2_stock_data_date ..................................... [[32mPASS[0m in 0.32s]
[0m01:40:43.064477 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:40:43.064795 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:40:43.065123 [info ] [Thread-1 (]: 3 of 10 START test not_null_lab2_stock_data_symbol ............................. [RUN]
[0m01:40:43.065454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76, now test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935)
[0m01:40:43.065717 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:40:43.069897 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"
[0m01:40:43.070776 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:40:43.072692 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"
[0m01:40:43.073703 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"
[0m01:40:43.074007 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_MARMOT.dev.lab2_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m01:40:43.880116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m01:40:43.884338 [info ] [Thread-1 (]: 3 of 10 PASS not_null_lab2_stock_data_symbol ................................... [[32mPASS[0m in 0.82s]
[0m01:40:43.885114 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:40:43.885613 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:40:43.886141 [info ] [Thread-1 (]: 4 of 10 START test not_null_lab2_stock_moving_avg_date ......................... [RUN]
[0m01:40:43.886691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935, now test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf)
[0m01:40:43.887100 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:40:43.893931 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"
[0m01:40:43.895029 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:40:43.897881 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"
[0m01:40:43.899562 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"
[0m01:40:43.900357 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m01:40:44.040956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m01:40:44.045316 [info ] [Thread-1 (]: 4 of 10 PASS not_null_lab2_stock_moving_avg_date ............................... [[32mPASS[0m in 0.16s]
[0m01:40:44.046081 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:40:44.046682 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:40:44.047301 [info ] [Thread-1 (]: 5 of 10 START test not_null_lab2_stock_moving_avg_moving_avg ................... [RUN]
[0m01:40:44.047967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf, now test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96)
[0m01:40:44.048433 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:40:44.054749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"
[0m01:40:44.055909 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:40:44.057834 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"
[0m01:40:44.059063 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"
[0m01:40:44.059429 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m01:40:44.171920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0a8-0305-0c98-0004-59ff002b2b86
[0m01:40:44.172569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVG'
[0m01:40:44.182139 [debug] [Thread-1 (]: Database Error in test not_null_lab2_stock_moving_avg_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/dbt_lab2_1/models/schema.yml/not_null_lab2_stock_moving_avg_moving_avg.sql
[0m01:40:44.182797 [error] [Thread-1 (]: 5 of 10 ERROR not_null_lab2_stock_moving_avg_moving_avg ........................ [[31mERROR[0m in 0.13s]
[0m01:40:44.183431 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:40:44.183846 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:40:44.184433 [debug] [Thread-4 (]: Marking all children of 'test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96' to be skipped because of status 'error'.  Reason: Database Error in test not_null_lab2_stock_moving_avg_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/dbt_lab2_1/models/schema.yml/not_null_lab2_stock_moving_avg_moving_avg.sql.
[0m01:40:44.184876 [info ] [Thread-1 (]: 6 of 10 START test not_null_lab2_stock_moving_avg_symbol ....................... [RUN]
[0m01:40:44.186561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96, now test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544)
[0m01:40:44.187040 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:40:44.192461 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"
[0m01:40:44.193259 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:40:44.195241 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"
[0m01:40:44.196072 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"
[0m01:40:44.196401 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m01:40:44.373108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m01:40:44.376223 [info ] [Thread-1 (]: 6 of 10 PASS not_null_lab2_stock_moving_avg_symbol ............................. [[32mPASS[0m in 0.19s]
[0m01:40:44.377117 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:40:44.377612 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:40:44.378091 [info ] [Thread-1 (]: 7 of 10 START test unique_lab2_stock_data_date ................................. [RUN]
[0m01:40:44.378629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544, now test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c)
[0m01:40:44.379019 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:40:44.388111 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"
[0m01:40:44.389138 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:40:44.392488 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"
[0m01:40:44.393501 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"
[0m01:40:44.393844 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_data
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m01:40:44.617501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m01:40:44.621682 [info ] [Thread-1 (]: 7 of 10 PASS unique_lab2_stock_data_date ....................................... [[32mPASS[0m in 0.24s]
[0m01:40:44.622610 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:40:44.623215 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:40:44.623778 [info ] [Thread-1 (]: 8 of 10 START test unique_lab2_stock_data_symbol ............................... [RUN]
[0m01:40:44.624538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c, now test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172)
[0m01:40:44.625075 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:40:44.631834 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"
[0m01:40:44.632899 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:40:44.636562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"
[0m01:40:44.637886 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"
[0m01:40:44.638873 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_data
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:40:44.971756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m01:40:44.975843 [error] [Thread-1 (]: 8 of 10 FAIL 1 unique_lab2_stock_data_symbol ................................... [[31mFAIL 1[0m in 0.35s]
[0m01:40:44.976656 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:40:44.977131 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:40:44.977612 [info ] [Thread-1 (]: 9 of 10 START test unique_lab2_stock_moving_avg_date ........................... [RUN]
[0m01:40:44.978087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172, now test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170)
[0m01:40:44.978509 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:40:44.983096 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"
[0m01:40:44.983920 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:40:44.986328 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"
[0m01:40:44.987671 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"
[0m01:40:44.988143 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m01:40:45.206839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m01:40:45.211033 [info ] [Thread-1 (]: 9 of 10 PASS unique_lab2_stock_moving_avg_date ................................. [[32mPASS[0m in 0.23s]
[0m01:40:45.211922 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:40:45.212497 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:40:45.213077 [info ] [Thread-1 (]: 10 of 10 START test unique_lab2_stock_moving_avg_symbol ........................ [RUN]
[0m01:40:45.213814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170, now test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65)
[0m01:40:45.214283 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:40:45.219966 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"
[0m01:40:45.220923 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:40:45.223207 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"
[0m01:40:45.224284 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"
[0m01:40:45.224610 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:40:45.628169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m01:40:45.631829 [error] [Thread-1 (]: 10 of 10 FAIL 1 unique_lab2_stock_moving_avg_symbol ............................ [[31mFAIL 1[0m in 0.42s]
[0m01:40:45.632671 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:40:45.634911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:45.635311 [debug] [MainThread]: Connection 'test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65' was left open.
[0m01:40:45.635696 [debug] [MainThread]: On test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65: Close
[0m01:40:45.796055 [info ] [MainThread]: 
[0m01:40:45.796615 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m01:40:45.798251 [debug] [MainThread]: Command end result
[0m01:40:45.842107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:40:45.847407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:40:45.857201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m01:40:45.857573 [info ] [MainThread]: 
[0m01:40:45.857995 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:40:45.858339 [info ] [MainThread]: 
[0m01:40:45.858775 [error] [MainThread]:   Database Error in test not_null_lab2_stock_moving_avg_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/dbt_lab2_1/models/schema.yml/not_null_lab2_stock_moving_avg_moving_avg.sql
[0m01:40:45.859306 [info ] [MainThread]: 
[0m01:40:45.859639 [error] [MainThread]: [31mFailure in test unique_lab2_stock_data_symbol (models/schema.yml)[0m
[0m01:40:45.859953 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:40:45.860190 [info ] [MainThread]: 
[0m01:40:45.860462 [info ] [MainThread]:   compiled code at target/compiled/dbt_lab2_1/models/schema.yml/unique_lab2_stock_data_symbol.sql
[0m01:40:45.860690 [info ] [MainThread]: 
[0m01:40:45.860992 [error] [MainThread]: [31mFailure in test unique_lab2_stock_moving_avg_symbol (models/schema.yml)[0m
[0m01:40:45.861321 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:40:45.861522 [info ] [MainThread]: 
[0m01:40:45.861792 [info ] [MainThread]:   compiled code at target/compiled/dbt_lab2_1/models/schema.yml/unique_lab2_stock_moving_avg_symbol.sql
[0m01:40:45.862008 [info ] [MainThread]: 
[0m01:40:45.862259 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m01:40:45.864981 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.2648335, "process_in_blocks": "0", "process_kernel_time": 0.601887, "process_mem_max_rss": "134922240", "process_out_blocks": "0", "process_user_time": 2.331425}
[0m01:40:45.865471 [debug] [MainThread]: Command `dbt test` failed at 01:40:45.865382 after 6.27 seconds
[0m01:40:45.865930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c9230>]}
[0m01:40:45.866279 [debug] [MainThread]: Flushing usage events
[0m01:40:46.205527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:39.491940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108396510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bbed0>]}


============================== 01:43:39.496855 | 9931284f-35fa-4d89-be19-1675226cbd06 ==============================
[0m01:43:39.496855 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:43:39.497352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:43:39.920628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9931284f-35fa-4d89-be19-1675226cbd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a933bb0>]}
[0m01:43:39.962456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9931284f-35fa-4d89-be19-1675226cbd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7de580>]}
[0m01:43:39.963560 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:43:40.051209 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:43:40.176840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:43:40.177570 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/schema.yml
[0m01:43:40.177859 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m01:43:40.178097 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m01:43:40.521029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m01:43:40.530484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9931284f-35fa-4d89-be19-1675226cbd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89d450>]}
[0m01:43:40.636663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:43:40.639128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:43:40.664591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9931284f-35fa-4d89-be19-1675226cbd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ba030>]}
[0m01:43:40.664980 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 474 macros
[0m01:43:40.665236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9931284f-35fa-4d89-be19-1675226cbd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e6c10>]}
[0m01:43:40.666742 [info ] [MainThread]: 
[0m01:43:40.667028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:40.667236 [info ] [MainThread]: 
[0m01:43:40.667581 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:43:40.670853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT_dev'
[0m01:43:40.718831 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m01:43:40.719139 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m01:43:40.719362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:41.481558 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.761 seconds
[0m01:43:41.488752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9931284f-35fa-4d89-be19-1675226cbd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8f4390>]}
[0m01:43:41.492670 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:43:41.493169 [info ] [Thread-1 (]: 1 of 10 START test not_null_lab2_stock_data_close .............................. [RUN]
[0m01:43:41.493628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6)
[0m01:43:41.494338 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:43:41.530609 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"
[0m01:43:41.534514 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:43:41.567281 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"
[0m01:43:41.573191 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"
[0m01:43:41.573710 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_MARMOT.dev.lab2_stock_data
where close is null



      
    ) dbt_internal_test
[0m01:43:41.696433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m01:43:41.706417 [info ] [Thread-1 (]: 1 of 10 PASS not_null_lab2_stock_data_close .................................... [[32mPASS[0m in 0.21s]
[0m01:43:41.707247 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6
[0m01:43:41.707740 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:43:41.708302 [info ] [Thread-1 (]: 2 of 10 START test not_null_lab2_stock_data_date ............................... [RUN]
[0m01:43:41.708817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_data_close.f94ee4b2c6, now test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76)
[0m01:43:41.709280 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:43:41.713790 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"
[0m01:43:41.714806 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:43:41.717901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"
[0m01:43:41.719326 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"
[0m01:43:41.720216 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_MARMOT.dev.lab2_stock_data
where date is null



      
    ) dbt_internal_test
[0m01:43:41.824143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m01:43:41.827033 [info ] [Thread-1 (]: 2 of 10 PASS not_null_lab2_stock_data_date ..................................... [[32mPASS[0m in 0.12s]
[0m01:43:41.827711 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76
[0m01:43:41.828144 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:43:41.828651 [info ] [Thread-1 (]: 3 of 10 START test not_null_lab2_stock_data_symbol ............................. [RUN]
[0m01:43:41.829134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_data_date.8ee4c8ae76, now test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935)
[0m01:43:41.829448 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:43:41.832598 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"
[0m01:43:41.833354 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:43:41.835119 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"
[0m01:43:41.835872 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"
[0m01:43:41.836155 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_MARMOT.dev.lab2_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m01:43:41.977895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m01:43:41.982336 [info ] [Thread-1 (]: 3 of 10 PASS not_null_lab2_stock_data_symbol ................................... [[32mPASS[0m in 0.15s]
[0m01:43:41.983542 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935
[0m01:43:41.984168 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:43:41.984689 [info ] [Thread-1 (]: 4 of 10 START test not_null_lab2_stock_moving_avg_date ......................... [RUN]
[0m01:43:41.985232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_data_symbol.01483b8935, now test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf)
[0m01:43:41.985628 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:43:41.990539 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"
[0m01:43:41.991233 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:43:41.992890 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"
[0m01:43:41.993620 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"
[0m01:43:41.993902 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m01:43:42.106661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m01:43:42.109704 [info ] [Thread-1 (]: 4 of 10 PASS not_null_lab2_stock_moving_avg_date ............................... [[32mPASS[0m in 0.12s]
[0m01:43:42.110703 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf
[0m01:43:42.111296 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:43:42.111914 [info ] [Thread-1 (]: 5 of 10 START test not_null_lab2_stock_moving_avg_moving_avg ................... [RUN]
[0m01:43:42.112585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_moving_avg_date.891bfea6cf, now test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96)
[0m01:43:42.113109 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:43:42.119403 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"
[0m01:43:42.120170 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:43:42.121969 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"
[0m01:43:42.123453 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"
[0m01:43:42.124080 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m01:43:42.227010 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0ab-0305-0bd9-0004-59ff002b6892
[0m01:43:42.227606 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVG'
[0m01:43:42.234995 [debug] [Thread-1 (]: Database Error in test not_null_lab2_stock_moving_avg_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/dbt_lab2_1/models/schema.yml/not_null_lab2_stock_moving_avg_moving_avg.sql
[0m01:43:42.235626 [error] [Thread-1 (]: 5 of 10 ERROR not_null_lab2_stock_moving_avg_moving_avg ........................ [[31mERROR[0m in 0.12s]
[0m01:43:42.236189 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96
[0m01:43:42.236534 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:43:42.237012 [debug] [Thread-4 (]: Marking all children of 'test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96' to be skipped because of status 'error'.  Reason: Database Error in test not_null_lab2_stock_moving_avg_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/dbt_lab2_1/models/schema.yml/not_null_lab2_stock_moving_avg_moving_avg.sql.
[0m01:43:42.237381 [info ] [Thread-1 (]: 6 of 10 START test not_null_lab2_stock_moving_avg_symbol ....................... [RUN]
[0m01:43:42.239206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_moving_avg_moving_avg.c4aadf3c96, now test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544)
[0m01:43:42.239709 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:43:42.244472 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"
[0m01:43:42.245511 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:43:42.250821 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"
[0m01:43:42.251923 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"
[0m01:43:42.252289 [debug] [Thread-1 (]: On test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m01:43:42.344693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m01:43:42.348657 [info ] [Thread-1 (]: 6 of 10 PASS not_null_lab2_stock_moving_avg_symbol ............................. [[32mPASS[0m in 0.11s]
[0m01:43:42.349922 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544
[0m01:43:42.350511 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:43:42.351280 [info ] [Thread-1 (]: 7 of 10 START test unique_lab2_stock_data_date ................................. [RUN]
[0m01:43:42.352116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.not_null_lab2_stock_moving_avg_symbol.6690524544, now test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c)
[0m01:43:42.352768 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:43:42.365237 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"
[0m01:43:42.366732 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:43:42.371160 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"
[0m01:43:42.372260 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"
[0m01:43:42.372602 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_data
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:42.470037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m01:43:42.472956 [info ] [Thread-1 (]: 7 of 10 PASS unique_lab2_stock_data_date ....................................... [[32mPASS[0m in 0.12s]
[0m01:43:42.473571 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c
[0m01:43:42.473942 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:43:42.474366 [info ] [Thread-1 (]: 8 of 10 START test unique_lab2_stock_data_symbol ............................... [RUN]
[0m01:43:42.474809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.unique_lab2_stock_data_date.6181a2fe7c, now test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172)
[0m01:43:42.475122 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:43:42.478829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"
[0m01:43:42.479664 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:43:42.483264 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"
[0m01:43:42.484269 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"
[0m01:43:42.484583 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_data
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:42.575869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m01:43:42.579287 [error] [Thread-1 (]: 8 of 10 FAIL 1 unique_lab2_stock_data_symbol ................................... [[31mFAIL 1[0m in 0.10s]
[0m01:43:42.580058 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172
[0m01:43:42.580508 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:43:42.581053 [info ] [Thread-1 (]: 9 of 10 START test unique_lab2_stock_moving_avg_date ........................... [RUN]
[0m01:43:42.581651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.unique_lab2_stock_data_symbol.6b3e333172, now test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170)
[0m01:43:42.582179 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:43:42.587484 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"
[0m01:43:42.588709 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:43:42.591117 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"
[0m01:43:42.592221 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"
[0m01:43:42.592563 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:42.678591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m01:43:42.681384 [info ] [Thread-1 (]: 9 of 10 PASS unique_lab2_stock_moving_avg_date ................................. [[32mPASS[0m in 0.10s]
[0m01:43:42.682219 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170
[0m01:43:42.682696 [debug] [Thread-1 (]: Began running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:43:42.683094 [info ] [Thread-1 (]: 10 of 10 START test unique_lab2_stock_moving_avg_symbol ........................ [RUN]
[0m01:43:42.683620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab2_1.unique_lab2_stock_moving_avg_date.e180b72170, now test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65)
[0m01:43:42.683987 [debug] [Thread-1 (]: Began compiling node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:43:42.689777 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"
[0m01:43:42.690915 [debug] [Thread-1 (]: Began executing node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:43:42.694888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"
[0m01:43:42.696795 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"
[0m01:43:42.697499 [debug] [Thread-1 (]: On test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from USER_DB_MARMOT.dev.lab2_stock_moving_avg
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:42.784723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m01:43:42.786663 [error] [Thread-1 (]: 10 of 10 FAIL 1 unique_lab2_stock_moving_avg_symbol ............................ [[31mFAIL 1[0m in 0.10s]
[0m01:43:42.787138 [debug] [Thread-1 (]: Finished running node test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65
[0m01:43:42.788490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:42.788732 [debug] [MainThread]: Connection 'test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65' was left open.
[0m01:43:42.788949 [debug] [MainThread]: On test.dbt_lab2_1.unique_lab2_stock_moving_avg_symbol.8c06c1bd65: Close
[0m01:43:42.934608 [info ] [MainThread]: 
[0m01:43:42.935325 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m01:43:42.937460 [debug] [MainThread]: Command end result
[0m01:43:42.973502 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:43:42.975878 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:43:42.982223 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m01:43:42.982516 [info ] [MainThread]: 
[0m01:43:42.982928 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:43:42.983216 [info ] [MainThread]: 
[0m01:43:42.983525 [error] [MainThread]:   Database Error in test not_null_lab2_stock_moving_avg_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/dbt_lab2_1/models/schema.yml/not_null_lab2_stock_moving_avg_moving_avg.sql
[0m01:43:42.983742 [info ] [MainThread]: 
[0m01:43:42.984013 [error] [MainThread]: [31mFailure in test unique_lab2_stock_data_symbol (models/schema.yml)[0m
[0m01:43:42.984248 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:43:42.984429 [info ] [MainThread]: 
[0m01:43:42.984648 [info ] [MainThread]:   compiled code at target/compiled/dbt_lab2_1/models/schema.yml/unique_lab2_stock_data_symbol.sql
[0m01:43:42.984852 [info ] [MainThread]: 
[0m01:43:42.985082 [error] [MainThread]: [31mFailure in test unique_lab2_stock_moving_avg_symbol (models/schema.yml)[0m
[0m01:43:42.985305 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:43:42.985484 [info ] [MainThread]: 
[0m01:43:42.985699 [info ] [MainThread]:   compiled code at target/compiled/dbt_lab2_1/models/schema.yml/unique_lab2_stock_moving_avg_symbol.sql
[0m01:43:42.985894 [info ] [MainThread]: 
[0m01:43:42.986130 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m01:43:42.988514 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.5593379, "process_in_blocks": "0", "process_kernel_time": 0.412141, "process_mem_max_rss": "145620992", "process_out_blocks": "0", "process_user_time": 2.24408}
[0m01:43:42.988960 [debug] [MainThread]: Command `dbt test` failed at 01:43:42.988801 after 3.56 seconds
[0m01:43:42.989414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cf710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb18ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb18f70>]}
[0m01:43:42.989801 [debug] [MainThread]: Flushing usage events
[0m01:43:43.416250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:44:27.430498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bbed0>]}


============================== 01:44:27.435113 | e8d16456-b70b-4094-8d34-7c4a8a00e352 ==============================
[0m01:44:27.435113 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:44:27.435654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:44:27.860569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148bbbb0>]}
[0m01:44:27.901649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e2580>]}
[0m01:44:27.902453 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:44:28.065124 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:44:28.191813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:44:28.192542 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/schema.yml
[0m01:44:28.192826 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m01:44:28.546274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m01:44:28.556326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11482b550>]}
[0m01:44:28.627096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:44:28.629433 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:44:28.645816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148b7200>]}
[0m01:44:28.646192 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 474 macros
[0m01:44:28.646448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156a35b0>]}
[0m01:44:28.647839 [info ] [MainThread]: 
[0m01:44:28.648211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:44:28.648527 [info ] [MainThread]: 
[0m01:44:28.648878 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:44:28.652110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m01:44:28.696120 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m01:44:28.696437 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m01:44:28.696657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:29.218030 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.521 seconds
[0m01:44:29.223519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m01:44:29.235210 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m01:44:29.235641 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m01:44:29.356164 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.120 seconds
[0m01:44:29.361677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116086270>]}
[0m01:44:29.366424 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m01:44:29.367137 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m01:44:29.367695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m01:44:29.368108 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m01:44:29.377183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m01:44:29.377980 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m01:44:29.399260 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" because it is of type table
[0m01:44:29.406087 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA"
[0m01:44:29.411284 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m01:44:29.411624 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" cascade
[0m01:44:29.527856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m01:44:29.542797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m01:44:29.543920 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m01:44:29.544274 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    -- models/lab2_stock_data.sql
select
    symbol,
    date,
    close,
    open,
    high,
    low,
    volume
from USER_DB_MARMOT.dev.lab2_stock_data;
[0m01:44:29.662106 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0ac-0305-0be2-0004-59ff002b3b1e
[0m01:44:29.662664 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 39 unexpected ';'.
[0m01:44:29.670815 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m01:44:29.672743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d16456-b70b-4094-8d34-7c4a8a00e352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165e6090>]}
[0m01:44:29.673402 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.30s]
[0m01:44:29.673909 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m01:44:29.674393 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m01:44:29.675573 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m01:44:29.675944 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m01:44:29.676290 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m01:44:29.677166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:29.677479 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m01:44:29.677984 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m01:44:29.811843 [info ] [MainThread]: 
[0m01:44:29.812785 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m01:44:29.813972 [debug] [MainThread]: Command end result
[0m01:44:29.845176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:44:29.846679 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:44:29.851143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m01:44:29.851410 [info ] [MainThread]: 
[0m01:44:29.851681 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:44:29.851898 [info ] [MainThread]: 
[0m01:44:29.852162 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m01:44:29.852366 [info ] [MainThread]: 
[0m01:44:29.852580 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:44:29.854390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.486422, "process_in_blocks": "0", "process_kernel_time": 0.331171, "process_mem_max_rss": "147128320", "process_out_blocks": "0", "process_user_time": 2.066553}
[0m01:44:29.854679 [debug] [MainThread]: Command `dbt run` failed at 01:44:29.854619 after 2.49 seconds
[0m01:44:29.854963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165b31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168df6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168df930>]}
[0m01:44:29.855221 [debug] [MainThread]: Flushing usage events
[0m01:44:30.212877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:25.231880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777ed0>]}


============================== 01:45:25.236462 | a05b227e-3fd5-453d-a347-e3a54db5d023 ==============================
[0m01:45:25.236462 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:45:25.236999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:45:25.642776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567bbb0>]}
[0m01:45:25.684204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552a580>]}
[0m01:45:25.685238 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:45:25.769905 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:45:25.892526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:45:25.893090 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m01:45:26.226021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m01:45:26.235155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e5550>]}
[0m01:45:26.305826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:45:26.308148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:45:26.324000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105676d50>]}
[0m01:45:26.324383 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 474 macros
[0m01:45:26.324647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab4e50>]}
[0m01:45:26.325963 [info ] [MainThread]: 
[0m01:45:26.326224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:26.326425 [info ] [MainThread]: 
[0m01:45:26.326749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:45:26.329929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m01:45:26.374007 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m01:45:26.374354 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m01:45:26.374588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:26.882744 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.508 seconds
[0m01:45:26.888572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m01:45:26.902596 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m01:45:26.903078 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m01:45:27.017815 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.114 seconds
[0m01:45:27.022945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ce270>]}
[0m01:45:27.027150 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m01:45:27.027931 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m01:45:27.028532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m01:45:27.029040 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m01:45:27.038293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m01:45:27.038957 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m01:45:27.062281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m01:45:27.063122 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m01:45:27.063421 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    -- models/lab2_stock_data.sql
select
    symbol,
    date,
    close,
    open,
    high,
    low,
    volume
from USER_DB_MARMOT.dev.lab2_stock_data
  );
[0m01:45:27.187277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0ad-0305-0c98-0004-59ff002b2ba2
[0m01:45:27.187826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m01:45:27.195705 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m01:45:27.197484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a05b227e-3fd5-453d-a347-e3a54db5d023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f5910>]}
[0m01:45:27.198101 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.17s]
[0m01:45:27.198603 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m01:45:27.199046 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m01:45:27.200158 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m01:45:27.200637 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m01:45:27.201081 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m01:45:27.201866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:27.202107 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m01:45:27.202340 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m01:45:27.351724 [info ] [MainThread]: 
[0m01:45:27.352332 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m01:45:27.353150 [debug] [MainThread]: Command end result
[0m01:45:27.382992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:45:27.384199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:45:27.388993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m01:45:27.389254 [info ] [MainThread]: 
[0m01:45:27.389518 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:45:27.389744 [info ] [MainThread]: 
[0m01:45:27.390008 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m01:45:27.390608 [info ] [MainThread]: 
[0m01:45:27.390834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:45:27.392835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2228687, "process_in_blocks": "0", "process_kernel_time": 0.317015, "process_mem_max_rss": "149028864", "process_out_blocks": "0", "process_user_time": 2.022412}
[0m01:45:27.393178 [debug] [MainThread]: Command `dbt run` failed at 01:45:27.393106 after 2.22 seconds
[0m01:45:27.393459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3f890>]}
[0m01:45:27.393726 [debug] [MainThread]: Flushing usage events
[0m01:45:27.848156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:29.321944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cbed0>]}


============================== 01:47:29.326784 | b6b8c4a0-93c0-4183-b472-7304866cc93a ==============================
[0m01:47:29.326784 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:47:29.327286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:47:29.341810 [info ] [MainThread]: dbt version: 1.9.3
[0m01:47:29.342114 [info ] [MainThread]: python version: 3.13.2
[0m01:47:29.342324 [info ] [MainThread]: python path: /Users/leali/Downloads/226/sjsu-data226-SP25/.venv/bin/python
[0m01:47:29.342523 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit-Mach-O
[0m01:47:29.702971 [info ] [MainThread]: Using profiles dir at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1
[0m01:47:29.703348 [info ] [MainThread]: Using profiles.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/profiles.yml
[0m01:47:29.703605 [info ] [MainThread]: Using dbt_project.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/dbt_project.yml
[0m01:47:29.704150 [info ] [MainThread]: adapter type: snowflake
[0m01:47:29.704441 [info ] [MainThread]: adapter version: 1.9.2
[0m01:47:29.775662 [info ] [MainThread]: Configuration:
[0m01:47:29.776089 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:47:29.776335 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:47:29.776546 [info ] [MainThread]: Required dependencies:
[0m01:47:29.776857 [debug] [MainThread]: Executing "git --help"
[0m01:47:29.799863 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:47:29.800707 [debug] [MainThread]: STDERR: "b''"
[0m01:47:29.801007 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:47:29.801260 [info ] [MainThread]: Connection:
[0m01:47:29.801521 [info ] [MainThread]:   account: SFEDU02-KSB65579
[0m01:47:29.801729 [info ] [MainThread]:   user: MARMOT
[0m01:47:29.801924 [info ] [MainThread]:   database: USER_DB_MARMOT
[0m01:47:29.802112 [info ] [MainThread]:   warehouse: MARMOT_QUERY_WH
[0m01:47:29.802290 [info ] [MainThread]:   role: TRAINING_ROLE
[0m01:47:29.802469 [info ] [MainThread]:   schema: dev
[0m01:47:29.802646 [info ] [MainThread]:   authenticator: None
[0m01:47:29.802820 [info ] [MainThread]:   oauth_client_id: None
[0m01:47:29.802994 [info ] [MainThread]:   query_tag: None
[0m01:47:29.803172 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:47:29.803354 [info ] [MainThread]:   host: None
[0m01:47:29.803527 [info ] [MainThread]:   port: None
[0m01:47:29.803698 [info ] [MainThread]:   proxy_host: None
[0m01:47:29.803882 [info ] [MainThread]:   proxy_port: None
[0m01:47:29.804050 [info ] [MainThread]:   protocol: None
[0m01:47:29.804220 [info ] [MainThread]:   connect_retries: 1
[0m01:47:29.804386 [info ] [MainThread]:   connect_timeout: None
[0m01:47:29.804554 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:47:29.804723 [info ] [MainThread]:   retry_all: False
[0m01:47:29.804894 [info ] [MainThread]:   insecure_mode: False
[0m01:47:29.805065 [info ] [MainThread]:   reuse_connections: True
[0m01:47:29.805568 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:47:29.883462 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:47:29.919841 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:47:29.920151 [debug] [MainThread]: On debug: select 1 as id
[0m01:47:29.920387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:30.446681 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.526 seconds
[0m01:47:30.448136 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:47:30.448660 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:47:30.451362 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1988162, "process_in_blocks": "0", "process_kernel_time": 0.335976, "process_mem_max_rss": "138706944", "process_out_blocks": "0", "process_user_time": 1.467084}
[0m01:47:30.451842 [debug] [MainThread]: Command `dbt debug` succeeded at 01:47:30.451732 after 1.20 seconds
[0m01:47:30.452182 [debug] [MainThread]: Connection 'debug' was left open.
[0m01:47:30.452471 [debug] [MainThread]: On debug: Close
[0m01:47:30.629597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da1590>]}
[0m01:47:30.630213 [debug] [MainThread]: Flushing usage events
[0m01:47:31.143355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:36.091675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106546510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bbed0>]}


============================== 01:47:36.097544 | 55d38f7d-c9e4-433b-badd-69800e6623f4 ==============================
[0m01:47:36.097544 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:47:36.098532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:47:36.489425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55d38f7d-c9e4-433b-badd-69800e6623f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112bbbb0>]}
[0m01:47:36.531569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55d38f7d-c9e4-433b-badd-69800e6623f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e2580>]}
[0m01:47:36.532402 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:47:36.642139 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:47:36.770312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:47:36.770867 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m01:47:37.063011 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2_1.lab2_stock_data' (models/lab2_stock_data.sql) depends on a source named 'lab2.stock_data' which was not found
[0m01:47:37.065038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.04564, "process_in_blocks": "0", "process_kernel_time": 0.272024, "process_mem_max_rss": "131088384", "process_out_blocks": "0", "process_user_time": 1.710606}
[0m01:47:37.065414 [debug] [MainThread]: Command `dbt run` failed at 01:47:37.065334 after 1.05 seconds
[0m01:47:37.066028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111229850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112924d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b59310>]}
[0m01:47:37.066310 [debug] [MainThread]: Flushing usage events
[0m01:47:37.405123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:59.286377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652fed0>]}


============================== 01:47:59.294428 | 36c9dd36-b105-4461-a115-3a969c6ce976 ==============================
[0m01:47:59.294428 [info ] [MainThread]: Running with dbt=1.9.3
[0m01:47:59.297040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:47:59.865528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bbbb0>]}
[0m01:47:59.909359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077de580>]}
[0m01:47:59.911516 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:48:00.000680 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m01:48:00.163511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:48:00.164648 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m01:48:00.536279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m01:48:00.545940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107825450>]}
[0m01:48:00.625372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:48:00.628096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:48:00.644515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b6d50>]}
[0m01:48:00.644930 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 474 macros
[0m01:48:00.645239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a8f30>]}
[0m01:48:00.646651 [info ] [MainThread]: 
[0m01:48:00.646929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:48:00.647139 [info ] [MainThread]: 
[0m01:48:00.647482 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:48:00.650744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m01:48:00.705823 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m01:48:00.706199 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m01:48:00.706457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:01.189787 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.483 seconds
[0m01:48:01.197540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m01:48:01.207403 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m01:48:01.207755 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m01:48:01.341658 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.134 seconds
[0m01:48:01.344463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108872270>]}
[0m01:48:01.347809 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m01:48:01.348254 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m01:48:01.348638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m01:48:01.348905 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m01:48:01.356148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m01:48:01.357117 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m01:48:01.382033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m01:48:01.383203 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m01:48:01.383544 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    

select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data
  );
[0m01:48:01.512083 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0b0-0305-0be2-0004-59ff002b3b26
[0m01:48:01.512854 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m01:48:01.519946 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m01:48:01.522518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c9dd36-b105-4461-a115-3a969c6ce976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d005910>]}
[0m01:48:01.523408 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.17s]
[0m01:48:01.523887 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m01:48:01.524363 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m01:48:01.525671 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m01:48:01.526162 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m01:48:01.526544 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m01:48:01.527582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:01.527819 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m01:48:01.528055 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m01:48:01.676699 [info ] [MainThread]: 
[0m01:48:01.677110 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m01:48:01.677708 [debug] [MainThread]: Command end result
[0m01:48:01.708367 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m01:48:01.709995 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m01:48:01.715479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m01:48:01.715785 [info ] [MainThread]: 
[0m01:48:01.716082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:48:01.716319 [info ] [MainThread]: 
[0m01:48:01.716612 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m01:48:01.716832 [info ] [MainThread]: 
[0m01:48:01.717056 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:48:01.718700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5161428, "process_in_blocks": "0", "process_kernel_time": 0.394877, "process_mem_max_rss": "141115392", "process_out_blocks": "0", "process_user_time": 2.187535}
[0m01:48:01.719020 [debug] [MainThread]: Command `dbt run` failed at 01:48:01.718953 after 2.52 seconds
[0m01:48:01.719327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c86360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d04ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d04bf70>]}
[0m01:48:01.719592 [debug] [MainThread]: Flushing usage events
[0m01:48:02.052923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:07:46.384699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acf2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0bbed0>]}


============================== 02:07:46.389590 | 912ec785-e3b0-4477-9e43-7b8a96050f1e ==============================
[0m02:07:46.389590 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:07:46.390212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:07:46.859021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d333bb0>]}
[0m02:07:46.901681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1e2580>]}
[0m02:07:46.902512 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:07:46.992883 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:07:47.137048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:07:47.137421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:07:47.141785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:07:47.217803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d29f950>]}
[0m02:07:47.293664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:07:47.295914 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:07:47.312188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d32f980>]}
[0m02:07:47.312550 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 474 macros
[0m02:07:47.312806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2f2350>]}
[0m02:07:47.314129 [info ] [MainThread]: 
[0m02:07:47.314397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:07:47.314609 [info ] [MainThread]: 
[0m02:07:47.314942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:07:47.318208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:07:47.371461 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:07:47.371864 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:07:47.372116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:47.918545 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.546 seconds
[0m02:07:47.920849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:07:47.929662 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:07:47.929997 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:07:48.062160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.132 seconds
[0m02:07:48.068406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2eb930>]}
[0m02:07:48.072653 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:07:48.073433 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:07:48.074049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:07:48.074481 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:07:48.083147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:07:48.084994 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:07:48.107396 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" because it is of type table
[0m02:07:48.111964 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA"
[0m02:07:48.116602 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:07:48.116913 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" cascade
[0m02:07:48.298613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m02:07:48.316385 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:07:48.317627 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:07:48.318030 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    

select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data
  );
[0m02:07:48.423501 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0c3-0305-0c98-0004-59ff002b2f82
[0m02:07:48.424057 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m02:07:48.432908 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:07:48.434869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912ec785-e3b0-4477-9e43-7b8a96050f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e910710>]}
[0m02:07:48.435558 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.36s]
[0m02:07:48.436121 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:07:48.436560 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:07:48.437754 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:07:48.438230 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:07:48.438730 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:07:48.439715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:48.439984 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:07:48.440239 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:07:48.735484 [info ] [MainThread]: 
[0m02:07:48.736549 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m02:07:48.737835 [debug] [MainThread]: Command end result
[0m02:07:48.773320 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:07:48.775093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:07:48.780115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:07:48.780424 [info ] [MainThread]: 
[0m02:07:48.780742 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:07:48.780986 [info ] [MainThread]: 
[0m02:07:48.781262 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:07:48.781489 [info ] [MainThread]: 
[0m02:07:48.781733 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:07:48.784541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.462685, "process_in_blocks": "0", "process_kernel_time": 0.42504, "process_mem_max_rss": "143917056", "process_out_blocks": "0", "process_user_time": 1.89281}
[0m02:07:48.784841 [debug] [MainThread]: Command `dbt run` failed at 02:07:48.784777 after 2.46 seconds
[0m02:07:48.785244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e88d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e90bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e90bbb0>]}
[0m02:07:48.785548 [debug] [MainThread]: Flushing usage events
[0m02:07:49.293899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:19.269789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106846510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbbed0>]}


============================== 02:09:19.274480 | 10fc8234-34cc-43b7-9727-6998f6f9e8a0 ==============================
[0m02:09:19.274480 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:09:19.274997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:09:19.887126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10fc8234-34cc-43b7-9727-6998f6f9e8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dbbbb0>]}
[0m02:09:19.932904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10fc8234-34cc-43b7-9727-6998f6f9e8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cde580>]}
[0m02:09:19.935627 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:09:20.073941 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:09:20.350818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:09:20.351603 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/schema.yml
[0m02:09:20.661916 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "dev_lab2_stock_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("dev", "lab2_stock_data").
  
  To fix this, change the name of one of these resources:
  - source.dbt_lab2_1.dev.lab2_stock_data (models/schema.yml)
  - source.dbt_lab2_1.dev.lab2_stock_data (models/sources.yml)
[0m02:09:20.669507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4597032, "process_in_blocks": "0", "process_kernel_time": 0.396383, "process_mem_max_rss": "129892352", "process_out_blocks": "0", "process_user_time": 1.978954}
[0m02:09:20.670448 [debug] [MainThread]: Command `dbt run` failed at 02:09:20.669991 after 1.46 seconds
[0m02:09:20.671101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111124950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111124b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cb980>]}
[0m02:09:20.671486 [debug] [MainThread]: Flushing usage events
[0m02:09:21.083379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:10:01.175027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebbed0>]}


============================== 02:10:01.179599 | 13f73785-3f40-4f73-9138-6438124bec98 ==============================
[0m02:10:01.179599 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:10:01.180074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:10:01.728074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133bb0>]}
[0m02:10:01.769828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe2580>]}
[0m02:10:01.770688 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:10:01.858113 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:10:01.986113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:10:01.986856 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/schema.yml
[0m02:10:02.260497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:10:02.269858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e71550>]}
[0m02:10:02.337500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:10:02.340173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:10:02.356148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812f020>]}
[0m02:10:02.356515 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:10:02.356767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f0d70>]}
[0m02:10:02.357994 [info ] [MainThread]: 
[0m02:10:02.358255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:10:02.358457 [info ] [MainThread]: 
[0m02:10:02.358790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:10:02.361985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:10:02.407760 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:10:02.408081 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:10:02.408323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:10:02.981407 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.573 seconds
[0m02:10:03.000934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:10:03.039893 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:10:03.043017 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:10:03.174747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.130 seconds
[0m02:10:03.187218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092765b0>]}
[0m02:10:03.192900 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:10:03.193905 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:10:03.194591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:10:03.195017 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:10:03.203456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:10:03.204302 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:10:03.229546 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:10:03.231836 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:10:03.232150 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    

select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data
  );
[0m02:10:03.328285 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0c6-0305-0c96-0004-59ff002b4efa
[0m02:10:03.328707 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m02:10:03.335162 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:10:03.336715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13f73785-3f40-4f73-9138-6438124bec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d885190>]}
[0m02:10:03.337247 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.14s]
[0m02:10:03.337685 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:10:03.338075 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:10:03.339069 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:10:03.339467 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:10:03.339822 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:10:03.340543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:10:03.340765 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:10:03.340971 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:10:03.477106 [info ] [MainThread]: 
[0m02:10:03.478018 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m02:10:03.479274 [debug] [MainThread]: Command end result
[0m02:10:03.515978 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:10:03.517742 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:10:03.522284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:10:03.522680 [info ] [MainThread]: 
[0m02:10:03.522990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:10:03.523236 [info ] [MainThread]: 
[0m02:10:03.523504 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:10:03.523719 [info ] [MainThread]: 
[0m02:10:03.523947 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:10:03.526401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4157088, "process_in_blocks": "0", "process_kernel_time": 0.374209, "process_mem_max_rss": "143556608", "process_out_blocks": "0", "process_user_time": 1.9901}
[0m02:10:03.526837 [debug] [MainThread]: Command `dbt run` failed at 02:10:03.526750 after 2.42 seconds
[0m02:10:03.527176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d32210>]}
[0m02:10:03.527466 [debug] [MainThread]: Flushing usage events
[0m02:10:03.874172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:11:14.568825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cee510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bbed0>]}


============================== 02:11:14.573507 | b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b ==============================
[0m02:11:14.573507 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:11:14.574009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:11:15.090924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b333bb0>]}
[0m02:11:15.132852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1e2580>]}
[0m02:11:15.133730 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:11:15.223465 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:11:15.339951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:11:15.340571 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m02:11:15.613664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m02:11:15.622786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ad650>]}
[0m02:11:15.688083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:11:15.690732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:11:15.706600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645b890>]}
[0m02:11:15.706989 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:11:15.707243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b34c130>]}
[0m02:11:15.708580 [info ] [MainThread]: 
[0m02:11:15.708853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:11:15.709056 [info ] [MainThread]: 
[0m02:11:15.709397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:11:15.712592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:11:15.756947 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:11:15.757273 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:11:15.757519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:16.366066 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.608 seconds
[0m02:11:16.371867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:11:16.387402 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:11:16.387872 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:11:16.520118 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.132 seconds
[0m02:11:16.525125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6a340>]}
[0m02:11:16.528749 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:11:16.529429 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:11:16.529896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:11:16.530243 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:11:16.537765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:11:16.539033 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:11:16.562731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:11:16.563917 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:11:16.564243 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    -- models/lab2_stock_data.sql
select
    symbol,
    date,
    close,
    open,
    high,
    low,
    volume
from USER_DB_MARMOT.dev.lab2_stock_data;
[0m02:11:16.667164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0c7-0305-0bd9-0004-59ff002b6d2a
[0m02:11:16.667548 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 39 unexpected ';'.
[0m02:11:16.673341 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:11:16.674893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a2cb8e-7ec0-4755-b69a-edbcd62dc46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d184ad0>]}
[0m02:11:16.675407 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.14s]
[0m02:11:16.676197 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:11:16.676662 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:11:16.677627 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:11:16.678001 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:11:16.678383 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:11:16.679170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:16.679444 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:11:16.679669 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:11:16.813957 [info ] [MainThread]: 
[0m02:11:16.814475 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m02:11:16.815359 [debug] [MainThread]: Command end result
[0m02:11:16.845762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:11:16.847114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:11:16.851400 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:11:16.851653 [info ] [MainThread]: 
[0m02:11:16.851914 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:11:16.852134 [info ] [MainThread]: 
[0m02:11:16.852399 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:11:16.852603 [info ] [MainThread]: 
[0m02:11:16.852822 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:11:16.854847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3530154, "process_in_blocks": "0", "process_kernel_time": 0.427267, "process_mem_max_rss": "143982592", "process_out_blocks": "0", "process_user_time": 2.031775}
[0m02:11:16.855140 [debug] [MainThread]: Command `dbt run` failed at 02:11:16.855081 after 2.35 seconds
[0m02:11:16.855415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d261700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8276b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fe210>]}
[0m02:11:16.855710 [debug] [MainThread]: Flushing usage events
[0m02:11:17.236025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:58.975237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10385a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470bed0>]}


============================== 02:16:58.982457 | 14a2584d-de7d-4780-9d5b-b7309dad2899 ==============================
[0m02:16:58.982457 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:16:58.983024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:16:58.996340 [info ] [MainThread]: dbt version: 1.9.3
[0m02:16:58.996869 [info ] [MainThread]: python version: 3.13.2
[0m02:16:58.997549 [info ] [MainThread]: python path: /Users/leali/Downloads/226/sjsu-data226-SP25/.venv/bin/python
[0m02:16:58.997981 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit-Mach-O
[0m02:16:59.415802 [info ] [MainThread]: Using profiles dir at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1
[0m02:16:59.416284 [info ] [MainThread]: Using profiles.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/profiles.yml
[0m02:16:59.416693 [info ] [MainThread]: Using dbt_project.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/dbt_project.yml
[0m02:16:59.417529 [info ] [MainThread]: adapter type: snowflake
[0m02:16:59.417871 [info ] [MainThread]: adapter version: 1.9.2
[0m02:16:59.493387 [info ] [MainThread]: Configuration:
[0m02:16:59.493754 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:16:59.493985 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:16:59.494192 [info ] [MainThread]: Required dependencies:
[0m02:16:59.494518 [debug] [MainThread]: Executing "git --help"
[0m02:16:59.518167 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:16:59.519366 [debug] [MainThread]: STDERR: "b''"
[0m02:16:59.519753 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:16:59.520041 [info ] [MainThread]: Connection:
[0m02:16:59.520292 [info ] [MainThread]:   account: SFEDU02-KSB65579
[0m02:16:59.520653 [info ] [MainThread]:   user: MARMOT
[0m02:16:59.520961 [info ] [MainThread]:   database: USER_DB_MARMOT
[0m02:16:59.521181 [info ] [MainThread]:   warehouse: MARMOT_QUERY_WH
[0m02:16:59.521381 [info ] [MainThread]:   role: TRAINING_ROLE
[0m02:16:59.521571 [info ] [MainThread]:   schema: dev
[0m02:16:59.521757 [info ] [MainThread]:   authenticator: None
[0m02:16:59.521941 [info ] [MainThread]:   oauth_client_id: None
[0m02:16:59.522113 [info ] [MainThread]:   query_tag: None
[0m02:16:59.522291 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:16:59.522466 [info ] [MainThread]:   host: None
[0m02:16:59.522637 [info ] [MainThread]:   port: None
[0m02:16:59.522812 [info ] [MainThread]:   proxy_host: None
[0m02:16:59.522981 [info ] [MainThread]:   proxy_port: None
[0m02:16:59.523153 [info ] [MainThread]:   protocol: None
[0m02:16:59.523326 [info ] [MainThread]:   connect_retries: 1
[0m02:16:59.523493 [info ] [MainThread]:   connect_timeout: None
[0m02:16:59.523664 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:16:59.523832 [info ] [MainThread]:   retry_all: False
[0m02:16:59.523998 [info ] [MainThread]:   insecure_mode: False
[0m02:16:59.524167 [info ] [MainThread]:   reuse_connections: True
[0m02:16:59.524663 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:16:59.607582 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:16:59.646513 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:16:59.646866 [debug] [MainThread]: On debug: select 1 as id
[0m02:16:59.647110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:17:00.204259 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.557 seconds
[0m02:17:00.206854 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:17:00.207461 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:17:00.211372 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3079128, "process_in_blocks": "0", "process_kernel_time": 0.328056, "process_mem_max_rss": "138641408", "process_out_blocks": "0", "process_user_time": 1.458749}
[0m02:17:00.212094 [debug] [MainThread]: Command `dbt debug` succeeded at 02:17:00.211955 after 1.31 seconds
[0m02:17:00.212589 [debug] [MainThread]: Connection 'debug' was left open.
[0m02:17:00.212961 [debug] [MainThread]: On debug: Close
[0m02:17:00.356014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027cf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a5590>]}
[0m02:17:00.357307 [debug] [MainThread]: Flushing usage events
[0m02:17:00.765068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:17:06.009040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106662510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110bbed0>]}


============================== 02:17:06.013714 | a22cf60f-756d-492d-85a1-93240aaa1d93 ==============================
[0m02:17:06.013714 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:17:06.014202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m02:17:06.390430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a22cf60f-756d-492d-85a1-93240aaa1d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ebbbb0>]}
[0m02:17:06.438005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a22cf60f-756d-492d-85a1-93240aaa1d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ce2580>]}
[0m02:17:06.438933 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:17:06.526487 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:17:06.666402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:17:06.667570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:17:06.673348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:17:06.802640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a22cf60f-756d-492d-85a1-93240aaa1d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e2b450>]}
[0m02:17:06.894142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:17:06.899226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:17:06.934169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a22cf60f-756d-492d-85a1-93240aaa1d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d96d0>]}
[0m02:17:06.934638 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:17:06.935001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a22cf60f-756d-492d-85a1-93240aaa1d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114429550>]}
[0m02:17:06.936480 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:17:06.938024 [debug] [MainThread]: Command end result
[0m02:17:06.961024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:17:06.962370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:17:06.965085 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:17:06.966764 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0248228, "process_in_blocks": "0", "process_kernel_time": 0.292145, "process_mem_max_rss": "127434752", "process_out_blocks": "0", "process_user_time": 1.688427}
[0m02:17:06.967273 [debug] [MainThread]: Command `dbt test` succeeded at 02:17:06.967166 after 1.03 seconds
[0m02:17:06.967611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114427c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecf710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143cd310>]}
[0m02:17:06.967921 [debug] [MainThread]: Flushing usage events
[0m02:17:07.310966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:21:24.441040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104242510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d7ed0>]}


============================== 02:21:24.445640 | 06b1a03d-acd0-4066-9b91-6d2cd315e84b ==============================
[0m02:21:24.445640 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:21:24.446145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:21:24.903697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06b1a03d-acd0-4066-9b91-6d2cd315e84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdbbb0>]}
[0m02:21:24.944709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06b1a03d-acd0-4066-9b91-6d2cd315e84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8a580>]}
[0m02:21:24.945643 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:21:25.040675 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:21:25.159719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:21:25.160041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:21:25.164136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:21:25.228088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06b1a03d-acd0-4066-9b91-6d2cd315e84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4b450>]}
[0m02:21:25.294964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:21:25.298088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:21:25.329705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06b1a03d-acd0-4066-9b91-6d2cd315e84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f96d0>]}
[0m02:21:25.330160 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:21:25.330427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b1a03d-acd0-4066-9b91-6d2cd315e84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e79550>]}
[0m02:21:25.331661 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:21:25.333244 [debug] [MainThread]: Command end result
[0m02:21:25.360242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:21:25.362464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:21:25.365586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:21:25.368746 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9896279, "process_in_blocks": "0", "process_kernel_time": 0.306041, "process_mem_max_rss": "130809856", "process_out_blocks": "0", "process_user_time": 1.547785}
[0m02:21:25.369745 [debug] [MainThread]: Command `dbt test` succeeded at 02:21:25.369355 after 0.99 seconds
[0m02:21:25.370292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e77c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eeb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ed310>]}
[0m02:21:25.370674 [debug] [MainThread]: Flushing usage events
[0m02:21:25.760969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:21:30.063732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bfa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabed0>]}


============================== 02:21:30.068231 | a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146 ==============================
[0m02:21:30.068231 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:21:30.068777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:21:30.402414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079afbb0>]}
[0m02:21:30.444028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785a580>]}
[0m02:21:30.444888 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:21:30.526929 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:21:30.641675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:21:30.642054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:21:30.646647 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m02:21:30.729005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791b450>]}
[0m02:21:30.795315 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:21:30.797625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:21:30.835475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079aad50>]}
[0m02:21:30.835975 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:21:30.836258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107968d70>]}
[0m02:21:30.838085 [info ] [MainThread]: 
[0m02:21:30.838367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:21:30.838564 [info ] [MainThread]: 
[0m02:21:30.839018 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:21:30.843265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:21:30.896827 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:21:30.897248 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:21:30.897519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:31.348456 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.451 seconds
[0m02:21:31.354040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:21:31.368610 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:21:31.369123 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:21:31.495354 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.126 seconds
[0m02:21:31.499677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dead00>]}
[0m02:21:31.505231 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:21:31.505795 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:21:31.506263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:21:31.506616 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:21:31.513521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:21:31.514617 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:21:31.536176 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" because it is of type table
[0m02:21:31.540719 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA"
[0m02:21:31.545254 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:21:31.545547 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" cascade
[0m02:21:31.716477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m02:21:31.733017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:21:31.734347 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:21:31.734683 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    -- models/lab2_stock_data.sql
select
    symbol,
    date,
    close,
    open,
    high,
    low,
    volume
from USER_DB_MARMOT.dev.lab2_stock_data;
[0m02:21:31.842998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0d1-0305-0bb1-0004-59ff002b90ce
[0m02:21:31.843426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 39 unexpected ';'.
[0m02:21:31.850837 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:21:31.852753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5e7bc37-d8c0-4fe8-bd31-5a4a8f691146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2c410>]}
[0m02:21:31.853393 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.35s]
[0m02:21:31.853919 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:21:31.854348 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:21:31.855546 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:21:31.856021 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:21:31.856468 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:21:31.857376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:31.857640 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:21:31.857886 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:21:32.001871 [info ] [MainThread]: 
[0m02:21:32.002348 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m02:21:32.002938 [debug] [MainThread]: Command end result
[0m02:21:32.028873 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:21:32.030338 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:21:32.035052 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:21:32.035338 [info ] [MainThread]: 
[0m02:21:32.035610 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:21:32.035836 [info ] [MainThread]: 
[0m02:21:32.036103 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 39 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:21:32.036311 [info ] [MainThread]: 
[0m02:21:32.036532 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:21:32.038568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.025073, "process_in_blocks": "0", "process_kernel_time": 0.297915, "process_mem_max_rss": "142000128", "process_out_blocks": "0", "process_user_time": 1.757597}
[0m02:21:32.038860 [debug] [MainThread]: Command `dbt run` failed at 02:21:32.038797 after 2.03 seconds
[0m02:21:32.039127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c485d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8c910>]}
[0m02:21:32.039379 [debug] [MainThread]: Flushing usage events
[0m02:21:32.377821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:22:05.327827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbbed0>]}


============================== 02:22:05.336666 | 08e76874-2fce-47b8-bf44-4b55143e25a7 ==============================
[0m02:22:05.336666 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:22:05.337223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:22:06.148777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119233bb0>]}
[0m02:22:06.200175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190e2580>]}
[0m02:22:06.201405 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:22:06.364493 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:22:06.551345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:22:06.552259 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m02:22:07.088350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:22:07.108288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ed1650>]}
[0m02:22:07.257023 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:22:07.269666 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:22:07.291577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afb890>]}
[0m02:22:07.292140 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:22:07.292717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea1b70>]}
[0m02:22:07.294748 [info ] [MainThread]: 
[0m02:22:07.295205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:22:07.295496 [info ] [MainThread]: 
[0m02:22:07.296062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:22:07.301125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:22:07.377988 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:22:07.378377 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:22:07.378664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:07.932658 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.554 seconds
[0m02:22:07.937403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:22:07.949729 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:22:07.950159 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:22:08.071448 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.121 seconds
[0m02:22:08.075713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a366340>]}
[0m02:22:08.079558 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:22:08.080326 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:22:08.081105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:22:08.081588 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:22:08.091240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:22:08.092546 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:22:08.118349 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:22:08.119670 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:22:08.120007 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    -- models/lab2_stock_data.sql
select
    symbol,
    date,
    close,
    open,
    high,
    low,
    volume
from USER_DB_MARMOT.dev.lab2_stock_data
  );
[0m02:22:08.247665 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0d2-0305-0be2-0004-59ff002b718e
[0m02:22:08.248160 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m02:22:08.255539 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:22:08.257641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08e76874-2fce-47b8-bf44-4b55143e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a884c50>]}
[0m02:22:08.258236 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.18s]
[0m02:22:08.258695 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:22:08.259104 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:22:08.260306 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:22:08.260701 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:22:08.261043 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:22:08.261913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:08.262232 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:22:08.262502 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:22:08.400503 [info ] [MainThread]: 
[0m02:22:08.401357 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m02:22:08.402378 [debug] [MainThread]: Command end result
[0m02:22:08.439454 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:22:08.441072 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:22:08.446341 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:22:08.446621 [info ] [MainThread]: 
[0m02:22:08.446902 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:22:08.447126 [info ] [MainThread]: 
[0m02:22:08.447401 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:22:08.447640 [info ] [MainThread]: 
[0m02:22:08.447861 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:22:08.450128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2006314, "process_in_blocks": "0", "process_kernel_time": 0.496303, "process_mem_max_rss": "137445376", "process_out_blocks": "0", "process_user_time": 2.487555}
[0m02:22:08.450437 [debug] [MainThread]: Command `dbt run` failed at 02:22:08.450376 after 3.20 seconds
[0m02:22:08.450738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa61180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d5acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d5b890>]}
[0m02:22:08.450997 [debug] [MainThread]: Flushing usage events
[0m02:22:08.790654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:25:01.232288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747ed0>]}


============================== 02:25:01.246329 | b6bc9d04-0dab-42d3-b235-b37d3ff8dfce ==============================
[0m02:25:01.246329 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:25:01.247011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:25:02.674484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764bbb0>]}
[0m02:25:02.756525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa580>]}
[0m02:25:02.758959 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:25:03.064855 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:25:03.370360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:25:03.371119 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m02:25:03.779191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:25:03.797887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792d650>]}
[0m02:25:03.936642 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:25:03.943797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:25:03.978159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035cb890>]}
[0m02:25:03.978597 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:25:03.978870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662db70>]}
[0m02:25:03.980736 [info ] [MainThread]: 
[0m02:25:03.981065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:25:03.981279 [info ] [MainThread]: 
[0m02:25:03.981635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:25:03.985419 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:25:04.052345 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:25:04.052719 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:25:04.053026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:25:04.956752 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.903 seconds
[0m02:25:04.968457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:25:04.983165 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:25:04.983565 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:25:05.102649 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.119 seconds
[0m02:25:05.105702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527c70>]}
[0m02:25:05.116675 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:25:05.117183 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:25:05.117852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:25:05.118228 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:25:05.131447 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:25:05.139593 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:25:05.211015 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" because it is of type table
[0m02:25:05.223842 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA"
[0m02:25:05.232923 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:25:05.233621 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" cascade
[0m02:25:05.395432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m02:25:05.406075 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:25:05.406984 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:25:05.407316 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Make sure 'dev' matches the source name from your sources.yml
  );
[0m02:25:05.556833 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0d5-0305-0be2-0004-59ff002b7226
[0m02:25:05.557306 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m02:25:05.563990 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:25:05.566768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bc9d04-0dab-42d3-b235-b37d3ff8dfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108944ad0>]}
[0m02:25:05.567449 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.45s]
[0m02:25:05.568020 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:25:05.568443 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:25:05.570160 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:25:05.570567 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:25:05.570939 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:25:05.571918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:25:05.572205 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:25:05.572442 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:25:05.716659 [info ] [MainThread]: 
[0m02:25:05.717129 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m02:25:05.717839 [debug] [MainThread]: Command end result
[0m02:25:05.764648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:25:05.766467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:25:05.772527 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:25:05.772856 [info ] [MainThread]: 
[0m02:25:05.773148 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:25:05.773371 [info ] [MainThread]: 
[0m02:25:05.773821 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:25:05.774521 [info ] [MainThread]: 
[0m02:25:05.774834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:25:05.790448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.81107, "process_in_blocks": "0", "process_kernel_time": 0.537891, "process_mem_max_rss": "137265152", "process_out_blocks": "0", "process_user_time": 2.190525}
[0m02:25:05.794206 [debug] [MainThread]: Command `dbt run` failed at 02:25:05.794071 after 4.82 seconds
[0m02:25:05.797114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a21700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f750>]}
[0m02:25:05.797492 [debug] [MainThread]: Flushing usage events
[0m02:25:06.208785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:43.073668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fbbed0>]}


============================== 02:27:43.082664 | cb3b396c-8b7d-4847-9911-411d4898f214 ==============================
[0m02:27:43.082664 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:27:43.083189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:27:44.151507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115133bb0>]}
[0m02:27:44.196776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fe2580>]}
[0m02:27:44.200103 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:27:44.306792 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:27:44.488465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:27:44.488867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:27:44.494261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:27:44.573224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150a3450>]}
[0m02:27:45.924763 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:27:46.097893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:27:46.428634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11512ed50>]}
[0m02:27:46.429291 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:27:46.429700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150f0d70>]}
[0m02:27:46.431398 [info ] [MainThread]: 
[0m02:27:46.431703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:27:46.431918 [info ] [MainThread]: 
[0m02:27:46.432357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:27:46.437118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:27:46.613810 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:27:46.614697 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:27:46.615036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:47.370306 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.755 seconds
[0m02:27:47.374142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:27:47.384808 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:27:47.385251 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:27:47.493918 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.108 seconds
[0m02:27:47.496824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11602ac30>]}
[0m02:27:47.499950 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:27:47.500460 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.lab2_stock_data ................................ [RUN]
[0m02:27:47.500860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:27:47.501165 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:27:47.518036 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:27:47.526436 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:27:47.560256 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" because it is of type table
[0m02:27:47.574280 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA"
[0m02:27:47.580181 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:27:47.580558 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_DATA" cascade
[0m02:27:47.768935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m02:27:47.787276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:27:47.789377 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:27:47.790077 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_data
  
   as (
    

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Make sure 'dev' matches the source name from your sources.yml
  );
[0m02:27:47.964815 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0d7-0305-0bd9-0004-59ff002b6fb2
[0m02:27:47.965602 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
[0m02:27:47.976974 [debug] [Thread-1 (]: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:27:47.980358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb3b396c-8b7d-4847-9911-411d4898f214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116844290>]}
[0m02:27:47.981494 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev.lab2_stock_data ....................... [[31mERROR[0m in 0.48s]
[0m02:27:47.982420 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:27:47.983581 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_data' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql.
[0m02:27:47.986527 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:27:47.986942 [info ] [Thread-1 (]: 2 of 2 SKIP relation dev.lab2_stock_moving_avg ................................. [[33mSKIP[0m]
[0m02:27:47.987287 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:27:47.990426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:47.990870 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_data' was left open.
[0m02:27:47.991341 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_data: Close
[0m02:27:48.144214 [info ] [MainThread]: 
[0m02:27:48.144782 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m02:27:48.145539 [debug] [MainThread]: Command end result
[0m02:27:48.182784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:27:48.185360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:27:48.191438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:27:48.191762 [info ] [MainThread]: 
[0m02:27:48.192107 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:27:48.192441 [info ] [MainThread]: 
[0m02:27:48.192776 [error] [MainThread]:   Database Error in model lab2_stock_data (models/lab2_stock_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MARMOT.DEV.LAB2_STOCK_DATA' does not exist or not authorized.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_data.sql
[0m02:27:48.193059 [info ] [MainThread]: 
[0m02:27:48.193345 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:27:48.196253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.221323, "process_in_blocks": "0", "process_kernel_time": 0.520153, "process_mem_max_rss": "124665856", "process_out_blocks": "0", "process_user_time": 1.961154}
[0m02:27:48.196620 [debug] [MainThread]: Command `dbt run` failed at 02:27:48.196550 after 5.22 seconds
[0m02:27:48.197010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168181b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11676e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11676c910>]}
[0m02:27:48.197295 [debug] [MainThread]: Flushing usage events
[0m02:27:48.650694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:53.473991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4fed0>]}


============================== 02:31:53.478382 | a8b0ed77-9ca0-4765-913f-c56e10e9156f ==============================
[0m02:31:53.478382 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:31:53.478872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:31:53.900353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109953bb0>]}
[0m02:31:53.941415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109802580>]}
[0m02:31:53.942447 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:31:54.029965 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:31:54.148347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:31:54.148897 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m02:31:54.413088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:31:54.422121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c35650>]}
[0m02:31:54.494009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:31:54.496908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:31:54.512699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d3890>]}
[0m02:31:54.513081 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:31:54.513340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108935b70>]}
[0m02:31:54.514648 [info ] [MainThread]: 
[0m02:31:54.514899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:31:54.515100 [info ] [MainThread]: 
[0m02:31:54.515437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:31:54.518700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:31:54.562783 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:31:54.563123 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:31:54.563359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:55.181683 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.618 seconds
[0m02:31:55.184252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:31:55.193113 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:31:55.193446 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:31:55.328157 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.134 seconds
[0m02:31:55.330862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82bc70>]}
[0m02:31:55.333377 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:31:55.333792 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m02:31:55.334135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:31:55.334399 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:31:55.340122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:31:55.341116 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:31:55.365502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:31:55.366412 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:31:55.366730 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m02:31:56.029000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m02:31:56.058434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac4ca10>]}
[0m02:31:56.059262 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m02:31:56.059822 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:31:56.060513 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:31:56.060962 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m02:31:56.061659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m02:31:56.062045 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:31:56.064151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:31:56.064812 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:31:56.076491 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_MOVING_AVG" because it is of type table
[0m02:31:56.081056 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_MOVING_AVG"
[0m02:31:56.087128 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:31:56.087446 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_MOVING_AVG" cascade
[0m02:31:56.233516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m02:31:56.250036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:31:56.256532 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:31:56.257039 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    -- models/lab2_stock_moving_avg.sql
with calculated_avg as (
    select
        symbol,
        date,
        avg(close) over (partition by symbol order by date rows between 4 preceding and current row) as moving_avg
    from USER_DB_MARMOT.dev.lab2_stock_data
)
select
    symbol,
    date,
    moving_avg
from calculated_avg;
[0m02:31:56.356889 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0db-0305-0be2-0004-59ff002b735e
[0m02:31:56.357503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 19 unexpected ';'.
[0m02:31:56.365915 [debug] [Thread-1 (]: Database Error in model lab2_stock_moving_avg (models/lab2_stock_moving_avg.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 19 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_moving_avg.sql
[0m02:31:56.366556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8b0ed77-9ca0-4765-913f-c56e10e9156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad29d30>]}
[0m02:31:56.367253 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model dev.lab2_stock_moving_avg ................. [[31mERROR[0m in 0.30s]
[0m02:31:56.367772 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:31:56.368298 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_moving_avg' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_moving_avg (models/lab2_stock_moving_avg.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 19 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_moving_avg.sql.
[0m02:31:56.370293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:56.370658 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m02:31:56.370926 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m02:31:56.524176 [info ] [MainThread]: 
[0m02:31:56.524622 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m02:31:56.525363 [debug] [MainThread]: Command end result
[0m02:31:56.561069 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:31:56.562809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:31:56.567652 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:31:56.567911 [info ] [MainThread]: 
[0m02:31:56.568192 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:31:56.568417 [info ] [MainThread]: 
[0m02:31:56.568676 [error] [MainThread]:   Database Error in model lab2_stock_moving_avg (models/lab2_stock_moving_avg.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 19 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_moving_avg.sql
[0m02:31:56.568876 [info ] [MainThread]: 
[0m02:31:56.569106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:31:56.570674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1567523, "process_in_blocks": "0", "process_kernel_time": 0.362065, "process_mem_max_rss": "144211968", "process_out_blocks": "0", "process_user_time": 1.98854}
[0m02:31:56.570969 [debug] [MainThread]: Command `dbt run` failed at 02:31:56.570909 after 3.16 seconds
[0m02:31:56.571252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad4b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adaeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9ae50>]}
[0m02:31:56.571500 [debug] [MainThread]: Flushing usage events
[0m02:31:56.943088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:32:11.794850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12085a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dbbed0>]}


============================== 02:32:11.801778 | dad7b2ba-6a87-4c16-abd1-7cd79471bffc ==============================
[0m02:32:11.801778 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:32:11.802326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:32:12.313481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fbbbb0>]}
[0m02:32:12.354532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ede580>]}
[0m02:32:12.355347 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:32:12.442203 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:32:12.555082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:32:12.555622 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m02:32:12.775719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m02:32:12.784874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f2b350>]}
[0m02:32:12.846020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:32:12.849209 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:32:12.864628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fb6d50>]}
[0m02:32:12.865009 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:32:12.865297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235967b0>]}
[0m02:32:12.866652 [info ] [MainThread]: 
[0m02:32:12.867194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:32:12.867491 [info ] [MainThread]: 
[0m02:32:12.867896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:32:12.871609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:32:12.942868 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:32:12.943663 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:32:12.943970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:13.461191 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.517 seconds
[0m02:32:13.466432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m02:32:13.481840 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:32:13.482331 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:32:13.608040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.125 seconds
[0m02:32:13.613496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235bf520>]}
[0m02:32:13.617399 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:32:13.618031 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m02:32:13.618489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:32:13.618838 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:32:13.626609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:32:13.627365 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:32:13.652277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:32:13.653079 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:32:13.653363 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    close
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m02:32:14.474746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m02:32:14.506754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f5cf50>]}
[0m02:32:14.507455 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.89s]
[0m02:32:14.507942 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:32:14.508583 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:32:14.509019 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m02:32:14.509421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m02:32:14.509701 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:32:14.511753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:32:14.512362 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:32:14.530613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:32:14.531609 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:32:14.531924 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    -- models/lab2_stock_moving_avg.sql
with calculated_avg as (
    select
        symbol,
        date,
        avg(close) over (partition by symbol order by date rows between 4 preceding and current row) as moving_avg
    from USER_DB_MARMOT.dev.lab2_stock_data
)
select
    symbol,
    date,
    moving_avg
from calculated_avg
  );
[0m02:32:14.787411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m02:32:14.794415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad7b2ba-6a87-4c16-abd1-7cd79471bffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b18d60>]}
[0m02:32:14.796305 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.28s]
[0m02:32:14.797012 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:32:14.798593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:32:14.798979 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m02:32:14.799349 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m02:32:14.934512 [info ] [MainThread]: 
[0m02:32:14.935149 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m02:32:14.936200 [debug] [MainThread]: Command end result
[0m02:32:14.964289 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:32:14.965944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:32:14.970527 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:32:14.970849 [info ] [MainThread]: 
[0m02:32:14.971157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:32:14.971386 [info ] [MainThread]: 
[0m02:32:14.971618 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:32:14.973198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2410648, "process_in_blocks": "0", "process_kernel_time": 0.332669, "process_mem_max_rss": "144965632", "process_out_blocks": "0", "process_user_time": 1.945774}
[0m02:32:14.973542 [debug] [MainThread]: Command `dbt run` succeeded at 02:32:14.973473 after 3.24 seconds
[0m02:32:14.973825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f8c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f56c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235c6750>]}
[0m02:32:14.974101 [debug] [MainThread]: Flushing usage events
[0m02:32:15.309036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:33:13.893245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b52510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7ed0>]}


============================== 02:33:13.900664 | bcfcaa07-e34a-41cb-ad1a-c4ef2cbc9453 ==============================
[0m02:33:13.900664 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:33:13.901210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m02:33:14.323507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcfcaa07-e34a-41cb-ad1a-c4ef2cbc9453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ebbb0>]}
[0m02:33:14.366092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcfcaa07-e34a-41cb-ad1a-c4ef2cbc9453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779a580>]}
[0m02:33:14.369171 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:33:14.452892 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:33:14.571308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:33:14.571781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:33:14.576013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:33:14.641972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcfcaa07-e34a-41cb-ad1a-c4ef2cbc9453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785b550>]}
[0m02:33:14.711928 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:33:14.714626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:33:14.729685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcfcaa07-e34a-41cb-ad1a-c4ef2cbc9453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e6d50>]}
[0m02:33:14.730054 [info ] [MainThread]: Found 2 models, 1 source, 474 macros
[0m02:33:14.730309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfcaa07-e34a-41cb-ad1a-c4ef2cbc9453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078aa510>]}
[0m02:33:14.731483 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:33:14.732816 [debug] [MainThread]: Command end result
[0m02:33:14.768799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:33:14.771224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:33:14.777327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:33:14.782486 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.9597378, "process_in_blocks": "0", "process_kernel_time": 0.270443, "process_mem_max_rss": "128860160", "process_out_blocks": "0", "process_user_time": 1.549371}
[0m02:33:14.783191 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:33:14.783049 after 0.96 seconds
[0m02:33:14.783569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b34ad0>]}
[0m02:33:14.783920 [debug] [MainThread]: Flushing usage events
[0m02:33:15.194679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:33.525965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108012510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3ed0>]}


============================== 02:34:33.532086 | 41fccc66-71ab-43e9-94d2-7206dd75b25c ==============================
[0m02:34:33.532086 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:34:33.532599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:34:34.068067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41fccc66-71ab-43e9-94d2-7206dd75b25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a033bb0>]}
[0m02:34:34.113658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41fccc66-71ab-43e9-94d2-7206dd75b25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee2580>]}
[0m02:34:34.114763 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:34:34.200977 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:34:34.320051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:34:34.320525 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:34:34.514592 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 5
      config(
[0m02:34:34.516887 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.0703828, "process_in_blocks": "0", "process_kernel_time": 0.306956, "process_mem_max_rss": "130826240", "process_out_blocks": "0", "process_user_time": 1.635012}
[0m02:34:34.517250 [debug] [MainThread]: Command `dbt snapshot` failed at 02:34:34.517167 after 1.07 seconds
[0m02:34:34.517533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d47890>]}
[0m02:34:34.517817 [debug] [MainThread]: Flushing usage events
[0m02:34:34.953973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:43.554289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbbed0>]}


============================== 02:35:43.560185 | f0ddd09b-c529-4006-bf48-5672f87096da ==============================
[0m02:35:43.560185 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:35:43.560743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:35:44.145065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ddd09b-c529-4006-bf48-5672f87096da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f47bb0>]}
[0m02:35:44.187940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0ddd09b-c529-4006-bf48-5672f87096da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6e580>]}
[0m02:35:44.189055 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:35:44.288002 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:35:44.421745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:35:44.422324 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:35:44.661910 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 5
      config(
[0m02:35:44.664248 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.1716883, "process_in_blocks": "0", "process_kernel_time": 0.401367, "process_mem_max_rss": "126550016", "process_out_blocks": "0", "process_user_time": 1.791026}
[0m02:35:44.664676 [debug] [MainThread]: Command `dbt snapshot` failed at 02:35:44.664583 after 1.17 seconds
[0m02:35:44.664981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102137890>]}
[0m02:35:44.665280 [debug] [MainThread]: Flushing usage events
[0m02:35:45.018931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:36:09.972076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104946510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bbed0>]}


============================== 02:36:09.976338 | fdd22517-4872-4065-b672-6f98301a6900 ==============================
[0m02:36:09.976338 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:36:09.976810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:36:10.354037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdd22517-4872-4065-b672-6f98301a6900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bbbb0>]}
[0m02:36:10.401889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdd22517-4872-4065-b672-6f98301a6900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e2580>]}
[0m02:36:10.402868 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:36:10.491657 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:36:10.607114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:36:10.607572 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:36:10.828969 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  Encountered unknown tag 'config'.
    line 5
      config(
[0m02:36:10.830737 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.91561514, "process_in_blocks": "0", "process_kernel_time": 0.236634, "process_mem_max_rss": "127991808", "process_out_blocks": "0", "process_user_time": 1.569573}
[0m02:36:10.831126 [debug] [MainThread]: Command `dbt snapshot` failed at 02:36:10.831041 after 0.92 seconds
[0m02:36:10.831438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107727650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107727d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101efb890>]}
[0m02:36:10.831715 [debug] [MainThread]: Flushing usage events
[0m02:36:11.212913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:36:45.272392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d42510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122bbed0>]}


============================== 02:36:45.276815 | 7b2dc457-be57-4df7-bfdc-0a0404e8768b ==============================
[0m02:36:45.276815 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:36:45.277303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:36:45.687412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b2dc457-be57-4df7-bfdc-0a0404e8768b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135bbbb0>]}
[0m02:36:45.728301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b2dc457-be57-4df7-bfdc-0a0404e8768b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e2580>]}
[0m02:36:45.729126 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:36:45.815169 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:36:45.932096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:36:45.932554 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:36:46.128906 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  Encountered unknown tag 'config'.
    line 5
      config(
[0m02:36:46.131178 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.9176389, "process_in_blocks": "0", "process_kernel_time": 0.247716, "process_mem_max_rss": "128860160", "process_out_blocks": "0", "process_user_time": 1.575888}
[0m02:36:46.131563 [debug] [MainThread]: Command `dbt snapshot` failed at 02:36:46.131484 after 0.92 seconds
[0m02:36:46.132063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632b890>]}
[0m02:36:46.132343 [debug] [MainThread]: Flushing usage events
[0m02:36:46.484637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:02.690067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbfed0>]}


============================== 02:37:02.694462 | d75d8d71-fa4e-4a0c-a5dd-95cd1db6dbad ==============================
[0m02:37:02.694462 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:37:02.694982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:37:03.072845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd75d8d71-fa4e-4a0c-a5dd-95cd1db6dbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a833bb0>]}
[0m02:37:03.113751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd75d8d71-fa4e-4a0c-a5dd-95cd1db6dbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e2580>]}
[0m02:37:03.114626 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:37:03.200647 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:37:03.313729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:37:03.314187 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:37:03.508705 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  Encountered unknown tag 'config'.
    line 5
      config(
[0m02:37:03.511034 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.8818328, "process_in_blocks": "0", "process_kernel_time": 0.255087, "process_mem_max_rss": "129056768", "process_out_blocks": "0", "process_user_time": 1.582859}
[0m02:37:03.511415 [debug] [MainThread]: Command `dbt snapshot` failed at 02:37:03.511333 after 0.88 seconds
[0m02:37:03.511703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a79f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a79fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a43890>]}
[0m02:37:03.511974 [debug] [MainThread]: Flushing usage events
[0m02:37:03.855422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:48:57.275626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108446510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bbed0>]}


============================== 02:48:57.281332 | 3d973ce0-a67b-4120-b81b-f4d44c55b5d8 ==============================
[0m02:48:57.281332 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:48:57.282143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:48:57.818910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d973ce0-a67b-4120-b81b-f4d44c55b5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a747bb0>]}
[0m02:48:57.861635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d973ce0-a67b-4120-b81b-f4d44c55b5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66e580>]}
[0m02:48:57.862588 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:48:57.952746 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:48:58.078780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:48:58.079357 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:48:58.304652 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  Encountered unknown tag 'config'.
    line 5
      config(
[0m02:48:58.306899 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.0939599, "process_in_blocks": "0", "process_kernel_time": 0.306115, "process_mem_max_rss": "129515520", "process_out_blocks": "0", "process_user_time": 1.645427}
[0m02:48:58.307283 [debug] [MainThread]: Command `dbt snapshot` failed at 02:48:58.307203 after 1.09 seconds
[0m02:48:58.307581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6b3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6b3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fb890>]}
[0m02:48:58.307868 [debug] [MainThread]: Flushing usage events
[0m02:48:58.751658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:49:50.912648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bee510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109bbed0>]}


============================== 02:49:50.917315 | dae9cd9e-1a67-4df8-8a38-d73d437207ab ==============================
[0m02:49:50.917315 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:49:50.918039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:49:51.351729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dae9cd9e-1a67-4df8-8a38-d73d437207ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbbbb0>]}
[0m02:49:51.396392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dae9cd9e-1a67-4df8-8a38-d73d437207ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae2580>]}
[0m02:49:51.397322 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:49:51.480337 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:49:51.597545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:49:51.598037 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:49:51.811648 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 5
      config(
[0m02:49:51.813962 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.9629678, "process_in_blocks": "0", "process_kernel_time": 0.260705, "process_mem_max_rss": "126910464", "process_out_blocks": "0", "process_user_time": 1.59278}
[0m02:49:51.814360 [debug] [MainThread]: Command `dbt snapshot` failed at 02:49:51.814279 after 0.96 seconds
[0m02:49:51.814655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043eb890>]}
[0m02:49:51.814932 [debug] [MainThread]: Flushing usage events
[0m02:49:52.158869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:50:43.006734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107546510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108bbed0>]}


============================== 02:50:43.021850 | 3d2c6f45-6199-4bd8-81c1-da6c9a185599 ==============================
[0m02:50:43.021850 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:50:43.022414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:50:44.630649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d2c6f45-6199-4bd8-81c1-da6c9a185599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119bbbb0>]}
[0m02:50:44.684894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d2c6f45-6199-4bd8-81c1-da6c9a185599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e2580>]}
[0m02:50:44.686634 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:50:44.870549 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:50:45.211227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:50:45.212160 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:50:45.519660 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m02:50:45.532795 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.6674716, "process_in_blocks": "0", "process_kernel_time": 0.532858, "process_mem_max_rss": "125026304", "process_out_blocks": "0", "process_user_time": 1.936678}
[0m02:50:45.534409 [debug] [MainThread]: Command `dbt snapshot` failed at 02:50:45.534157 after 2.67 seconds
[0m02:50:45.534821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b13890>]}
[0m02:50:45.535259 [debug] [MainThread]: Flushing usage events
[0m02:50:46.200057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:51:14.285062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bbed0>]}


============================== 02:51:14.289165 | 7dd6842b-bfec-4a8d-b7bd-248f89a55902 ==============================
[0m02:51:14.289165 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:51:14.289655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:51:14.664886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd6842b-bfec-4a8d-b7bd-248f89a55902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcbbbb0>]}
[0m02:51:14.705548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd6842b-bfec-4a8d-b7bd-248f89a55902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbde580>]}
[0m02:51:14.706386 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:51:14.793041 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:51:14.908369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:51:14.908862 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:51:15.117178 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m02:51:15.119688 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.8928748, "process_in_blocks": "0", "process_kernel_time": 0.249589, "process_mem_max_rss": "127369216", "process_out_blocks": "0", "process_user_time": 1.583127}
[0m02:51:15.120118 [debug] [MainThread]: Command `dbt snapshot` failed at 02:51:15.120004 after 0.89 seconds
[0m02:51:15.120430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc2b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc2bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fb890>]}
[0m02:51:15.120730 [debug] [MainThread]: Flushing usage events
[0m02:51:15.478182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:52:02.510407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120746510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236bbed0>]}


============================== 02:52:02.514772 | 62e52fc8-1f4c-48eb-8284-58a4ab208c24 ==============================
[0m02:52:02.514772 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:52:02.515334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m02:52:02.527294 [info ] [MainThread]: dbt version: 1.9.3
[0m02:52:02.527923 [info ] [MainThread]: python version: 3.13.2
[0m02:52:02.528388 [info ] [MainThread]: python path: /Users/leali/Downloads/226/sjsu-data226-SP25/.venv/bin/python
[0m02:52:02.528782 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit-Mach-O
[0m02:52:02.783230 [info ] [MainThread]: Using profiles dir at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1
[0m02:52:02.783613 [info ] [MainThread]: Using profiles.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/profiles.yml
[0m02:52:02.783844 [info ] [MainThread]: Using dbt_project.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/dbt_project.yml
[0m02:52:02.784363 [info ] [MainThread]: adapter type: snowflake
[0m02:52:02.784791 [info ] [MainThread]: adapter version: 1.9.2
[0m02:52:02.854089 [info ] [MainThread]: Configuration:
[0m02:52:02.854456 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:52:02.854677 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:52:02.854870 [info ] [MainThread]: Required dependencies:
[0m02:52:02.855130 [debug] [MainThread]: Executing "git --help"
[0m02:52:02.873383 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:52:02.874172 [debug] [MainThread]: STDERR: "b''"
[0m02:52:02.874460 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:52:02.874713 [info ] [MainThread]: Connection:
[0m02:52:02.874963 [info ] [MainThread]:   account: SFEDU02-KSB65579
[0m02:52:02.875152 [info ] [MainThread]:   user: MARMOT
[0m02:52:02.875331 [info ] [MainThread]:   database: USER_DB_MARMOT
[0m02:52:02.875507 [info ] [MainThread]:   warehouse: MARMOT_QUERY_WH
[0m02:52:02.875679 [info ] [MainThread]:   role: TRAINING_ROLE
[0m02:52:02.875852 [info ] [MainThread]:   schema: dev
[0m02:52:02.876030 [info ] [MainThread]:   authenticator: None
[0m02:52:02.876198 [info ] [MainThread]:   oauth_client_id: None
[0m02:52:02.876367 [info ] [MainThread]:   query_tag: None
[0m02:52:02.876537 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:52:02.876713 [info ] [MainThread]:   host: None
[0m02:52:02.876884 [info ] [MainThread]:   port: None
[0m02:52:02.877049 [info ] [MainThread]:   proxy_host: None
[0m02:52:02.877218 [info ] [MainThread]:   proxy_port: None
[0m02:52:02.877383 [info ] [MainThread]:   protocol: None
[0m02:52:02.877549 [info ] [MainThread]:   connect_retries: 1
[0m02:52:02.877718 [info ] [MainThread]:   connect_timeout: None
[0m02:52:02.877883 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:52:02.878048 [info ] [MainThread]:   retry_all: False
[0m02:52:02.878254 [info ] [MainThread]:   insecure_mode: False
[0m02:52:02.878420 [info ] [MainThread]:   reuse_connections: True
[0m02:52:02.878907 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:52:02.955018 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:52:02.989583 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:52:02.989909 [debug] [MainThread]: On debug: select 1 as id
[0m02:52:02.990137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:03.508884 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.518 seconds
[0m02:52:03.511528 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:52:03.512205 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:52:03.515660 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0568995, "process_in_blocks": "0", "process_kernel_time": 0.234671, "process_mem_max_rss": "139837440", "process_out_blocks": "0", "process_user_time": 1.401412}
[0m02:52:03.516382 [debug] [MainThread]: Command `dbt debug` succeeded at 02:52:03.516252 after 1.06 seconds
[0m02:52:03.516831 [debug] [MainThread]: Connection 'debug' was left open.
[0m02:52:03.517186 [debug] [MainThread]: On debug: Close
[0m02:52:03.662538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255a7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12549d590>]}
[0m02:52:03.663847 [debug] [MainThread]: Flushing usage events
[0m02:52:04.043028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:55:42.203115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b96510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbbed0>]}


============================== 02:55:42.210583 | 731b87d4-e6ae-4b2b-9bb7-242e6a907f6c ==============================
[0m02:55:42.210583 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:55:42.211159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:55:42.798709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '731b87d4-e6ae-4b2b-9bb7-242e6a907f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131bbbb0>]}
[0m02:55:42.845226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '731b87d4-e6ae-4b2b-9bb7-242e6a907f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130de580>]}
[0m02:55:42.848001 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:55:42.932644 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:55:43.049562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:55:43.050225 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m02:55:43.244550 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m02:55:43.246797 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.1222594, "process_in_blocks": "0", "process_kernel_time": 0.36611, "process_mem_max_rss": "127926272", "process_out_blocks": "0", "process_user_time": 1.72355}
[0m02:55:43.247188 [debug] [MainThread]: Command `dbt snapshot` failed at 02:55:43.247093 after 1.12 seconds
[0m02:55:43.247490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11312b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11312bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283890>]}
[0m02:55:43.247823 [debug] [MainThread]: Flushing usage events
[0m02:55:43.721918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:04:40.432342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108156510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109003c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109003ed0>]}


============================== 03:04:40.437141 | 0db9c534-9c4b-4161-861b-75d003c31f29 ==============================
[0m03:04:40.437141 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:04:40.437675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:04:40.450648 [info ] [MainThread]: dbt version: 1.9.3
[0m03:04:40.451037 [info ] [MainThread]: python version: 3.13.2
[0m03:04:40.451299 [info ] [MainThread]: python path: /Users/leali/Downloads/226/sjsu-data226-SP25/.venv/bin/python
[0m03:04:40.451510 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit-Mach-O
[0m03:04:40.827687 [info ] [MainThread]: Using profiles dir at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1
[0m03:04:40.828053 [info ] [MainThread]: Using profiles.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/profiles.yml
[0m03:04:40.828281 [info ] [MainThread]: Using dbt_project.yml file at /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/dbt_project.yml
[0m03:04:40.828811 [info ] [MainThread]: adapter type: snowflake
[0m03:04:40.829088 [info ] [MainThread]: adapter version: 1.9.2
[0m03:04:40.899575 [info ] [MainThread]: Configuration:
[0m03:04:40.899942 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:04:40.900198 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:04:40.900491 [info ] [MainThread]: Required dependencies:
[0m03:04:40.900808 [debug] [MainThread]: Executing "git --help"
[0m03:04:41.015628 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:04:41.017258 [debug] [MainThread]: STDERR: "b''"
[0m03:04:41.018311 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:04:41.018898 [info ] [MainThread]: Connection:
[0m03:04:41.019470 [info ] [MainThread]:   account: SFEDU02-KSB65579
[0m03:04:41.020053 [info ] [MainThread]:   user: MARMOT
[0m03:04:41.020329 [info ] [MainThread]:   database: USER_DB_MARMOT
[0m03:04:41.020593 [info ] [MainThread]:   warehouse: MARMOT_QUERY_WH
[0m03:04:41.021379 [info ] [MainThread]:   role: TRAINING_ROLE
[0m03:04:41.021733 [info ] [MainThread]:   schema: dev
[0m03:04:41.021942 [info ] [MainThread]:   authenticator: None
[0m03:04:41.022127 [info ] [MainThread]:   oauth_client_id: None
[0m03:04:41.022354 [info ] [MainThread]:   query_tag: None
[0m03:04:41.022938 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:04:41.023588 [info ] [MainThread]:   host: None
[0m03:04:41.023824 [info ] [MainThread]:   port: None
[0m03:04:41.024027 [info ] [MainThread]:   proxy_host: None
[0m03:04:41.024274 [info ] [MainThread]:   proxy_port: None
[0m03:04:41.024527 [info ] [MainThread]:   protocol: None
[0m03:04:41.024737 [info ] [MainThread]:   connect_retries: 1
[0m03:04:41.025275 [info ] [MainThread]:   connect_timeout: None
[0m03:04:41.025879 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:04:41.026094 [info ] [MainThread]:   retry_all: False
[0m03:04:41.026287 [info ] [MainThread]:   insecure_mode: False
[0m03:04:41.026638 [info ] [MainThread]:   reuse_connections: True
[0m03:04:41.044938 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:04:41.644780 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:04:41.796041 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:04:41.796733 [debug] [MainThread]: On debug: select 1 as id
[0m03:04:41.797195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:04:42.566193 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.769 seconds
[0m03:04:42.568572 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:04:42.569084 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:04:42.572448 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2076986, "process_in_blocks": "0", "process_kernel_time": 0.395692, "process_mem_max_rss": "132759552", "process_out_blocks": "0", "process_user_time": 1.479813}
[0m03:04:42.573158 [debug] [MainThread]: Command `dbt debug` succeeded at 03:04:42.573005 after 2.21 seconds
[0m03:04:42.573585 [debug] [MainThread]: Connection 'debug' was left open.
[0m03:04:42.573971 [debug] [MainThread]: On debug: Close
[0m03:04:42.723101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e75590>]}
[0m03:04:42.723599 [debug] [MainThread]: Flushing usage events
[0m03:04:43.252594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:04:47.075854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d7ed0>]}


============================== 03:04:47.081866 | ba3ad1ec-5386-44f1-a1bb-110b11136cc5 ==============================
[0m03:04:47.081866 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:04:47.082789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:04:47.463176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba3ad1ec-5386-44f1-a1bb-110b11136cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fdbbb0>]}
[0m03:04:47.513912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba3ad1ec-5386-44f1-a1bb-110b11136cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8a580>]}
[0m03:04:47.514948 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:04:47.605503 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:04:47.725534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:04:47.726000 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:04:47.938745 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_data_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m03:04:47.940900 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.92763335, "process_in_blocks": "0", "process_kernel_time": 0.256742, "process_mem_max_rss": "127942656", "process_out_blocks": "0", "process_user_time": 1.624606}
[0m03:04:47.941284 [debug] [MainThread]: Command `dbt snapshot` failed at 03:04:47.941213 after 0.93 seconds
[0m03:04:47.941570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f47650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f47d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5b890>]}
[0m03:04:47.941843 [debug] [MainThread]: Flushing usage events
[0m03:04:48.288930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:06:08.678465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105642510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3ed0>]}


============================== 03:06:08.694438 | 69dd22a1-c394-43f9-affd-79447c594f85 ==============================
[0m03:06:08.694438 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:06:08.694936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:06:09.881690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f7bb0>]}
[0m03:06:09.923676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a6580>]}
[0m03:06:09.924939 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:06:10.016769 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:06:10.277629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:06:10.278195 [debug] [MainThread]: Partial parsing: added file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:06:10.533668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:06:10.542908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ec550>]}
[0m03:06:10.712904 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:06:10.716069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:06:10.796906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f0230>]}
[0m03:06:10.797370 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:06:10.797641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107772430>]}
[0m03:06:10.799040 [info ] [MainThread]: 
[0m03:06:10.799306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:06:10.799509 [info ] [MainThread]: 
[0m03:06:10.799923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:06:10.800603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:06:10.866558 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:06:10.866973 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:06:10.867962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:11.629575 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.761 seconds
[0m03:06:11.631839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now create_USER_DB_MARMOT_snapshot)
[0m03:06:11.635212 [debug] [ThreadPool]: Creating schema "database: "USER_DB_MARMOT"
schema: "snapshot"
"
[0m03:06:11.639812 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_MARMOT_snapshot"
[0m03:06:11.640139 [debug] [ThreadPool]: On create_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "create_USER_DB_MARMOT_snapshot"} */
create schema if not exists USER_DB_MARMOT.snapshot
[0m03:06:11.798406 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.158 seconds
[0m03:06:11.805848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_snapshot)
[0m03:06:11.815783 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:06:11.816099 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:06:11.918286 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.102 seconds
[0m03:06:11.920977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:06:11.923965 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:06:11.924348 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:06:12.035671 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.111 seconds
[0m03:06:12.038234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086fd710>]}
[0m03:06:12.048431 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.snapshot_session_summary
[0m03:06:12.048866 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m03:06:12.049219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.snapshot_session_summary)
[0m03:06:12.049493 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.snapshot_session_summary
[0m03:06:12.055532 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.snapshot_session_summary
[0m03:06:12.119970 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.snapshot_session_summary"
[0m03:06:12.120464 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
from (
        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m03:06:12.296789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0fe-0305-0bb1-0004-59ff002b9516
[0m03:06:12.297291 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'SESSIONID'
[0m03:06:12.315217 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m03:06:12.322256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69dd22a1-c394-43f9-affd-79447c594f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b19d0>]}
[0m03:06:12.323451 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.27s]
[0m03:06:12.324066 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.snapshot_session_summary
[0m03:06:12.324528 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.snapshot_session_summary' to be skipped because of status 'error'.  Reason: Database Error in snapshot snapshot_session_summary (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'.
[0m03:06:12.326626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:12.326902 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.snapshot_session_summary' was left open.
[0m03:06:12.327129 [debug] [MainThread]: On snapshot.dbt_lab2_1.snapshot_session_summary: Close
[0m03:06:12.479572 [info ] [MainThread]: 
[0m03:06:12.480024 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m03:06:12.480698 [debug] [MainThread]: Command end result
[0m03:06:12.553905 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:06:12.556067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:06:12.566943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:06:12.567220 [info ] [MainThread]: 
[0m03:06:12.567505 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:06:12.568012 [info ] [MainThread]: 
[0m03:06:12.568342 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m03:06:12.568570 [info ] [MainThread]: 
[0m03:06:12.568791 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:06:12.576069 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 4.0144076, "process_in_blocks": "0", "process_kernel_time": 0.405278, "process_mem_max_rss": "144883712", "process_out_blocks": "0", "process_user_time": 2.004492}
[0m03:06:12.576520 [debug] [MainThread]: Command `dbt snapshot` failed at 03:06:12.576443 after 4.01 seconds
[0m03:06:12.576855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108704230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108705950>]}
[0m03:06:12.577133 [debug] [MainThread]: Flushing usage events
[0m03:06:12.976693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:08:19.028223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af7ed0>]}


============================== 03:08:19.033835 | 82e11e0a-1061-46be-bfd5-00fd232a9d0b ==============================
[0m03:08:19.033835 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:08:19.034338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:08:19.461198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82e11e0a-1061-46be-bfd5-00fd232a9d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fbbb0>]}
[0m03:08:19.502323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82e11e0a-1061-46be-bfd5-00fd232a9d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098aa580>]}
[0m03:08:19.503135 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:08:19.589222 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:08:19.716367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:08:19.716854 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:08:19.903918 [error] [MainThread]: Encountered an error:
A snapshot configured with the check strategy must specify a check_cols configuration.
[0m03:08:19.906194 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 476, in load
    self.check_valid_snapshot_config()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 1413, in check_valid_snapshot_config
    node.config.final_validate()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 51, in final_validate
    raise ValidationError(
    ...<2 lines>...
    )
dbt_common.dataclass_schema.ValidationError: A snapshot configured with the check strategy must specify a check_cols configuration.

[0m03:08:19.908621 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.9400271, "process_in_blocks": "0", "process_kernel_time": 0.275359, "process_mem_max_rss": "129138688", "process_out_blocks": "0", "process_user_time": 1.568871}
[0m03:08:19.908960 [debug] [MainThread]: Command `dbt snapshot` failed at 03:08:19.908883 after 0.94 seconds
[0m03:08:19.909234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109965450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109967250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e02210>]}
[0m03:08:19.910022 [debug] [MainThread]: Flushing usage events
[0m03:08:20.298870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:08:57.560453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106132510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdfed0>]}


============================== 03:08:57.566516 | 04cd6bfe-f0e3-4b9d-ad88-9165e31ba6d7 ==============================
[0m03:08:57.566516 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:08:57.567017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:08:57.979259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04cd6bfe-f0e3-4b9d-ad88-9165e31ba6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee3bb0>]}
[0m03:08:58.019839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04cd6bfe-f0e3-4b9d-ad88-9165e31ba6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d92580>]}
[0m03:08:58.020691 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:08:58.109402 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:08:58.238925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:08:58.239564 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:08:58.461375 [error] [MainThread]: Encountered an error:
A snapshot configured with the check strategy must specify a check_cols configuration.
[0m03:08:58.463808 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 476, in load
    self.check_valid_snapshot_config()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/parser/manifest.py", line 1413, in check_valid_snapshot_config
    node.config.final_validate()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/leali/Downloads/226/sjsu-data226-SP25/.venv/lib/python3.13/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 51, in final_validate
    raise ValidationError(
    ...<2 lines>...
    )
dbt_common.dataclass_schema.ValidationError: A snapshot configured with the check strategy must specify a check_cols configuration.

[0m03:08:58.466163 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.9766157, "process_in_blocks": "0", "process_kernel_time": 0.307607, "process_mem_max_rss": "129040384", "process_out_blocks": "0", "process_user_time": 1.665682}
[0m03:08:58.466500 [debug] [MainThread]: Command `dbt snapshot` failed at 03:08:58.466425 after 0.98 seconds
[0m03:08:58.466779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea300>]}
[0m03:08:58.467774 [debug] [MainThread]: Flushing usage events
[0m03:08:58.815473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:09:55.376760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ca510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527bed0>]}


============================== 03:09:55.381468 | da9398c4-f382-4831-a4ff-b37d7556afe4 ==============================
[0m03:09:55.381468 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:09:55.381984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:09:55.797368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da9398c4-f382-4831-a4ff-b37d7556afe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617fbb0>]}
[0m03:09:55.840262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da9398c4-f382-4831-a4ff-b37d7556afe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602a580>]}
[0m03:09:55.841152 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:09:55.941535 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:09:56.080821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:09:56.081383 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:09:56.274070 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stock_moving_avg' which was not found
[0m03:09:56.276354 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.96257657, "process_in_blocks": "0", "process_kernel_time": 0.286255, "process_mem_max_rss": "128499712", "process_out_blocks": "0", "process_user_time": 1.613938}
[0m03:09:56.276747 [debug] [MainThread]: Command `dbt snapshot` failed at 03:09:56.276662 after 0.96 seconds
[0m03:09:56.277031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ece50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ed950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106586300>]}
[0m03:09:56.277590 [debug] [MainThread]: Flushing usage events
[0m03:09:56.665873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:10:36.056954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbed0>]}


============================== 03:10:36.066503 | 289e45e4-4604-4772-9032-2d5976cd23fb ==============================
[0m03:10:36.066503 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:10:36.067404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:10:36.641028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '289e45e4-4604-4772-9032-2d5976cd23fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e33bb0>]}
[0m03:10:36.693487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '289e45e4-4604-4772-9032-2d5976cd23fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cde580>]}
[0m03:10:36.694576 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:10:36.802613 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:10:37.004878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:10:37.006553 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:10:37.639206 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stcok_data' which was not found
[0m03:10:37.643322 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.6716418, "process_in_blocks": "0", "process_kernel_time": 0.682164, "process_mem_max_rss": "122830848", "process_out_blocks": "0", "process_user_time": 2.730085}
[0m03:10:37.644009 [debug] [MainThread]: Command `dbt snapshot` failed at 03:10:37.643847 after 1.67 seconds
[0m03:10:37.644668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc2210>]}
[0m03:10:37.645227 [debug] [MainThread]: Flushing usage events
[0m03:10:38.000965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:09.281627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbbed0>]}


============================== 03:13:09.294036 | 00b8f8ff-7d0f-45dd-a524-4a8c86ca3c5c ==============================
[0m03:13:09.294036 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:13:09.294576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:13:10.758848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00b8f8ff-7d0f-45dd-a524-4a8c86ca3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbbbb0>]}
[0m03:13:10.803644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00b8f8ff-7d0f-45dd-a524-4a8c86ca3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce2580>]}
[0m03:13:10.806034 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:13:10.905479 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:13:11.235311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:13:11.235934 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:13:11.236287 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m03:13:11.610435 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stcok_data' which was not found
[0m03:13:11.613497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.470337, "process_in_blocks": "0", "process_kernel_time": 0.588232, "process_mem_max_rss": "130547712", "process_out_blocks": "0", "process_user_time": 2.300448}
[0m03:13:11.613909 [debug] [MainThread]: Command `dbt run` failed at 03:13:11.613824 after 2.47 seconds
[0m03:13:11.614241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d27550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d24e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f5cc80>]}
[0m03:13:11.614529 [debug] [MainThread]: Flushing usage events
[0m03:13:12.140754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:23:04.869936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106262510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bbed0>]}


============================== 03:23:04.877082 | c9e0a0b2-31c6-496f-b08e-efea2f0f7bd7 ==============================
[0m03:23:04.877082 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:23:04.878317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:23:05.466852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9e0a0b2-31c6-496f-b08e-efea2f0f7bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311bbbb0>]}
[0m03:23:05.512365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9e0a0b2-31c6-496f-b08e-efea2f0f7bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f6a580>]}
[0m03:23:05.513317 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:23:05.639807 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:23:05.785122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:23:05.785692 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:23:05.786018 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:23:05.786336 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m03:23:06.154415 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stcok_data' which was not found
[0m03:23:06.157660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3624282, "process_in_blocks": "0", "process_kernel_time": 0.374228, "process_mem_max_rss": "129400832", "process_out_blocks": "0", "process_user_time": 1.904885}
[0m03:23:06.158275 [debug] [MainThread]: Command `dbt run` failed at 03:23:06.157989 after 1.36 seconds
[0m03:23:06.158626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131124e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316b9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13185d310>]}
[0m03:23:06.158939 [debug] [MainThread]: Flushing usage events
[0m03:23:06.663209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:23:40.446748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e96510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bbbed0>]}


============================== 03:23:40.455805 | c7e84062-f7f3-4745-afbc-65d05f3eec95 ==============================
[0m03:23:40.455805 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:23:40.456426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:23:41.460913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7e84062-f7f3-4745-afbc-65d05f3eec95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac47bb0>]}
[0m03:23:41.539333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7e84062-f7f3-4745-afbc-65d05f3eec95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab6e580>]}
[0m03:23:41.540776 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:23:41.698780 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:23:41.921899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:23:41.923037 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m03:23:41.923461 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:23:41.923787 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:23:42.393406 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stcok_data' which was not found
[0m03:23:42.396245 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.0146666, "process_in_blocks": "0", "process_kernel_time": 0.438261, "process_mem_max_rss": "125714432", "process_out_blocks": "0", "process_user_time": 2.061598}
[0m03:23:42.396650 [debug] [MainThread]: Command `dbt snapshot` failed at 03:23:42.396564 after 2.02 seconds
[0m03:23:42.396974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abb0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11baed050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc91310>]}
[0m03:23:42.397284 [debug] [MainThread]: Flushing usage events
[0m03:23:42.746458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:00.628437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104862510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbed0>]}


============================== 03:25:00.633907 | 1e231971-de4f-4734-a3b4-8c9adcdff374 ==============================
[0m03:25:00.633907 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:25:00.634522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:25:01.149142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e231971-de4f-4734-a3b4-8c9adcdff374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c47bb0>]}
[0m03:25:01.210588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e231971-de4f-4734-a3b4-8c9adcdff374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6a580>]}
[0m03:25:01.212950 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:25:01.307610 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:25:01.445330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:25:01.445879 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m03:25:01.446187 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:25:01.446471 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:25:01.814786 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stcok_data' which was not found
[0m03:25:01.816706 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2588667, "process_in_blocks": "0", "process_kernel_time": 0.325727, "process_mem_max_rss": "129957888", "process_out_blocks": "0", "process_user_time": 1.915016}
[0m03:25:01.817116 [debug] [MainThread]: Command `dbt test` failed at 03:25:01.817025 after 1.26 seconds
[0m03:25:01.817417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aed050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5d310>]}
[0m03:25:01.817704 [debug] [MainThread]: Flushing usage events
[0m03:25:02.274153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:29.173244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138bbed0>]}


============================== 03:25:29.177738 | efb01276-bf2f-4565-9306-82fc1a1a42d1 ==============================
[0m03:25:29.177738 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:25:29.178255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m03:25:29.582071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb01276-bf2f-4565-9306-82fc1a1a42d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114abbbb0>]}
[0m03:25:29.622483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb01276-bf2f-4565-9306-82fc1a1a42d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149e2580>]}
[0m03:25:29.623310 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:25:29.707682 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:25:29.841842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:25:29.842405 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m03:25:29.842724 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:25:29.843001 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:25:30.218232 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stcok_data' which was not found
[0m03:25:30.220706 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.1082698, "process_in_blocks": "0", "process_kernel_time": 0.250013, "process_mem_max_rss": "130777088", "process_out_blocks": "0", "process_user_time": 1.760933}
[0m03:25:30.221078 [debug] [MainThread]: Command `dbt test` failed at 03:25:30.221005 after 1.11 seconds
[0m03:25:30.221377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a28e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161b9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11635d310>]}
[0m03:25:30.221653 [debug] [MainThread]: Flushing usage events
[0m03:25:30.561439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:40.808505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bbed0>]}


============================== 03:25:40.817778 | 45971703-34c9-4a38-b1e2-dcf3d75317e0 ==============================
[0m03:25:40.817778 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:25:40.818371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:25:42.817455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45971703-34c9-4a38-b1e2-dcf3d75317e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bbbb0>]}
[0m03:25:42.870306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45971703-34c9-4a38-b1e2-dcf3d75317e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e2580>]}
[0m03:25:42.873776 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:25:43.015325 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:25:43.506993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:25:43.507918 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:25:43.508310 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_data.sql
[0m03:25:43.508630 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:25:44.480905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:25:44.496672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45971703-34c9-4a38-b1e2-dcf3d75317e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095edc50>]}
[0m03:25:44.633656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:25:44.641237 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:25:44.688793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45971703-34c9-4a38-b1e2-dcf3d75317e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c7a70>]}
[0m03:25:44.689369 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:25:44.689658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45971703-34c9-4a38-b1e2-dcf3d75317e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f7cb0>]}
[0m03:25:44.691174 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:25:44.691750 [debug] [MainThread]: Command end result
[0m03:25:44.716870 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:25:44.719628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:25:44.723605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:25:44.728933 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.062923, "process_in_blocks": "0", "process_kernel_time": 0.5826, "process_mem_max_rss": "122617856", "process_out_blocks": "0", "process_user_time": 2.379443}
[0m03:25:44.729890 [debug] [MainThread]: Command `dbt test` succeeded at 03:25:44.729603 after 4.06 seconds
[0m03:25:44.730904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099efc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ced50>]}
[0m03:25:44.731499 [debug] [MainThread]: Flushing usage events
[0m03:25:45.140246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:53.250712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a16510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c7ed0>]}


============================== 03:25:53.260921 | dfff5771-4b2f-410f-a652-81a5a161009a ==============================
[0m03:25:53.260921 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:25:53.261454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:25:54.116212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bbbb0>]}
[0m03:25:54.164008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7de580>]}
[0m03:25:54.167912 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:25:54.350560 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:25:54.654728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:25:54.655309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:25:54.660773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:25:54.768562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82b650>]}
[0m03:25:54.834314 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:25:54.837533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:25:54.895050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b6d50>]}
[0m03:25:54.895454 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:25:54.895708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a877a10>]}
[0m03:25:54.896997 [info ] [MainThread]: 
[0m03:25:54.897261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:25:54.897461 [info ] [MainThread]: 
[0m03:25:54.897793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:25:54.901046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:25:54.978580 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:25:54.978949 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:25:54.979257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:56.022183 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.043 seconds
[0m03:25:56.028200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:25:56.043791 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:25:56.044336 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:25:56.141164 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.096 seconds
[0m03:25:56.144736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:25:56.151633 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:25:56.152197 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:25:56.288643 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.136 seconds
[0m03:25:56.294867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade3110>]}
[0m03:25:56.303874 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:25:56.304507 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:25:56.305067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m03:25:56.305523 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:25:56.317414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:25:56.329410 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:25:56.356218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:25:56.357207 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:25:56.357517 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:25:57.110973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m03:25:57.143776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf8c50>]}
[0m03:25:57.144413 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m03:25:57.144876 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:25:57.145581 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:25:57.146074 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:25:57.146478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:25:57.146847 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:25:57.148893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:25:57.154906 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:25:57.167545 [debug] [Thread-1 (]: Dropping relation "USER_DB_MARMOT"."DEV"."LAB2_STOCK_MOVING_AVG" because it is of type table
[0m03:25:57.172122 [debug] [Thread-1 (]: Applying DROP to: "USER_DB_MARMOT"."DEV"."LAB2_STOCK_MOVING_AVG"
[0m03:25:57.177601 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:25:57.177899 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
drop table if exists "USER_DB_MARMOT"."DEV"."LAB2_STOCK_MOVING_AVG" cascade
[0m03:25:57.350755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m03:25:57.367975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:25:57.372606 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:25:57.373012 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    select
    symbol,
    date,
    avg(close) over (partition by symbol order by date rows between 4 preceding and current row) as moving_avg
from USER_DB_MARMOT.dev.lab2_stock_data
  );
[0m03:25:57.589582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m03:25:57.594322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfff5771-4b2f-410f-a652-81a5a161009a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0c050>]}
[0m03:25:57.595596 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.45s]
[0m03:25:57.596487 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:25:57.598296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:57.598676 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:25:57.599030 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:25:57.729055 [info ] [MainThread]: 
[0m03:25:57.729529 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m03:25:57.730191 [debug] [MainThread]: Command end result
[0m03:25:57.752292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:25:57.753862 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:25:57.758431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:25:57.758688 [info ] [MainThread]: 
[0m03:25:57.758978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:25:57.759197 [info ] [MainThread]: 
[0m03:25:57.759436 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:25:57.768736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.608358, "process_in_blocks": "0", "process_kernel_time": 0.372771, "process_mem_max_rss": "138772480", "process_out_blocks": "0", "process_user_time": 1.977864}
[0m03:25:57.769143 [debug] [MainThread]: Command `dbt run` succeeded at 03:25:57.769065 after 4.61 seconds
[0m03:25:57.769556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb82c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107046fd0>]}
[0m03:25:57.769838 [debug] [MainThread]: Flushing usage events
[0m03:25:58.104659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:26:28.865789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cfed0>]}


============================== 03:26:28.876255 | f425b48b-957c-48e5-89fe-e33ffbc8c28a ==============================
[0m03:26:28.876255 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:26:28.876781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:26:30.162077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d3bb0>]}
[0m03:26:30.208203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107782580>]}
[0m03:26:30.210896 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:26:30.368357 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:26:30.607575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:26:30.607982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:26:30.612596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:26:30.702251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107843650>]}
[0m03:26:30.769570 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:26:30.772228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:26:30.787674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ced50>]}
[0m03:26:30.788067 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:26:30.788343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107890c90>]}
[0m03:26:30.789735 [info ] [MainThread]: 
[0m03:26:30.790039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:26:30.790255 [info ] [MainThread]: 
[0m03:26:30.790604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:26:30.791193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:26:30.893347 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:26:30.893734 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:26:30.893974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:31.765020 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.870 seconds
[0m03:26:31.778261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:26:31.789366 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:26:31.789750 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:26:31.922105 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.132 seconds
[0m03:26:31.924112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:26:31.926030 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:26:31.926366 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:26:32.036442 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.110 seconds
[0m03:26:32.039056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ff040>]}
[0m03:26:32.048678 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:26:32.049234 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:26:32.049700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:26:32.050044 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:26:32.063493 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:26:32.162038 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:26:32.163812 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m03:26:32.379246 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.215 seconds
[0m03:26:32.382790 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:26:32.383166 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:26:32.477258 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m03:26:32.478074 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:26:32.479728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:26:32.480051 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace transient table USER_DB_MARMOT.snapshot.lab2_stock_moving_avg_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

    ) sbq



        );
[0m03:26:33.227253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m03:26:33.254089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f425b48b-957c-48e5-89fe-e33ffbc8c28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab1490>]}
[0m03:26:33.255110 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.lab2_stock_moving_avg_snapshot .................. [[32mSUCCESS 1[0m in 1.20s]
[0m03:26:33.255644 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:26:33.256910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:33.257191 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:26:33.257433 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:26:33.389949 [info ] [MainThread]: 
[0m03:26:33.390457 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m03:26:33.391722 [debug] [MainThread]: Command end result
[0m03:26:33.423423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:26:33.431627 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:26:33.439882 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:26:33.440238 [info ] [MainThread]: 
[0m03:26:33.440583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:26:33.440806 [info ] [MainThread]: 
[0m03:26:33.441042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:26:33.446639 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.689995, "process_in_blocks": "0", "process_kernel_time": 0.476246, "process_mem_max_rss": "130318336", "process_out_blocks": "0", "process_user_time": 2.029889}
[0m03:26:33.447086 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:26:33.447002 after 4.69 seconds
[0m03:26:33.447496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b57250>]}
[0m03:26:33.447766 [debug] [MainThread]: Flushing usage events
[0m03:26:33.852867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:34:36.394976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109097c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109097ed0>]}


============================== 03:34:36.400943 | dd626d2f-968a-4a50-af99-774dba515469 ==============================
[0m03:34:36.400943 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:34:36.401467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:34:36.845835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd626d2f-968a-4a50-af99-774dba515469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9bbb0>]}
[0m03:34:36.886445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd626d2f-968a-4a50-af99-774dba515469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4a580>]}
[0m03:34:36.890016 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:34:36.973328 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:34:37.105257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:34:37.105584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:34:37.109802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:34:37.184322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd626d2f-968a-4a50-af99-774dba515469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0b650>]}
[0m03:34:37.247698 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:34:37.253262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:34:37.288142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd626d2f-968a-4a50-af99-774dba515469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4cd6d0>]}
[0m03:34:37.288512 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:34:37.288758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd626d2f-968a-4a50-af99-774dba515469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4d8d0>]}
[0m03:34:37.289898 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:34:37.291216 [debug] [MainThread]: Command end result
[0m03:34:37.308571 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:34:37.309690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:34:37.314854 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:34:37.317092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.98372364, "process_in_blocks": "0", "process_kernel_time": 0.283939, "process_mem_max_rss": "130269184", "process_out_blocks": "0", "process_user_time": 1.557129}
[0m03:34:37.317399 [debug] [MainThread]: Command `dbt test` succeeded at 03:34:37.317335 after 0.98 seconds
[0m03:34:37.317662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae57ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a481c10>]}
[0m03:34:37.317917 [debug] [MainThread]: Flushing usage events
[0m03:34:37.803553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:38:07.055398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10444a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bbed0>]}


============================== 03:38:07.060388 | 511ff323-e89d-4a1f-bd4e-6bf4a0b303b4 ==============================
[0m03:38:07.060388 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:38:07.061478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:38:07.619587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '511ff323-e89d-4a1f-bd4e-6bf4a0b303b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bbbb0>]}
[0m03:38:07.667074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '511ff323-e89d-4a1f-bd4e-6bf4a0b303b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e2580>]}
[0m03:38:07.668293 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:38:07.763507 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:38:07.946179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:38:07.946873 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:38:08.304749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:38:08.317046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '511ff323-e89d-4a1f-bd4e-6bf4a0b303b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827550>]}
[0m03:38:08.420201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:08.424302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:08.475100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '511ff323-e89d-4a1f-bd4e-6bf4a0b303b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867d40>]}
[0m03:38:08.475655 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:38:08.476023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '511ff323-e89d-4a1f-bd4e-6bf4a0b303b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106873d90>]}
[0m03:38:08.478516 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:38:08.479309 [debug] [MainThread]: Command end result
[0m03:38:08.504459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:08.506150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:08.509979 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:38:08.512710 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5401459, "process_in_blocks": "0", "process_kernel_time": 0.406708, "process_mem_max_rss": "129564672", "process_out_blocks": "0", "process_user_time": 2.03275}
[0m03:38:08.513225 [debug] [MainThread]: Command `dbt test` succeeded at 03:38:08.513125 after 1.54 seconds
[0m03:38:08.513608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b97c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790e810>]}
[0m03:38:08.513960 [debug] [MainThread]: Flushing usage events
[0m03:38:09.012157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:38:17.043695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120996510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224bbed0>]}


============================== 03:38:17.047955 | 0c019099-b87b-413d-a252-7ac4bf51966b ==============================
[0m03:38:17.047955 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:38:17.048446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:38:17.465497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126747bb0>]}
[0m03:38:17.511242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261e2580>]}
[0m03:38:17.512226 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:38:17.600446 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:38:17.729437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:38:17.729804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:38:17.734139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:38:17.815352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266b5450>]}
[0m03:38:17.878670 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:17.881068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:17.896377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126742d50>]}
[0m03:38:17.896731 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:38:17.896987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266fa270>]}
[0m03:38:17.898259 [info ] [MainThread]: 
[0m03:38:17.898519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:38:17.898738 [info ] [MainThread]: 
[0m03:38:17.899069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:38:17.902339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:38:17.948255 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:38:17.948568 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:38:17.948830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:38:18.461712 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m03:38:18.464254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:38:18.473211 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:38:18.473559 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:38:18.614712 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.141 seconds
[0m03:38:18.618840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:38:18.624194 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:38:18.624665 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:38:18.747657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m03:38:18.750005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ce7110>]}
[0m03:38:18.753361 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:38:18.753906 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:38:18.754328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now model.dbt_lab2_1.lab2_stock_data)
[0m03:38:18.754638 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:38:18.766035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:38:18.768345 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:38:18.792618 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:38:18.793792 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:38:18.794188 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:38:19.956778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m03:38:19.990149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1272f8a10>]}
[0m03:38:19.990912 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 1.23s]
[0m03:38:19.991396 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:38:19.992205 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:19.992627 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:38:19.992999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:38:19.993291 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:19.995554 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:38:19.997358 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:20.014281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:38:20.015911 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:38:20.016264 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date;
[0m03:38:20.120530 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe11e-0305-0bb1-0004-59ff002b97d6
[0m03:38:20.120985 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 21 unexpected ';'.
[0m03:38:20.127759 [debug] [Thread-1 (]: Database Error in model lab2_stock_moving_avg (models/lab2_stock_moving_avg.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_moving_avg.sql
[0m03:38:20.128259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c019099-b87b-413d-a252-7ac4bf51966b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127401b20>]}
[0m03:38:20.128799 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model dev.lab2_stock_moving_avg ................. [[31mERROR[0m in 0.14s]
[0m03:38:20.129253 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:20.129687 [debug] [Thread-4 (]: Marking all children of 'model.dbt_lab2_1.lab2_stock_moving_avg' to be skipped because of status 'error'.  Reason: Database Error in model lab2_stock_moving_avg (models/lab2_stock_moving_avg.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_moving_avg.sql.
[0m03:38:20.131098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:38:20.131345 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:38:20.131579 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:38:20.292901 [info ] [MainThread]: 
[0m03:38:20.293583 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m03:38:20.294836 [debug] [MainThread]: Command end result
[0m03:38:20.320272 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:20.322474 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:20.327425 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:38:20.327719 [info ] [MainThread]: 
[0m03:38:20.328014 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:38:20.328301 [info ] [MainThread]: 
[0m03:38:20.328657 [error] [MainThread]:   Database Error in model lab2_stock_moving_avg (models/lab2_stock_moving_avg.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2_1/models/lab2_stock_moving_avg.sql
[0m03:38:20.328916 [info ] [MainThread]: 
[0m03:38:20.329158 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m03:38:20.331707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3466434, "process_in_blocks": "0", "process_kernel_time": 0.314498, "process_mem_max_rss": "142376960", "process_out_blocks": "0", "process_user_time": 1.813562}
[0m03:38:20.332099 [debug] [MainThread]: Command `dbt run` failed at 03:38:20.332026 after 3.35 seconds
[0m03:38:20.332445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1272828f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12748a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1efd0>]}
[0m03:38:20.332721 [debug] [MainThread]: Flushing usage events
[0m03:38:20.664439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:38:30.832146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbbed0>]}


============================== 03:38:30.836431 | 9600f70b-16f7-4c83-87f1-0c2cdcac8ee0 ==============================
[0m03:38:30.836431 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:38:30.836923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:38:31.289461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9600f70b-16f7-4c83-87f1-0c2cdcac8ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1bbbb0>]}
[0m03:38:31.335433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9600f70b-16f7-4c83-87f1-0c2cdcac8ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e2580>]}
[0m03:38:31.336406 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:38:31.441247 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:38:31.599585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:38:31.600159 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://models/lab2_stock_moving_avg.sql
[0m03:38:31.841103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:38:31.851066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9600f70b-16f7-4c83-87f1-0c2cdcac8ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12b550>]}
[0m03:38:31.917244 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:31.919909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:31.948150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9600f70b-16f7-4c83-87f1-0c2cdcac8ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b16be30>]}
[0m03:38:31.948542 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:38:31.948803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9600f70b-16f7-4c83-87f1-0c2cdcac8ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1733f0>]}
[0m03:38:31.949934 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:38:31.950346 [debug] [MainThread]: Command end result
[0m03:38:31.967488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:31.968652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:31.970956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:38:31.973054 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2062343, "process_in_blocks": "0", "process_kernel_time": 0.301338, "process_mem_max_rss": "133283840", "process_out_blocks": "0", "process_user_time": 1.848061}
[0m03:38:31.973387 [debug] [MainThread]: Command `dbt test` succeeded at 03:38:31.973319 after 1.21 seconds
[0m03:38:31.973653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2cbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20a810>]}
[0m03:38:31.973923 [debug] [MainThread]: Flushing usage events
[0m03:38:32.328462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:38:36.158516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106062510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bbed0>]}


============================== 03:38:36.164565 | 6ad08668-fc56-420b-b425-66683ebe12fa ==============================
[0m03:38:36.164565 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:38:36.165132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:38:36.664105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fbbbb0>]}
[0m03:38:36.717442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee2580>]}
[0m03:38:36.719034 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:38:36.857259 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:38:37.132745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:38:37.133143 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:38:37.137845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:38:37.249114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f25450>]}
[0m03:38:37.313961 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:37.316248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:37.331566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb6d50>]}
[0m03:38:37.331954 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:38:37.332207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f7a270>]}
[0m03:38:37.333449 [info ] [MainThread]: 
[0m03:38:37.333727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:38:37.333928 [info ] [MainThread]: 
[0m03:38:37.334262 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:38:37.337505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:38:37.400211 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:38:37.400560 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:38:37.400807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:38:37.883406 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.482 seconds
[0m03:38:37.887910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:38:37.900515 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:38:37.900936 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:38:38.013029 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m03:38:38.016400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:38:38.019934 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:38:38.020444 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:38:38.179363 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.158 seconds
[0m03:38:38.184076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e7110>]}
[0m03:38:38.187592 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:38:38.188283 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:38:38.188801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m03:38:38.189184 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:38:38.201574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:38:38.202416 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:38:38.240947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:38:38.241969 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:38:38.242310 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:38:39.053520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m03:38:39.094205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f8410>]}
[0m03:38:39.095080 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.90s]
[0m03:38:39.095626 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:38:39.097032 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:39.097743 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:38:39.098286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:38:39.098903 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:39.102061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:38:39.103193 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:39.126728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:38:39.129729 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:38:39.130344 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date
  );
[0m03:38:39.462945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m03:38:39.467755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ad08668-fc56-420b-b425-66683ebe12fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112405860>]}
[0m03:38:39.469100 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.37s]
[0m03:38:39.469935 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:38:39.472442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:38:39.472935 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:38:39.473323 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:38:39.612734 [info ] [MainThread]: 
[0m03:38:39.613543 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m03:38:39.615323 [debug] [MainThread]: Command end result
[0m03:38:39.636822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:39.638818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:39.644047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:38:39.644310 [info ] [MainThread]: 
[0m03:38:39.644624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:38:39.644931 [info ] [MainThread]: 
[0m03:38:39.645233 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:38:39.647511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5486436, "process_in_blocks": "0", "process_kernel_time": 0.394545, "process_mem_max_rss": "138231808", "process_out_blocks": "0", "process_user_time": 1.970624}
[0m03:38:39.647864 [debug] [MainThread]: Command `dbt run` succeeded at 03:38:39.647801 after 3.55 seconds
[0m03:38:39.648215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123828f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11232f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113196d0>]}
[0m03:38:39.648484 [debug] [MainThread]: Flushing usage events
[0m03:38:39.990753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:38:45.749015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a47c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a47ed0>]}


============================== 03:38:45.753926 | 89ce2069-1762-4f52-9f1a-8add5b55e2f8 ==============================
[0m03:38:45.753926 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:38:45.754419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:38:46.084221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994bbb0>]}
[0m03:38:46.125709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fa580>]}
[0m03:38:46.126493 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:38:46.215154 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:38:46.341108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:38:46.341434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:38:46.345656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:38:46.433612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b5450>]}
[0m03:38:46.498193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:46.500406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:46.515468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109946d50>]}
[0m03:38:46.515826 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:38:46.516090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990b770>]}
[0m03:38:46.517325 [info ] [MainThread]: 
[0m03:38:46.517594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:38:46.517802 [info ] [MainThread]: 
[0m03:38:46.518139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:38:46.518746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:38:46.566262 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:38:46.566618 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:38:46.566856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:38:47.073172 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.506 seconds
[0m03:38:47.084164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:38:47.097337 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:38:47.097809 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:38:47.234061 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.136 seconds
[0m03:38:47.239185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:38:47.244926 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:38:47.245438 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:38:47.361053 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m03:38:47.365426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897b040>]}
[0m03:38:47.371760 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:38:47.372611 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:38:47.373344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:38:47.374025 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:38:47.388343 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:38:47.456567 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:47.457327 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:38:47.807692 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.350 seconds
[0m03:38:47.817109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:47.818072 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:38:47.929530 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.110 seconds
[0m03:38:47.936540 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:47.936922 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:38:48.029380 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m03:38:48.072938 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:48.073477 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:38:49.119066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m03:38:49.130017 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:49.131919 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:38:49.233580 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.101 seconds
[0m03:38:49.237003 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:49.237668 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:38:49.345355 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m03:38:49.348623 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:49.349452 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:38:49.522267 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.172 seconds
[0m03:38:49.583576 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:49.584082 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:38:49.716576 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.132 seconds
[0m03:38:49.735129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:49.738105 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:38:49.823692 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.085 seconds
[0m03:38:49.856700 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:49.861152 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:38:50.336185 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.473 seconds
[0m03:38:50.341467 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:50.341958 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:38:50.436347 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m03:38:50.437381 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:50.440108 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:50.440467 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:38:50.547390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m03:38:50.548078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:38:50.548488 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:38:57.609737 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe11e-0305-0bb1-0004-59ff002b97ee
[0m03:38:57.611470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:38:57.621256 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:38:57.625115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ce2069-1762-4f52-9f1a-8add5b55e2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f99d0>]}
[0m03:38:57.626929 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 10.25s]
[0m03:38:57.627893 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:38:57.628508 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:38:57.631474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:38:57.631761 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:38:57.632037 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:38:57.772503 [info ] [MainThread]: 
[0m03:38:57.772934 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.25 seconds (11.25s).
[0m03:38:57.773711 [debug] [MainThread]: Command end result
[0m03:38:57.796490 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:38:57.798875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:38:57.805156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:38:57.805446 [info ] [MainThread]: 
[0m03:38:57.805757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:38:57.805985 [info ] [MainThread]: 
[0m03:38:57.806258 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:38:57.806465 [info ] [MainThread]: 
[0m03:38:57.806675 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:38:57.809294 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 12.1222725, "process_in_blocks": "0", "process_kernel_time": 0.363931, "process_mem_max_rss": "142589952", "process_out_blocks": "0", "process_user_time": 2.005758}
[0m03:38:57.809731 [debug] [MainThread]: Command `dbt snapshot` failed at 03:38:57.809653 after 12.12 seconds
[0m03:38:57.810204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b606a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f9b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6bcaf0>]}
[0m03:38:57.810486 [debug] [MainThread]: Flushing usage events
[0m03:38:58.158221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:39:52.106053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e42510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dabbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dabbed0>]}


============================== 03:39:52.111192 | 6063456b-4f04-4422-95a0-1cf7fa38a184 ==============================
[0m03:39:52.111192 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:39:52.111928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:39:53.055518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea47bb0>]}
[0m03:39:53.098840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e96e580>]}
[0m03:39:53.099855 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:39:53.191107 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:39:53.328995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:39:53.329517 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:39:53.582839 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:39:53.592278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e9b3550>]}
[0m03:39:53.659240 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:39:53.664547 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:39:53.726394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea40230>]}
[0m03:39:53.726811 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:39:53.727070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc0f230>]}
[0m03:39:53.728338 [info ] [MainThread]: 
[0m03:39:53.728625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:39:53.728835 [info ] [MainThread]: 
[0m03:39:53.729190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:39:53.729808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:39:53.817079 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:39:53.817426 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:39:53.817665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:54.489488 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.672 seconds
[0m03:39:54.494539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:39:54.502734 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:39:54.503027 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:39:54.618229 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m03:39:54.619962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:39:54.621812 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:39:54.622089 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:39:54.768375 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.146 seconds
[0m03:39:54.770935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbdb860>]}
[0m03:39:54.773115 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:39:54.773626 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:39:54.774211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:39:54.774516 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:39:54.781609 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:39:54.830655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:39:54.831049 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:39:54.955707 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe11f-0305-0be2-0004-59ff002b789a
[0m03:39:54.956582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 22
invalid identifier 'MA_7'
[0m03:39:54.974869 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'
[0m03:39:54.978450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063456b-4f04-4422-95a0-1cf7fa38a184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150349850>]}
[0m03:39:54.980027 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.20s]
[0m03:39:54.980693 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:39:54.981777 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'.
[0m03:39:54.985194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:39:54.985508 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:39:54.985757 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:39:55.131266 [info ] [MainThread]: 
[0m03:39:55.131780 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m03:39:55.132411 [debug] [MainThread]: Command end result
[0m03:39:55.152929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:39:55.154368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:39:55.159151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:39:55.159443 [info ] [MainThread]: 
[0m03:39:55.159754 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:39:55.159984 [info ] [MainThread]: 
[0m03:39:55.160249 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'
[0m03:39:55.160454 [info ] [MainThread]: 
[0m03:39:55.160787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:39:55.163051 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 3.1236293, "process_in_blocks": "0", "process_kernel_time": 0.455143, "process_mem_max_rss": "144031744", "process_out_blocks": "0", "process_user_time": 2.160593}
[0m03:39:55.163418 [debug] [MainThread]: Command `dbt snapshot` failed at 03:39:55.163345 after 3.12 seconds
[0m03:39:55.163737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15036e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15039f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15039ddb0>]}
[0m03:39:55.164017 [debug] [MainThread]: Flushing usage events
[0m03:39:55.674473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:40:58.684293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f13c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f13ed0>]}


============================== 03:40:58.689058 | f06180b1-8c8c-439e-93f2-aed3f6ec479b ==============================
[0m03:40:58.689058 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:40:58.689547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:40:59.183694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f06180b1-8c8c-439e-93f2-aed3f6ec479b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133bb0>]}
[0m03:40:59.262392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f06180b1-8c8c-439e-93f2-aed3f6ec479b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe2580>]}
[0m03:40:59.263802 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:40:59.419712 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:40:59.616432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:40:59.617254 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:40:59.863338 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m03:40:59.865771 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.2555282, "process_in_blocks": "0", "process_kernel_time": 0.346823, "process_mem_max_rss": "124387328", "process_out_blocks": "0", "process_user_time": 1.749844}
[0m03:40:59.866162 [debug] [MainThread]: Command `dbt snapshot` failed at 03:40:59.866081 after 1.26 seconds
[0m03:40:59.866469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d97890>]}
[0m03:40:59.866775 [debug] [MainThread]: Flushing usage events
[0m03:41:00.242123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:41:23.768803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbed0>]}


============================== 03:41:23.772968 | 2e78a0ed-6cf3-44a9-9ee8-76492f0851cc ==============================
[0m03:41:23.772968 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:41:23.773479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:41:24.156453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbbbb0>]}
[0m03:41:24.198262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae2580>]}
[0m03:41:24.199846 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:41:24.287077 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:41:24.417504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:41:24.418024 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:41:24.653618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:41:24.662817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2b550>]}
[0m03:41:24.808804 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:41:24.812095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:41:24.827958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb4230>]}
[0m03:41:24.828341 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:41:24.828594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0b230>]}
[0m03:41:24.829798 [info ] [MainThread]: 
[0m03:41:24.830073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:24.830279 [info ] [MainThread]: 
[0m03:41:24.830639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:41:24.831231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:41:24.877999 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:41:24.878326 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:41:24.878557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:25.450018 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.571 seconds
[0m03:41:25.460773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:41:25.473635 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:41:25.474061 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:41:25.581627 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m03:41:25.585994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:41:25.590327 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:41:25.590726 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:41:25.746128 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.155 seconds
[0m03:41:25.750578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adb860>]}
[0m03:41:25.754029 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:41:25.754743 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:41:25.755269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:41:25.755689 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:41:25.764021 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:41:25.816505 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:25.817049 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:41:25.944755 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.127 seconds
[0m03:41:25.951897 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:25.952765 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:41:26.053138 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m03:41:26.061280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:26.061633 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:41:26.178286 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.116 seconds
[0m03:41:26.218983 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:26.219465 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((
  TRUE
))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (
  TRUE
)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:41:27.275522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.055 seconds
[0m03:41:27.280774 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:27.281439 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:41:27.378255 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m03:41:27.382998 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:27.383438 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:41:27.472198 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.088 seconds
[0m03:41:27.478765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:27.479383 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:41:27.566155 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.086 seconds
[0m03:41:27.570060 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:27.570466 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:41:27.675685 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.104 seconds
[0m03:41:27.685931 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:27.686606 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
alter table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" add column "MA_7" FLOAT;
[0m03:41:27.873531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m03:41:27.876549 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:27.877187 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
alter table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" add column "MA_30" FLOAT;
[0m03:41:28.031517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m03:41:28.035051 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:28.035395 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:41:28.121535 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.086 seconds
[0m03:41:28.141900 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:28.142369 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((
  TRUE
))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (
  TRUE
)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:41:28.316046 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.173 seconds
[0m03:41:28.322386 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:28.323007 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:41:28.411287 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.087 seconds
[0m03:41:28.412468 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:28.415416 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:28.415907 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:41:28.522354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m03:41:28.523551 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:41:28.524237 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:41:36.319579 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe121-0305-0be2-0004-59ff002b78aa
[0m03:41:36.321029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:41:36.329844 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:41:36.333616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e78a0ed-6cf3-44a9-9ee8-76492f0851cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b4a990>]}
[0m03:41:36.335284 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 10.58s]
[0m03:41:36.335814 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:41:36.336530 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:41:36.339474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:36.339711 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:41:36.339962 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:41:36.478251 [info ] [MainThread]: 
[0m03:41:36.478770 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m03:41:36.479711 [debug] [MainThread]: Command end result
[0m03:41:36.557435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:41:36.563695 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:41:36.572638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:41:36.572922 [info ] [MainThread]: 
[0m03:41:36.573265 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:41:36.573507 [info ] [MainThread]: 
[0m03:41:36.573782 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:41:36.573992 [info ] [MainThread]: 
[0m03:41:36.574212 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:41:36.583278 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 12.87165, "process_in_blocks": "0", "process_kernel_time": 0.368974, "process_mem_max_rss": "144867328", "process_out_blocks": "0", "process_user_time": 2.19555}
[0m03:41:36.583809 [debug] [MainThread]: Command `dbt snapshot` failed at 03:41:36.583691 after 12.87 seconds
[0m03:41:36.584343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b6e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cfcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cfdef0>]}
[0m03:41:36.584666 [debug] [MainThread]: Flushing usage events
[0m03:41:36.983328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:42:18.257681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbbed0>]}


============================== 03:42:18.278737 | 255ded10-0fb4-4aaa-89d3-bfb99635dbaa ==============================
[0m03:42:18.278737 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:42:18.279762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:42:18.912008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbbbb0>]}
[0m03:42:18.979971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee2580>]}
[0m03:42:18.981668 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:42:19.119229 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:42:19.298630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:42:19.299292 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:42:19.615933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:42:19.626480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af2b550>]}
[0m03:42:19.709540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:42:19.712983 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:42:19.733506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb4230>]}
[0m03:42:19.734045 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:42:19.734468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfcb230>]}
[0m03:42:19.736389 [info ] [MainThread]: 
[0m03:42:19.736950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:42:19.737379 [info ] [MainThread]: 
[0m03:42:19.737861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:42:19.738589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:42:19.790777 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:42:19.791145 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:42:19.791401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:20.331482 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.540 seconds
[0m03:42:20.341844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:42:20.353205 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:42:20.353556 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:42:20.474663 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m03:42:20.476532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:42:20.478903 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:42:20.479248 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:42:20.608174 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.129 seconds
[0m03:42:20.613308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf9f860>]}
[0m03:42:20.617762 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:42:20.618342 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:42:20.618753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:42:20.619091 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:42:20.629006 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:42:20.715891 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:20.716394 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:42:20.922289 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.205 seconds
[0m03:42:20.931894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:20.932868 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:42:21.040384 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.106 seconds
[0m03:42:21.054885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:21.055878 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:42:21.147078 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.090 seconds
[0m03:42:21.199245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:21.199784 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:42:22.468719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m03:42:22.476293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:22.476679 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:42:22.571751 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.095 seconds
[0m03:42:22.575269 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:22.575604 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:42:22.662320 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.086 seconds
[0m03:42:22.665362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:22.665742 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:42:22.783077 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m03:42:22.786039 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:22.786393 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:42:22.904916 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.118 seconds
[0m03:42:22.914133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:22.914578 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:42:23.026966 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m03:42:23.053254 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:23.053877 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:42:23.230091 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.176 seconds
[0m03:42:23.237049 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:23.237689 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:42:23.347114 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m03:42:23.348715 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:23.351190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:23.351616 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:42:23.547395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m03:42:23.548503 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:42:23.549100 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:42:31.020014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe122-0305-0be2-0004-59ff002b78ba
[0m03:42:31.023332 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:42:31.041995 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:42:31.047895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '255ded10-0fb4-4aaa-89d3-bfb99635dbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54a690>]}
[0m03:42:31.049649 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 10.42s]
[0m03:42:31.050256 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:42:31.050968 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:42:31.054616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:31.054969 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:42:31.055302 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:42:31.197699 [info ] [MainThread]: 
[0m03:42:31.198209 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.46 seconds (11.46s).
[0m03:42:31.199039 [debug] [MainThread]: Command end result
[0m03:42:31.227989 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:42:31.230696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:42:31.236799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:42:31.237132 [info ] [MainThread]: 
[0m03:42:31.237478 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:42:31.237737 [info ] [MainThread]: 
[0m03:42:31.238015 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:42:31.238223 [info ] [MainThread]: 
[0m03:42:31.238509 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:42:31.240877 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 13.118664, "process_in_blocks": "0", "process_kernel_time": 0.5654, "process_mem_max_rss": "141049856", "process_out_blocks": "0", "process_user_time": 2.527991}
[0m03:42:31.241482 [debug] [MainThread]: Command `dbt snapshot` failed at 03:42:31.241417 after 13.12 seconds
[0m03:42:31.241928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c56e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c8550>]}
[0m03:42:31.242383 [debug] [MainThread]: Flushing usage events
[0m03:42:31.585563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:43:39.117586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118246510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7bbed0>]}


============================== 03:43:39.121963 | 1d257721-4230-48f3-9234-bd3f993486fb ==============================
[0m03:43:39.121963 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:43:39.122446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:43:39.526237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8bbbb0>]}
[0m03:43:39.566854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7e2580>]}
[0m03:43:39.567802 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:43:39.654845 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:43:39.782624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:43:39.783168 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:43:40.114642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:43:40.124122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b827550>]}
[0m03:43:40.194614 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:43:40.197065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:43:40.214878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8b4230>]}
[0m03:43:40.215417 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:43:40.215866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0d7230>]}
[0m03:43:40.217344 [info ] [MainThread]: 
[0m03:43:40.217632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:43:40.217841 [info ] [MainThread]: 
[0m03:43:40.218233 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:43:40.218847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:43:40.268887 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:43:40.269337 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:43:40.269625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:40.770355 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.500 seconds
[0m03:43:40.779449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:43:40.793417 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:43:40.793970 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:43:40.957398 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.163 seconds
[0m03:43:40.973761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:43:41.024086 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:43:41.028190 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:43:41.208638 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.179 seconds
[0m03:43:41.211148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4ebee0>]}
[0m03:43:41.218284 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:43:41.218940 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:43:41.220464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:43:41.220852 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:43:41.241905 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:43:41.349038 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:43:41.349489 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:43:41.509398 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe123-0305-0c98-0004-59ff002b884a
[0m03:43:41.509873 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 22
invalid identifier 'MA_7'
[0m03:43:41.521487 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'
[0m03:43:41.524415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d257721-4230-48f3-9234-bd3f993486fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d649850>]}
[0m03:43:41.525154 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.30s]
[0m03:43:41.525626 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:43:41.526190 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'.
[0m03:43:41.528065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:41.528302 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:43:41.528519 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:43:41.665558 [info ] [MainThread]: 
[0m03:43:41.666018 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m03:43:41.666647 [debug] [MainThread]: Command end result
[0m03:43:41.698776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:43:41.704943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:43:41.717284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:43:41.718029 [info ] [MainThread]: 
[0m03:43:41.718920 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:43:41.719470 [info ] [MainThread]: 
[0m03:43:41.720263 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'
[0m03:43:41.720741 [info ] [MainThread]: 
[0m03:43:41.721198 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:43:41.725123 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.6682642, "process_in_blocks": "0", "process_kernel_time": 0.343538, "process_mem_max_rss": "144113664", "process_out_blocks": "0", "process_user_time": 1.981801}
[0m03:43:41.726187 [debug] [MainThread]: Command `dbt snapshot` failed at 03:43:41.725833 after 2.67 seconds
[0m03:43:41.727471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d66ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d69f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d69def0>]}
[0m03:43:41.728172 [debug] [MainThread]: Flushing usage events
[0m03:43:42.123695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:44:03.415265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2bed0>]}


============================== 03:44:03.419621 | 4eb99663-9eb5-48b6-be8b-c94a053b12ef ==============================
[0m03:44:03.419621 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:44:03.420100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:44:03.965095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2fbb0>]}
[0m03:44:04.010019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059de580>]}
[0m03:44:04.011001 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:44:04.133725 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:44:04.268345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:44:04.268936 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:44:04.545586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:44:04.555878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9b550>]}
[0m03:44:04.641872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:04.649016 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:04.668309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28230>]}
[0m03:44:04.668918 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:44:04.669260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603b230>]}
[0m03:44:04.670986 [info ] [MainThread]: 
[0m03:44:04.671346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:04.671672 [info ] [MainThread]: 
[0m03:44:04.672131 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:44:04.672913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:44:04.728808 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:44:04.729176 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:44:04.729431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:05.259832 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.530 seconds
[0m03:44:05.279734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:44:05.291604 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:44:05.292041 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:44:05.458083 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.166 seconds
[0m03:44:05.462409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:44:05.467085 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:44:05.467553 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:44:05.587736 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m03:44:05.591323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645fee0>]}
[0m03:44:05.594712 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:05.595475 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:44:05.596075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:44:05.596540 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:05.605333 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:05.682255 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:05.682730 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date;
[0m03:44:05.797836 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe124-0305-0c96-0004-59ff002ba7e6
[0m03:44:05.798295 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 21 unexpected ';'.
[0m03:44:05.807163 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 21 unexpected ';'.
[0m03:44:05.808919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb99663-9eb5-48b6-be8b-c94a053b12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115949850>]}
[0m03:44:05.809671 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.21s]
[0m03:44:05.810185 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:05.810889 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 21 unexpected ';'..
[0m03:44:05.812634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:05.812870 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:44:05.813099 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:44:06.002015 [info ] [MainThread]: 
[0m03:44:06.002823 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m03:44:06.004069 [debug] [MainThread]: Command end result
[0m03:44:06.053089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:06.055546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:06.061603 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:44:06.061904 [info ] [MainThread]: 
[0m03:44:06.062519 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:44:06.063185 [info ] [MainThread]: 
[0m03:44:06.063593 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 21 unexpected ';'.
[0m03:44:06.067341 [info ] [MainThread]: 
[0m03:44:06.067908 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:44:06.070707 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.7142084, "process_in_blocks": "0", "process_kernel_time": 0.36713, "process_mem_max_rss": "137199616", "process_out_blocks": "0", "process_user_time": 2.099982}
[0m03:44:06.071111 [debug] [MainThread]: Command `dbt snapshot` failed at 03:44:06.071035 after 2.71 seconds
[0m03:44:06.071518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11596e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11599f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11599dd10>]}
[0m03:44:06.071813 [debug] [MainThread]: Flushing usage events
[0m03:44:06.406652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:44:14.978249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107802510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b3ed0>]}


============================== 03:44:14.982466 | ffcf0520-11d6-4913-84b0-8369c1b03759 ==============================
[0m03:44:14.982466 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:44:14.982944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:44:15.388108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b7bb0>]}
[0m03:44:15.428945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109466580>]}
[0m03:44:15.429763 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:44:15.518934 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:44:15.648975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:44:15.649549 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:44:15.885558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:44:15.894918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523550>]}
[0m03:44:15.964737 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:15.968357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:16.009722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b0230>]}
[0m03:44:16.010147 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:44:16.010475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad3230>]}
[0m03:44:16.011891 [info ] [MainThread]: 
[0m03:44:16.012356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:16.012597 [info ] [MainThread]: 
[0m03:44:16.013004 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:44:16.013648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:44:16.059573 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:44:16.059909 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:44:16.060139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:16.603426 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.543 seconds
[0m03:44:16.612821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:44:16.624916 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:44:16.625400 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:44:16.740078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m03:44:16.743822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:44:16.746064 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:44:16.746374 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:44:16.871136 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.124 seconds
[0m03:44:16.876832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa3860>]}
[0m03:44:16.880217 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:16.881021 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:44:16.881607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:44:16.882057 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:16.891406 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:16.945359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:16.945864 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:44:17.065649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.119 seconds
[0m03:44:17.075571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:17.076600 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:44:17.165318 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m03:44:17.175978 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:17.176529 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:44:17.295442 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.118 seconds
[0m03:44:17.352691 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:17.353286 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:44:18.167644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.813 seconds
[0m03:44:18.172081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.172659 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:44:18.269656 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m03:44:18.276135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.276887 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:44:18.366813 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.089 seconds
[0m03:44:18.372727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.373161 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:44:18.496511 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.123 seconds
[0m03:44:18.528616 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.529385 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:44:18.615264 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m03:44:18.621884 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.622274 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:44:18.723359 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.101 seconds
[0m03:44:18.741996 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.742527 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:44:18.889895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.147 seconds
[0m03:44:18.895852 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.896316 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:44:18.980519 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m03:44:18.981605 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.983605 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:18.983983 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:44:19.119954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m03:44:19.121331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:44:19.122167 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:44:26.819331 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe124-0305-0bb1-0004-59ff002b981e
[0m03:44:26.821416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:44:26.840441 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:44:26.843563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffcf0520-11d6-4913-84b0-8369c1b03759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a876150>]}
[0m03:44:26.844792 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 9.96s]
[0m03:44:26.845348 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:26.845966 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:44:26.848415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:26.848660 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:44:26.848904 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:44:26.989485 [info ] [MainThread]: 
[0m03:44:26.990031 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.98 seconds (10.98s).
[0m03:44:26.990763 [debug] [MainThread]: Command end result
[0m03:44:27.013954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:27.016244 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:27.021633 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:44:27.021929 [info ] [MainThread]: 
[0m03:44:27.022237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:44:27.022494 [info ] [MainThread]: 
[0m03:44:27.022772 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:44:27.022984 [info ] [MainThread]: 
[0m03:44:27.023196 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:44:27.025577 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 12.106323, "process_in_blocks": "0", "process_kernel_time": 0.346059, "process_mem_max_rss": "144834560", "process_out_blocks": "0", "process_user_time": 2.161113}
[0m03:44:27.025964 [debug] [MainThread]: Command `dbt snapshot` failed at 03:44:27.025893 after 12.11 seconds
[0m03:44:27.026355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96f250>]}
[0m03:44:27.026628 [debug] [MainThread]: Flushing usage events
[0m03:44:27.365335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:44:49.689340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cbed0>]}


============================== 03:44:49.693438 | 386f532c-0d95-4c8a-b82a-6d11d89705bb ==============================
[0m03:44:49.693438 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:44:49.693915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:44:50.113151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212bbbb0>]}
[0m03:44:50.156195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210e2580>]}
[0m03:44:50.157096 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:44:50.244586 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:44:50.378554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:44:50.379072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:44:50.383605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:44:50.465402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121227750>]}
[0m03:44:50.529463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:50.532701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:50.547607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212b6d50>]}
[0m03:44:50.547988 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:44:50.548246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12127a270>]}
[0m03:44:50.549495 [info ] [MainThread]: 
[0m03:44:50.549772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:50.549976 [info ] [MainThread]: 
[0m03:44:50.550318 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:44:50.553572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:44:50.624349 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:44:50.624678 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:44:50.624920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:51.156795 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.532 seconds
[0m03:44:51.160945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:44:51.174460 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:44:51.175016 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:44:51.293135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m03:44:51.296817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:44:51.300704 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:44:51.301181 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:44:51.415224 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.113 seconds
[0m03:44:51.421015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229e7110>]}
[0m03:44:51.425836 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:44:51.426813 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:44:51.427546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m03:44:51.427969 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:44:51.441890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:44:51.443817 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:44:51.469699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:44:51.470651 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:44:51.470994 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:44:52.120702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m03:44:52.152921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ff8410>]}
[0m03:44:52.153658 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m03:44:52.154132 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:44:52.154818 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:44:52.155258 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:44:52.155602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:44:52.155855 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:44:52.157844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:44:52.158950 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:44:52.175514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:44:52.176455 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:44:52.176753 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date
  );
[0m03:44:52.522626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m03:44:52.527494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '386f532c-0d95-4c8a-b82a-6d11d89705bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127005860>]}
[0m03:44:52.528525 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.37s]
[0m03:44:52.529431 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:44:52.531215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:52.531687 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:44:52.532092 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:44:52.688328 [info ] [MainThread]: 
[0m03:44:52.689209 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m03:44:52.690589 [debug] [MainThread]: Command end result
[0m03:44:52.719342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:52.720853 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:52.726300 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:44:52.726614 [info ] [MainThread]: 
[0m03:44:52.727140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:44:52.727445 [info ] [MainThread]: 
[0m03:44:52.727796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:44:52.729948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1007822, "process_in_blocks": "0", "process_kernel_time": 0.33589, "process_mem_max_rss": "140869632", "process_out_blocks": "0", "process_user_time": 1.874414}
[0m03:44:52.730256 [debug] [MainThread]: Command `dbt run` succeeded at 03:44:52.730187 after 3.10 seconds
[0m03:44:52.730525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f868f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f2f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e65550>]}
[0m03:44:52.730796 [debug] [MainThread]: Flushing usage events
[0m03:44:53.067401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:44:58.127527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2fed0>]}


============================== 03:44:58.131848 | e847efa8-d806-4436-bd15-9649f778e2f3 ==============================
[0m03:44:58.131848 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:44:58.132343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:44:58.523482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d933bb0>]}
[0m03:44:58.566333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e2580>]}
[0m03:44:58.568637 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:44:58.655016 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:44:58.820406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:44:58.820772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:44:58.825188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:44:58.905223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a3750>]}
[0m03:44:58.971562 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:44:58.975258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:44:59.012075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92ed50>]}
[0m03:44:59.012548 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:44:59.012894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f3770>]}
[0m03:44:59.014215 [info ] [MainThread]: 
[0m03:44:59.014494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:44:59.014700 [info ] [MainThread]: 
[0m03:44:59.015063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:44:59.015719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:44:59.076314 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:44:59.076689 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:44:59.077115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:59.589374 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.512 seconds
[0m03:44:59.601107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:44:59.614387 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:44:59.614819 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:44:59.766032 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.151 seconds
[0m03:44:59.769993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:44:59.774390 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:44:59.774894 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:44:59.957201 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.182 seconds
[0m03:44:59.961860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e63040>]}
[0m03:44:59.966818 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:44:59.967631 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:44:59.968336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:44:59.969003 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:45:00.074054 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:45:00.194243 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:00.194918 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:00.393895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.198 seconds
[0m03:45:00.406339 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:00.407330 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:45:00.521181 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.113 seconds
[0m03:45:00.532476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:00.533079 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:45:00.617137 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.083 seconds
[0m03:45:00.671668 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:00.672255 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:45:01.603710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m03:45:01.613404 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:01.613956 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:45:01.722670 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m03:45:01.729613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:01.730135 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:45:01.819968 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.089 seconds
[0m03:45:01.825157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:01.825738 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:45:01.923508 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m03:45:01.926832 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:01.927315 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:45:02.010550 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.083 seconds
[0m03:45:02.020684 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:02.021382 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:45:02.113246 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m03:45:02.139540 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:02.140267 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:02.414707 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.274 seconds
[0m03:45:02.418277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:02.418638 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:45:02.514757 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.096 seconds
[0m03:45:02.515540 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:02.517138 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:02.517452 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:45:02.655706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m03:45:02.656514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:45:02.657042 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:45:10.395898 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe125-0305-0c96-0004-59ff002ba80a
[0m03:45:10.397660 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:45:10.408031 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:45:10.411977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e847efa8-d806-4436-bd15-9649f778e2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4659d0>]}
[0m03:45:10.413718 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 10.44s]
[0m03:45:10.414327 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:45:10.414935 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:45:10.419196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:10.419619 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:45:10.419885 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:45:10.556326 [info ] [MainThread]: 
[0m03:45:10.556776 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.54 seconds (11.54s).
[0m03:45:10.557420 [debug] [MainThread]: Command end result
[0m03:45:10.578540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:45:10.585218 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:45:10.590488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:45:10.590760 [info ] [MainThread]: 
[0m03:45:10.591055 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:45:10.591294 [info ] [MainThread]: 
[0m03:45:10.591560 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:45:10.591758 [info ] [MainThread]: 
[0m03:45:10.591970 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:45:10.594115 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 12.555439, "process_in_blocks": "0", "process_kernel_time": 0.378608, "process_mem_max_rss": "141475840", "process_out_blocks": "0", "process_user_time": 2.046042}
[0m03:45:10.594577 [debug] [MainThread]: Command `dbt snapshot` failed at 03:45:10.594501 after 12.56 seconds
[0m03:45:10.594989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e602a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6465d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e646ad0>]}
[0m03:45:10.595356 [debug] [MainThread]: Flushing usage events
[0m03:45:11.088111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:46:52.362820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bbed0>]}


============================== 03:46:52.368124 | dec72659-46a2-4dc6-874e-2297582c5428 ==============================
[0m03:46:52.368124 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:46:52.368673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:46:52.806174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bbbb0>]}
[0m03:46:52.848718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e2580>]}
[0m03:46:52.849613 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:46:52.939248 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:46:53.078049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:46:53.078638 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:46:53.328332 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:46:53.337670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772b550>]}
[0m03:46:53.406554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:46:53.408892 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:46:53.424130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b4230>]}
[0m03:46:53.424526 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:46:53.424775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec7230>]}
[0m03:46:53.426015 [info ] [MainThread]: 
[0m03:46:53.426277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:46:53.426475 [info ] [MainThread]: 
[0m03:46:53.426806 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:46:53.427402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:46:53.477781 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:46:53.478149 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:46:53.478413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:53.985001 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.506 seconds
[0m03:46:53.991824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:46:54.000679 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:46:54.001003 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:46:54.167353 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.166 seconds
[0m03:46:54.172501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:46:54.177362 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:46:54.177814 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:46:54.298378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m03:46:54.302049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c07ee0>]}
[0m03:46:54.305855 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:46:54.306711 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:46:54.307341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:46:54.307800 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:46:54.318960 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:46:54.373790 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:46:54.374213 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:46:54.467216 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m03:46:54.474928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:46:54.475854 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:46:54.558938 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m03:46:54.567395 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:46:54.567854 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:46:54.661397 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.093 seconds
[0m03:46:54.707382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:46:54.707965 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        symbol, date as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol, date as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol, date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol, date as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:46:54.812376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe126-0305-0bb1-0004-59ff002b9836
[0m03:46:54.812800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 52 at position 36 unexpected ','.
syntax error line 52 at position 43 unexpected 'as'.
syntax error line 52 at position 57 unexpected ''''.
syntax error line 53 at position 93 unexpected ')'.
[0m03:46:54.819721 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 36 unexpected ','.
  syntax error line 52 at position 43 unexpected 'as'.
  syntax error line 52 at position 57 unexpected ''''.
  syntax error line 53 at position 93 unexpected ')'.
[0m03:46:54.821416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec72659-46a2-4dc6-874e-2297582c5428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e4a150>]}
[0m03:46:54.822097 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.51s]
[0m03:46:54.822611 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:46:54.823035 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 36 unexpected ','.
  syntax error line 52 at position 43 unexpected 'as'.
  syntax error line 52 at position 57 unexpected ''''.
  syntax error line 53 at position 93 unexpected ')'..
[0m03:46:54.824326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:54.824589 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:46:54.824796 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:46:54.977171 [info ] [MainThread]: 
[0m03:46:54.977948 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m03:46:54.979155 [debug] [MainThread]: Command end result
[0m03:46:55.012887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:46:55.014374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:46:55.019369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:46:55.019652 [info ] [MainThread]: 
[0m03:46:55.019942 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:46:55.020174 [info ] [MainThread]: 
[0m03:46:55.020443 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 36 unexpected ','.
  syntax error line 52 at position 43 unexpected 'as'.
  syntax error line 52 at position 57 unexpected ''''.
  syntax error line 53 at position 93 unexpected ')'.
[0m03:46:55.020660 [info ] [MainThread]: 
[0m03:46:55.020874 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:46:55.022926 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.7229161, "process_in_blocks": "0", "process_kernel_time": 0.396133, "process_mem_max_rss": "145539072", "process_out_blocks": "0", "process_user_time": 2.150066}
[0m03:46:55.023230 [debug] [MainThread]: Command `dbt snapshot` failed at 03:46:55.023166 after 2.72 seconds
[0m03:46:55.023493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e6ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d47d0>]}
[0m03:46:55.023757 [debug] [MainThread]: Flushing usage events
[0m03:46:55.507654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:19.302966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebbed0>]}


============================== 03:48:19.314941 | c3f3cf16-68e1-40a8-b04f-66af728ccfc8 ==============================
[0m03:48:19.314941 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:48:19.319479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:48:19.853386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bbbb0>]}
[0m03:48:19.899025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6e580>]}
[0m03:48:19.900336 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:48:19.995754 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:48:20.145497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:48:20.146247 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:48:20.420487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:48:20.436186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602b550>]}
[0m03:48:20.539813 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:48:20.543071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:48:20.560670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b4230>]}
[0m03:48:20.561137 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:48:20.561432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffb230>]}
[0m03:48:20.563010 [info ] [MainThread]: 
[0m03:48:20.563342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:20.563654 [info ] [MainThread]: 
[0m03:48:20.564208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:48:20.564903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:48:20.657723 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:48:20.658182 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:48:20.658487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:21.230492 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.572 seconds
[0m03:48:21.240309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:48:21.253130 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:48:21.253600 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:48:21.387380 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.133 seconds
[0m03:48:21.390780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:48:21.395135 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:48:21.395543 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:48:21.531260 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m03:48:21.534529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741fee0>]}
[0m03:48:21.538015 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:48:21.538691 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:48:21.539198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:48:21.539719 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:48:21.550092 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:48:21.618968 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:48:21.619403 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:48:21.774129 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.154 seconds
[0m03:48:21.783412 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:48:21.784409 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:48:21.880228 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.095 seconds
[0m03:48:21.890636 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:48:21.891036 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:48:22.008201 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.117 seconds
[0m03:48:22.059825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:48:22.060422 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol, date as dbt_unique_key_1
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol, date as dbt_unique_key_1
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol, date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol, date as dbt_unique_key_1
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:48:22.161901 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe128-0305-0bd9-0004-59ff002bb646
[0m03:48:22.162396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 56 at position 36 unexpected ','.
syntax error line 56 at position 43 unexpected 'as'.
syntax error line 56 at position 57 unexpected ''''.
syntax error line 57 at position 93 unexpected ')'.
[0m03:48:22.169524 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 56 at position 36 unexpected ','.
  syntax error line 56 at position 43 unexpected 'as'.
  syntax error line 56 at position 57 unexpected ''''.
  syntax error line 57 at position 93 unexpected ')'.
[0m03:48:22.171229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f3cf16-68e1-40a8-b04f-66af728ccfc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747db50>]}
[0m03:48:22.171990 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.63s]
[0m03:48:22.172556 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:48:22.173110 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 56 at position 36 unexpected ','.
  syntax error line 56 at position 43 unexpected 'as'.
  syntax error line 56 at position 57 unexpected ''''.
  syntax error line 57 at position 93 unexpected ')'..
[0m03:48:22.174807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:22.175056 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:48:22.175277 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:48:22.323833 [info ] [MainThread]: 
[0m03:48:22.324356 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m03:48:22.325019 [debug] [MainThread]: Command end result
[0m03:48:22.352485 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:48:22.354565 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:48:22.360187 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:48:22.360853 [info ] [MainThread]: 
[0m03:48:22.361526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:48:22.362063 [info ] [MainThread]: 
[0m03:48:22.362638 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 56 at position 36 unexpected ','.
  syntax error line 56 at position 43 unexpected 'as'.
  syntax error line 56 at position 57 unexpected ''''.
  syntax error line 57 at position 93 unexpected ')'.
[0m03:48:22.363128 [info ] [MainThread]: 
[0m03:48:22.363651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:48:22.366204 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 3.1437972, "process_in_blocks": "0", "process_kernel_time": 0.493729, "process_mem_max_rss": "128860160", "process_out_blocks": "0", "process_user_time": 2.440087}
[0m03:48:22.366645 [debug] [MainThread]: Command `dbt snapshot` failed at 03:48:22.366558 after 3.14 seconds
[0m03:48:22.367236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706a170>]}
[0m03:48:22.367801 [debug] [MainThread]: Flushing usage events
[0m03:48:22.850897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:49:06.811363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107966510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fbed0>]}


============================== 03:49:06.816550 | 96af14f2-7a92-4afc-a96c-6e72a9ebd217 ==============================
[0m03:49:06.816550 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:49:06.817045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:49:07.217718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ffbb0>]}
[0m03:49:07.259006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095aa580>]}
[0m03:49:07.259877 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:49:07.344086 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:49:07.475581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:49:07.476100 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:49:07.717664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:49:07.727163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966f550>]}
[0m03:49:07.794894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:49:07.797370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:49:07.813230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f8230>]}
[0m03:49:07.813588 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:49:07.813838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1b230>]}
[0m03:49:07.815222 [info ] [MainThread]: 
[0m03:49:07.815471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:49:07.815666 [info ] [MainThread]: 
[0m03:49:07.816002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:49:07.816580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:49:07.862327 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:49:07.862664 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:49:07.862895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:08.335660 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.472 seconds
[0m03:49:08.344624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:49:08.356411 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:49:08.356819 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:49:08.502686 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.145 seconds
[0m03:49:08.506952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:49:08.511736 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:49:08.512215 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:49:08.621880 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m03:49:08.623644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95fee0>]}
[0m03:49:08.625775 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:49:08.626200 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:49:08.626880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:49:08.627382 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:49:08.634425 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:49:08.684436 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:08.684842 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:49:08.785484 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m03:49:08.792007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:08.792891 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:49:08.882176 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m03:49:08.888934 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:08.889291 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:49:08.969752 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.080 seconds
[0m03:49:09.022145 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:09.022699 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:49:09.854474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.831 seconds
[0m03:49:09.859258 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:09.859793 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:49:09.956426 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m03:49:09.963429 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:09.964050 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:49:10.054941 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.090 seconds
[0m03:49:10.063229 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.063991 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:49:10.209172 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.145 seconds
[0m03:49:10.214795 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.215447 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:49:10.326900 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m03:49:10.335435 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.335831 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:49:10.437887 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.101 seconds
[0m03:49:10.469403 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.470023 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:49:10.719551 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.248 seconds
[0m03:49:10.727210 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.727968 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:49:10.847692 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.119 seconds
[0m03:49:10.849467 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.853190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.853796 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:49:10.965388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m03:49:10.966046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:49:10.966497 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MA_7", "MA_30", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:49:11.405565 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe129-0305-0bd9-0004-59ff002bb656
[0m03:49:11.406493 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:49:11.415847 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:49:11.418279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96af14f2-7a92-4afc-a96c-6e72a9ebd217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9be750>]}
[0m03:49:11.419292 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 2.79s]
[0m03:49:11.419871 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:49:11.420407 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:49:11.422206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:11.422523 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:49:11.422791 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:49:11.849351 [info ] [MainThread]: 
[0m03:49:11.850572 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m03:49:11.852108 [debug] [MainThread]: Command end result
[0m03:49:11.882526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:49:11.884173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:49:11.889073 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:49:11.889362 [info ] [MainThread]: 
[0m03:49:11.889715 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:49:11.890099 [info ] [MainThread]: 
[0m03:49:11.890417 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:49:11.890654 [info ] [MainThread]: 
[0m03:49:11.890901 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:49:11.893205 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.141387, "process_in_blocks": "0", "process_kernel_time": 0.313997, "process_mem_max_rss": "146604032", "process_out_blocks": "0", "process_user_time": 2.166323}
[0m03:49:11.893851 [debug] [MainThread]: Command `dbt snapshot` failed at 03:49:11.893733 after 5.14 seconds
[0m03:49:11.894237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062adb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa03c50>]}
[0m03:49:11.894547 [debug] [MainThread]: Flushing usage events
[0m03:49:12.238583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:01.454944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bbed0>]}


============================== 03:50:01.460797 | 1c80ca74-9193-4384-927b-300733f86386 ==============================
[0m03:50:01.460797 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:50:01.461451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:50:01.968196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113733bb0>]}
[0m03:50:02.017633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135de580>]}
[0m03:50:02.019485 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:50:02.127064 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:50:02.264955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:50:02.265484 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:50:02.515477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:50:02.525126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a3550>]}
[0m03:50:02.596924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:50:02.599565 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:50:02.615981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11372c230>]}
[0m03:50:02.616601 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:50:02.616921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d7230>]}
[0m03:50:02.618265 [info ] [MainThread]: 
[0m03:50:02.618578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:50:02.618880 [info ] [MainThread]: 
[0m03:50:02.619257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:50:02.619881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:50:02.673396 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:50:02.673756 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:50:02.674000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:03.259145 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.585 seconds
[0m03:50:03.265648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:50:03.276718 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:50:03.277353 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:50:03.393016 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.115 seconds
[0m03:50:03.396633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:50:03.401178 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:50:03.401592 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:50:03.517589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m03:50:03.521631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bebee0>]}
[0m03:50:03.527563 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:50:03.528278 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:50:03.528809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:50:03.529185 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:50:03.537971 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:50:03.586702 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:50:03.587101 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:50:03.716209 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.129 seconds
[0m03:50:03.724929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:50:03.726747 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:50:03.813315 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.084 seconds
[0m03:50:03.820379 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:50:03.820727 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:50:03.912776 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.092 seconds
[0m03:50:03.964834 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:50:03.965450 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2 ,
        
            row_id as dbt_unique_key_3
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2 ,
        
            row_id as dbt_unique_key_3
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(row_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2 ,
        
            row_id as dbt_unique_key_3
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_3 = source_data.dbt_unique_key_3)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."MA_7" != source_data."MA_7"
        or
        (
            ((snapshotted_data."MA_7" is null) and not (source_data."MA_7" is null))
            or
            ((not snapshotted_data."MA_7" is null) and (source_data."MA_7" is null))
        ) or snapshotted_data."MA_30" != source_data."MA_30"
        or
        (
            ((snapshotted_data."MA_30" is null) and not (source_data."MA_30" is null))
            or
            ((not snapshotted_data."MA_30" is null) and (source_data."MA_30" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:50:04.116338 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe12a-0305-0c98-0004-59ff002b8892
[0m03:50:04.116849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 32 at position 12
invalid identifier 'ROW_ID'
[0m03:50:04.124439 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 32 at position 12
  invalid identifier 'ROW_ID'
[0m03:50:04.126908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c80ca74-9193-4384-927b-300733f86386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d4a450>]}
[0m03:50:04.127734 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.60s]
[0m03:50:04.128271 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:50:04.128659 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 32 at position 12
  invalid identifier 'ROW_ID'.
[0m03:50:04.130152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:50:04.130444 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:50:04.130681 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:50:04.277136 [info ] [MainThread]: 
[0m03:50:04.277846 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m03:50:04.278786 [debug] [MainThread]: Command end result
[0m03:50:04.305182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:50:04.306572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:50:04.311090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:50:04.311345 [info ] [MainThread]: 
[0m03:50:04.311617 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:50:04.311845 [info ] [MainThread]: 
[0m03:50:04.312104 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 32 at position 12
  invalid identifier 'ROW_ID'
[0m03:50:04.312303 [info ] [MainThread]: 
[0m03:50:04.312510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:50:04.314489 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.9548914, "process_in_blocks": "0", "process_kernel_time": 0.555266, "process_mem_max_rss": "142508032", "process_out_blocks": "0", "process_user_time": 2.504501}
[0m03:50:04.314790 [debug] [MainThread]: Command `dbt snapshot` failed at 03:50:04.314725 after 2.96 seconds
[0m03:50:04.315057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d6ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114da5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114da5130>]}
[0m03:50:04.315300 [debug] [MainThread]: Flushing usage events
[0m03:50:04.772395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:51:02.905785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ae510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485fed0>]}


============================== 03:51:02.910830 | ac795bff-e491-4cc5-9620-cb4a00163e65 ==============================
[0m03:51:02.910830 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:51:02.911419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:51:03.318420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105763bb0>]}
[0m03:51:03.359935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105612580>]}
[0m03:51:03.360792 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:51:03.445647 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:51:03.578808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:51:03.579337 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:51:03.812338 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:51:03.821717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d3550>]}
[0m03:51:03.888750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:51:03.891266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:51:03.907416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575c230>]}
[0m03:51:03.907766 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:51:03.908014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c73310>]}
[0m03:51:03.909277 [info ] [MainThread]: 
[0m03:51:03.909527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:51:03.909722 [info ] [MainThread]: 
[0m03:51:03.910058 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:51:03.910642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:51:03.956246 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:51:03.956577 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:51:03.956808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:04.573486 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.616 seconds
[0m03:51:04.584383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:51:04.598618 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:51:04.599101 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:51:04.719389 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.120 seconds
[0m03:51:04.722481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:51:04.725696 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:51:04.726045 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:51:04.878739 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.152 seconds
[0m03:51:04.883561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c3ee0>]}
[0m03:51:04.888351 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:51:04.889119 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:51:04.889685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:51:04.890111 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:51:04.901111 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:51:04.951451 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:04.951824 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:51:05.155957 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.204 seconds
[0m03:51:05.169184 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:05.170789 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:51:05.296933 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m03:51:05.303494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:05.303851 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:51:05.397763 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.094 seconds
[0m03:51:05.440286 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:05.440800 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:51:06.307333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.865 seconds
[0m03:51:06.313643 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:06.314271 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:51:06.446858 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.132 seconds
[0m03:51:06.451718 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:06.452224 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:51:06.537577 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.085 seconds
[0m03:51:06.542711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:06.543354 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:51:06.667543 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.124 seconds
[0m03:51:06.674002 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:06.674630 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:51:06.763541 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m03:51:06.775476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:06.775978 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:51:06.876197 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.100 seconds
[0m03:51:06.899565 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:06.900124 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:51:07.046018 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.145 seconds
[0m03:51:07.051790 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:07.052292 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:51:07.146952 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m03:51:07.148175 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:07.151111 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:07.151704 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:51:07.272778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m03:51:07.273241 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:51:07.273559 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:51:14.578757 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe12b-0305-0c96-0004-59ff002ba836
[0m03:51:14.580561 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:51:14.590976 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:51:14.594551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac795bff-e491-4cc5-9620-cb4a00163e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22c90>]}
[0m03:51:14.596419 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 9.70s]
[0m03:51:14.597043 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:51:14.597788 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:51:14.600658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:14.600903 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:51:14.601139 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:51:14.737565 [info ] [MainThread]: 
[0m03:51:14.738052 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m03:51:14.738862 [debug] [MainThread]: Command end result
[0m03:51:14.765139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:51:14.767458 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:51:14.772514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:51:14.772786 [info ] [MainThread]: 
[0m03:51:14.773082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:51:14.773315 [info ] [MainThread]: 
[0m03:51:14.773583 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:51:14.773801 [info ] [MainThread]: 
[0m03:51:14.774013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:51:14.776327 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 11.9306345, "process_in_blocks": "0", "process_kernel_time": 0.361428, "process_mem_max_rss": "145506304", "process_out_blocks": "0", "process_user_time": 2.151808}
[0m03:51:14.776736 [debug] [MainThread]: Command `dbt snapshot` failed at 03:51:14.776639 after 11.93 seconds
[0m03:51:14.777166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a46a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba37f0>]}
[0m03:51:14.777448 [debug] [MainThread]: Flushing usage events
[0m03:51:15.121548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:52:03.220630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a96510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fbbed0>]}


============================== 03:52:03.225101 | 7b141e82-0620-4365-b0da-f0188832d1eb ==============================
[0m03:52:03.225101 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:52:03.225604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:52:03.629327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b133bb0>]}
[0m03:52:03.671695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12afe2580>]}
[0m03:52:03.672692 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:52:03.762325 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:52:03.891917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:52:03.892265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:52:03.896822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:52:03.972802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b09f750>]}
[0m03:52:04.040660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:52:04.043506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:52:04.059248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b12ed50>]}
[0m03:52:04.059623 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:52:04.060074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0f2270>]}
[0m03:52:04.061531 [info ] [MainThread]: 
[0m03:52:04.061838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:52:04.062063 [info ] [MainThread]: 
[0m03:52:04.062419 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:52:04.066221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:52:04.109956 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:52:04.110286 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:52:04.110520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:04.638818 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.528 seconds
[0m03:52:04.644054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:52:04.654753 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:52:04.655072 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:52:04.787148 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.132 seconds
[0m03:52:04.789197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:52:04.792243 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:52:04.792615 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:52:04.913801 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m03:52:04.918329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8e3110>]}
[0m03:52:04.924446 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:52:04.925263 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:52:04.925903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now model.dbt_lab2_1.lab2_stock_data)
[0m03:52:04.926358 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:52:04.940605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:52:04.942265 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:52:04.966902 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:52:04.967846 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:52:04.968164 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:52:05.549357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m03:52:05.575729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cef8a10>]}
[0m03:52:05.576494 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.65s]
[0m03:52:05.577714 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:52:05.578385 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:52:05.578830 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:52:05.579243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:52:05.579550 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:52:05.581666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:52:05.582711 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:52:05.602353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:52:05.603562 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:52:05.603932 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date
  );
[0m03:52:05.893542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m03:52:05.897718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b141e82-0620-4365-b0da-f0188832d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf05860>]}
[0m03:52:05.898821 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.32s]
[0m03:52:05.899664 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:52:05.901505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:52:05.901883 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:52:05.902239 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:52:06.036676 [info ] [MainThread]: 
[0m03:52:06.037634 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m03:52:06.039084 [debug] [MainThread]: Command end result
[0m03:52:06.064443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:52:06.066460 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:52:06.071233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:52:06.071521 [info ] [MainThread]: 
[0m03:52:06.071828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:52:06.072056 [info ] [MainThread]: 
[0m03:52:06.072293 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:52:06.074368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9151163, "process_in_blocks": "0", "process_kernel_time": 0.338817, "process_mem_max_rss": "141213696", "process_out_blocks": "0", "process_user_time": 1.872725}
[0m03:52:06.074673 [debug] [MainThread]: Command `dbt run` succeeded at 03:52:06.074607 after 2.92 seconds
[0m03:52:06.074976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce82850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce2f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc72bd0>]}
[0m03:52:06.075236 [debug] [MainThread]: Flushing usage events
[0m03:52:06.429167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:52:09.684114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abbed0>]}


============================== 03:52:09.688187 | ed4f2bae-eaec-4985-aafc-e87edb741167 ==============================
[0m03:52:09.688187 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:52:09.688653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:52:10.061971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e33bb0>]}
[0m03:52:10.108632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce2580>]}
[0m03:52:10.110269 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:52:10.338586 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:52:10.507961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:52:10.508577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:52:10.513587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:52:10.693207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d9f750>]}
[0m03:52:10.772592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:52:10.775354 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:52:10.804356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2ed50>]}
[0m03:52:10.805472 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:52:10.806351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df3770>]}
[0m03:52:10.808699 [info ] [MainThread]: 
[0m03:52:10.809628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:52:10.809975 [info ] [MainThread]: 
[0m03:52:10.810505 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:52:10.812058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:52:10.876035 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:52:10.876482 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:52:10.876997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:11.326455 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.449 seconds
[0m03:52:11.338551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:52:11.350674 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:52:11.351060 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:52:11.459885 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.108 seconds
[0m03:52:11.462706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:52:11.466689 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:52:11.467154 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:52:11.605695 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.138 seconds
[0m03:52:11.609253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ef040>]}
[0m03:52:11.613007 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:52:11.613725 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:52:11.614285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:52:11.614752 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:52:11.629117 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:52:11.693964 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:11.694384 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:52:11.893575 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.199 seconds
[0m03:52:11.910007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:11.911594 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:52:12.023065 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.110 seconds
[0m03:52:12.036075 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:12.036663 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:52:12.120257 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.083 seconds
[0m03:52:12.183089 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:12.183811 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:52:13.064993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m03:52:13.067695 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.067997 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:52:13.162160 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.094 seconds
[0m03:52:13.165012 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.165323 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:52:13.252412 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.087 seconds
[0m03:52:13.256354 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.256737 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:52:13.366014 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m03:52:13.373047 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.373638 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:52:13.460442 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.086 seconds
[0m03:52:13.472799 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.473320 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:52:13.560494 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.086 seconds
[0m03:52:13.586521 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.587105 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:52:13.840186 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.252 seconds
[0m03:52:13.847758 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.848397 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:52:13.937335 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m03:52:13.939029 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.942571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:13.943119 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:52:14.099796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m03:52:14.100626 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:52:14.101226 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:52:21.284558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe12c-0305-0bd9-0004-59ff002bb67e
[0m03:52:21.286077 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m03:52:21.295047 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:52:21.298407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed4f2bae-eaec-4985-aafc-e87edb741167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b699d0>]}
[0m03:52:21.299878 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 9.68s]
[0m03:52:21.300425 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:52:21.301569 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql.
[0m03:52:21.304344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:52:21.304602 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:52:21.304850 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:52:21.444683 [info ] [MainThread]: 
[0m03:52:21.445321 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m03:52:21.446075 [debug] [MainThread]: Command end result
[0m03:52:21.472369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:52:21.475418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:52:21.482643 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:52:21.482958 [info ] [MainThread]: 
[0m03:52:21.483297 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:52:21.483604 [info ] [MainThread]: 
[0m03:52:21.484766 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_lab2_1/snapshots/lab2_stock_data_snapshot.sql
[0m03:52:21.485043 [info ] [MainThread]: 
[0m03:52:21.485291 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:52:21.487748 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 11.852418, "process_in_blocks": "0", "process_kernel_time": 0.416594, "process_mem_max_rss": "126894080", "process_out_blocks": "0", "process_user_time": 2.176083}
[0m03:52:21.488176 [debug] [MainThread]: Command `dbt snapshot` failed at 03:52:21.488103 after 11.85 seconds
[0m03:52:21.489227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d02a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dbfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dbfa70>]}
[0m03:52:21.490434 [debug] [MainThread]: Flushing usage events
[0m03:52:21.840211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:55:38.954941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104442510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bbed0>]}


============================== 03:55:38.960239 | 20af0279-80e1-464b-8678-a38d4fcfc875 ==============================
[0m03:55:38.960239 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:55:38.960813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:55:39.380307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bbbb0>]}
[0m03:55:39.422044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e2580>]}
[0m03:55:39.422944 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:55:39.506012 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:55:39.659772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:55:39.660426 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:55:39.901311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:55:39.910492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106927550>]}
[0m03:55:39.984409 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:55:39.987307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:55:40.014180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b4230>]}
[0m03:55:40.014736 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:55:40.015008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adb230>]}
[0m03:55:40.016323 [info ] [MainThread]: 
[0m03:55:40.016617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:55:40.016827 [info ] [MainThread]: 
[0m03:55:40.017170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:55:40.017805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:55:40.069758 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:55:40.070110 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:55:40.070532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:40.564198 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.493 seconds
[0m03:55:40.572595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:55:40.581556 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:55:40.581948 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:55:40.719940 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m03:55:40.724311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:55:40.727799 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:55:40.728331 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:55:40.848440 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.120 seconds
[0m03:55:40.851345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa7860>]}
[0m03:55:40.853721 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:55:40.854213 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:55:40.854583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:55:40.854855 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:55:40.862083 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:55:40.910081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:40.910475 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:55:41.067255 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.155 seconds
[0m03:55:41.125433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:41.128904 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:55:41.292662 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.161 seconds
[0m03:55:41.308069 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:41.308941 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:55:41.394894 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.085 seconds
[0m03:55:41.458509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:41.459167 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:55:41.980329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m03:55:41.985687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:41.986307 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:55:42.098413 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.111 seconds
[0m03:55:42.105797 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.106412 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:55:42.222874 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m03:55:42.234631 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.235302 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:55:42.325839 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.090 seconds
[0m03:55:42.333772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.334505 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:55:42.439902 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.105 seconds
[0m03:55:42.447427 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.448095 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
alter table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" add column "ROW_ID" NUMBER(18,0);
[0m03:55:42.606288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m03:55:42.611463 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.612067 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:55:42.709020 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.096 seconds
[0m03:55:42.730571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.731075 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:55:42.903145 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.171 seconds
[0m03:55:42.909037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:42.909571 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:55:43.015798 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m03:55:43.016530 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:43.018062 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:43.018358 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:55:43.150982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m03:55:43.151799 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:43.152642 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:55:43.608491 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.455 seconds
[0m03:55:43.609635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:55:43.611361 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
COMMIT
[0m03:55:43.870819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m03:55:43.900680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20af0279-80e1-464b-8678-a38d4fcfc875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f49250>]}
[0m03:55:43.901963 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.lab2_stock_moving_avg_snapshot .................. [[32mSUCCESS 0[0m in 3.04s]
[0m03:55:43.902580 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:55:43.904450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:43.904725 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:55:43.904957 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:55:44.043678 [info ] [MainThread]: 
[0m03:55:44.044173 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m03:55:44.045054 [debug] [MainThread]: Command end result
[0m03:55:44.069950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:55:44.072462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:55:44.078715 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:55:44.079048 [info ] [MainThread]: 
[0m03:55:44.079401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:55:44.079626 [info ] [MainThread]: 
[0m03:55:44.079858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:55:44.082158 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.194711, "process_in_blocks": "0", "process_kernel_time": 0.431705, "process_mem_max_rss": "147111936", "process_out_blocks": "0", "process_user_time": 2.254069}
[0m03:55:44.082519 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:55:44.082450 after 5.20 seconds
[0m03:55:44.082908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c141c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c140f50>]}
[0m03:55:44.083177 [debug] [MainThread]: Flushing usage events
[0m03:55:44.448102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:56:15.548952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbed0>]}


============================== 03:56:15.553356 | c69d0665-c625-4a8e-a56b-aaf83e8bf83a ==============================
[0m03:56:15.553356 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:56:15.553851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:56:15.953529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbbbb0>]}
[0m03:56:15.994527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be2580>]}
[0m03:56:15.995524 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:56:16.084903 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:56:16.214999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:16.215526 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:56:16.460854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:56:16.470593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c27550>]}
[0m03:56:16.540424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:56:16.542758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:56:16.559291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb4230>]}
[0m03:56:16.559738 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:56:16.560099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aeb230>]}
[0m03:56:16.561367 [info ] [MainThread]: 
[0m03:56:16.561644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:56:16.561852 [info ] [MainThread]: 
[0m03:56:16.562197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:56:16.562813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:56:16.610809 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:56:16.611245 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:56:16.611534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:17.124281 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m03:56:17.132624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:56:17.142676 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:56:17.143167 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:56:17.284565 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m03:56:17.287744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:56:17.290797 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:56:17.291177 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:56:17.416289 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.124 seconds
[0m03:56:17.421849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abf860>]}
[0m03:56:17.426582 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:17.427390 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:56:17.427942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:56:17.428367 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:17.436119 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:17.490665 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:56:17.491163 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close, ma_7, ma_30 from (
                



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:56:17.593944 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe130-0305-0bb1-0004-59ff002b98be
[0m03:56:17.594384 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 22
invalid identifier 'MA_7'
[0m03:56:17.602548 [debug] [Thread-1 (]: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'
[0m03:56:17.604171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c69d0665-c625-4a8e-a56b-aaf83e8bf83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111249850>]}
[0m03:56:17.604857 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.lab2_stock_moving_avg_snapshot .............. [[31mERROR[0m in 0.18s]
[0m03:56:17.605310 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:17.605707 [debug] [Thread-4 (]: Marking all children of 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'.
[0m03:56:17.607009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:17.607249 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:56:17.607476 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:56:17.756596 [info ] [MainThread]: 
[0m03:56:17.757040 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m03:56:17.757616 [debug] [MainThread]: Command end result
[0m03:56:17.780324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:56:17.781875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:56:17.786538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:56:17.786801 [info ] [MainThread]: 
[0m03:56:17.787079 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:56:17.787297 [info ] [MainThread]: 
[0m03:56:17.787556 [error] [MainThread]:   Database Error in snapshot lab2_stock_moving_avg_snapshot (snapshots/lab2_stock_data_snapshot.sql)
  000904 (42000): SQL compilation error: error line 2 at position 22
  invalid identifier 'MA_7'
[0m03:56:17.787752 [info ] [MainThread]: 
[0m03:56:17.787961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:56:17.790039 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.302352, "process_in_blocks": "0", "process_kernel_time": 0.320999, "process_mem_max_rss": "145670144", "process_out_blocks": "0", "process_user_time": 1.948899}
[0m03:56:17.790399 [debug] [MainThread]: Command `dbt snapshot` failed at 03:56:17.790323 after 2.30 seconds
[0m03:56:17.790694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a1db0>]}
[0m03:56:17.791118 [debug] [MainThread]: Flushing usage events
[0m03:56:18.153232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:56:39.639369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107237c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107237ed0>]}


============================== 03:56:39.643738 | c94dd75e-227c-46e6-be08-874dc91d2d0d ==============================
[0m03:56:39.643738 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:56:39.644301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:56:40.044884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c94dd75e-227c-46e6-be08-874dc91d2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813bbb0>]}
[0m03:56:40.087051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c94dd75e-227c-46e6-be08-874dc91d2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fea580>]}
[0m03:56:40.088209 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:56:40.173505 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:56:40.303374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:40.303896 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:56:40.510640 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' (snapshots/lab2_stock_data_snapshot.sql) depends on a source named 'dev.lab2_stock_moving_avg' which was not found
[0m03:56:40.513917 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.9352661, "process_in_blocks": "0", "process_kernel_time": 0.269085, "process_mem_max_rss": "128892928", "process_out_blocks": "0", "process_user_time": 1.663678}
[0m03:56:40.514297 [debug] [MainThread]: Command `dbt snapshot` failed at 03:56:40.514218 after 0.94 seconds
[0m03:56:40.514629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108542210>]}
[0m03:56:40.514922 [debug] [MainThread]: Flushing usage events
[0m03:56:40.905298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:56:56.804469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c96510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbbed0>]}


============================== 03:56:56.808833 | 9d9bde26-daf7-4ab4-91b0-b0f18679c7fe ==============================
[0m03:56:56.808833 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:56:56.809387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:56:57.332729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106333bb0>]}
[0m03:56:57.388240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e2580>]}
[0m03:56:57.389341 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:56:57.506560 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:56:57.680497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:57.681333 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2_1://snapshots/lab2_stock_data_snapshot.sql
[0m03:56:58.106360 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:56:58.121949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629f550>]}
[0m03:56:58.321896 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:56:58.326351 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:56:58.365156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632c230>]}
[0m03:56:58.365741 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:56:58.366085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720b230>]}
[0m03:56:58.368038 [info ] [MainThread]: 
[0m03:56:58.368599 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:56:58.369163 [info ] [MainThread]: 
[0m03:56:58.369850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:56:58.370755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:56:58.453186 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:56:58.453824 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:56:58.454200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:58.973917 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.519 seconds
[0m03:56:58.988271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m03:56:59.004592 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:56:59.005012 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:56:59.125374 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m03:56:59.128346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m03:56:59.131594 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:56:59.132103 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:56:59.256788 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.124 seconds
[0m03:56:59.262437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071db860>]}
[0m03:56:59.267546 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:59.268331 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:56:59.268889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:56:59.269686 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:59.280504 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:56:59.356851 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:56:59.357296 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:56:59.498421 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.141 seconds
[0m03:56:59.506363 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:56:59.507398 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:56:59.601702 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.093 seconds
[0m03:56:59.608368 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:56:59.608760 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:56:59.690014 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.081 seconds
[0m03:56:59.736631 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:56:59.737171 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:57:00.358963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m03:57:00.366545 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:00.367116 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:57:00.471433 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.104 seconds
[0m03:57:00.477532 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:00.478136 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:57:00.580058 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.101 seconds
[0m03:57:00.585969 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:00.586594 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:57:00.701788 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.114 seconds
[0m03:57:00.708155 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:00.708810 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:57:00.815466 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.105 seconds
[0m03:57:00.832324 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:00.832768 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:57:00.929110 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.096 seconds
[0m03:57:00.969887 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:00.970484 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:01.254724 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.283 seconds
[0m03:57:01.260416 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:01.260981 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:01.347962 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m03:57:01.349621 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:01.352213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:01.352993 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:57:01.469483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m03:57:01.470064 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:01.470496 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:57:02.016586 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.545 seconds
[0m03:57:02.017710 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:02.018251 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
COMMIT
[0m03:57:02.368942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m03:57:02.403544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9bde26-daf7-4ab4-91b0-b0f18679c7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794a8d0>]}
[0m03:57:02.404582 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.lab2_stock_moving_avg_snapshot .................. [[32mSUCCESS 0[0m in 3.13s]
[0m03:57:02.405135 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:57:02.406526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:02.406829 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:57:02.407067 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:57:02.551563 [info ] [MainThread]: 
[0m03:57:02.552226 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m03:57:02.553073 [debug] [MainThread]: Command end result
[0m03:57:02.587064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:02.589712 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:02.595668 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:57:02.595924 [info ] [MainThread]: 
[0m03:57:02.596285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:02.596530 [info ] [MainThread]: 
[0m03:57:02.596851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:57:02.599061 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.8548326, "process_in_blocks": "0", "process_kernel_time": 0.525472, "process_mem_max_rss": "124567552", "process_out_blocks": "0", "process_user_time": 2.655023}
[0m03:57:02.599653 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:57:02.599552 after 5.86 seconds
[0m03:57:02.600047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796f540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a43d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a42fd0>]}
[0m03:57:02.600322 [debug] [MainThread]: Flushing usage events
[0m03:57:03.106237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:09.549571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106837c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106837ed0>]}


============================== 03:57:09.553844 | 9cf903ec-23c1-473a-80f9-28a142e138e7 ==============================
[0m03:57:09.553844 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:57:09.554319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:57:09.895478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773bbb0>]}
[0m03:57:09.937853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e6580>]}
[0m03:57:09.938749 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:57:10.024787 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:57:10.154017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:57:10.154384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:57:10.158848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m03:57:10.238237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ab750>]}
[0m03:57:10.303721 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:10.305889 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:10.322307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107736d50>]}
[0m03:57:10.322735 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:57:10.323006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fa270>]}
[0m03:57:10.324289 [info ] [MainThread]: 
[0m03:57:10.324559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:57:10.324764 [info ] [MainThread]: 
[0m03:57:10.325101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:57:10.329067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:57:10.373832 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:57:10.374180 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:57:10.374416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:10.886256 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.511 seconds
[0m03:57:10.892189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:57:10.906262 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:57:10.906793 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:57:11.071764 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.164 seconds
[0m03:57:11.074331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:57:11.077446 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:57:11.077799 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:57:11.192537 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m03:57:11.196966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b63110>]}
[0m03:57:11.201552 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:57:11.202345 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:57:11.202903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now model.dbt_lab2_1.lab2_stock_data)
[0m03:57:11.203336 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:57:11.217897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:57:11.219827 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:57:11.245957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:57:11.246937 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:57:11.247255 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:57:11.935342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m03:57:11.961493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a8a10>]}
[0m03:57:11.962227 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m03:57:11.962762 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:57:11.963414 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:11.963815 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:57:11.964198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:57:11.964478 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:11.966419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:57:11.967696 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:11.985343 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:57:11.986371 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:57:11.986723 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date
  );
[0m03:57:12.309243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.322 seconds
[0m03:57:12.314639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cf903ec-23c1-473a-80f9-28a142e138e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b1860>]}
[0m03:57:12.315821 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.35s]
[0m03:57:12.316729 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:12.318369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:12.318784 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:57:12.319134 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:57:12.485919 [info ] [MainThread]: 
[0m03:57:12.487047 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m03:57:12.488492 [debug] [MainThread]: Command end result
[0m03:57:12.519207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:12.520710 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:12.525421 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:57:12.525689 [info ] [MainThread]: 
[0m03:57:12.525994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:12.526211 [info ] [MainThread]: 
[0m03:57:12.526638 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:57:12.528326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.035153, "process_in_blocks": "0", "process_kernel_time": 0.283827, "process_mem_max_rss": "142147584", "process_out_blocks": "0", "process_user_time": 1.867099}
[0m03:57:12.528764 [debug] [MainThread]: Command `dbt run` succeeded at 03:57:12.528666 after 3.04 seconds
[0m03:57:12.529136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108932850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088df530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108722bd0>]}
[0m03:57:12.529424 [debug] [MainThread]: Flushing usage events
[0m03:57:12.865391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:17.649711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104396510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105247c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105247ed0>]}


============================== 03:57:17.653883 | f58fad32-afb8-4e94-88b7-cec275533e95 ==============================
[0m03:57:17.653883 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:57:17.654355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:57:18.028502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f58fad32-afb8-4e94-88b7-cec275533e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614bbb0>]}
[0m03:57:18.077335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f58fad32-afb8-4e94-88b7-cec275533e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ffa580>]}
[0m03:57:18.078810 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:57:18.172435 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:57:18.300750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:57:18.301089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:57:18.305394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:57:18.385451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58fad32-afb8-4e94-88b7-cec275533e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb750>]}
[0m03:57:18.460707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:18.462935 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:18.488405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58fad32-afb8-4e94-88b7-cec275533e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667d6d0>]}
[0m03:57:18.488777 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:57:18.489044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58fad32-afb8-4e94-88b7-cec275533e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffd710>]}
[0m03:57:18.490154 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:57:18.491509 [debug] [MainThread]: Command end result
[0m03:57:18.510690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:18.511858 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:18.514098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:57:18.515660 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.91585964, "process_in_blocks": "0", "process_kernel_time": 0.247012, "process_mem_max_rss": "129859584", "process_out_blocks": "0", "process_user_time": 1.609844}
[0m03:57:18.515997 [debug] [MainThread]: Command `dbt test` succeeded at 03:57:18.515927 after 0.92 seconds
[0m03:57:18.516267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107007ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106631c10>]}
[0m03:57:18.516525 [debug] [MainThread]: Flushing usage events
[0m03:57:18.856312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:21.636589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108983c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108983ed0>]}


============================== 03:57:21.639967 | a08959ce-2c12-42e6-87ec-fa74288d4558 ==============================
[0m03:57:21.639967 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:57:21.640430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:57:21.906080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109887bb0>]}
[0m03:57:21.950172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109736580>]}
[0m03:57:21.950938 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:57:22.041732 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:57:22.141997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:57:22.142336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:57:22.146530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:57:22.220448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f7750>]}
[0m03:57:22.286901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:22.289085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:22.298751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109882d50>]}
[0m03:57:22.299122 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:57:22.299379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109846270>]}
[0m03:57:22.300605 [info ] [MainThread]: 
[0m03:57:22.300859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:57:22.301074 [info ] [MainThread]: 
[0m03:57:22.301415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:57:22.304592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:57:22.346576 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:57:22.346888 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:57:22.347117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:22.869415 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.522 seconds
[0m03:57:22.873401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:57:22.887866 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:57:22.888366 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:57:23.039631 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.151 seconds
[0m03:57:23.044804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:57:23.049742 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:57:23.050355 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:57:23.175384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m03:57:23.180685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109caf110>]}
[0m03:57:23.185165 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m03:57:23.186002 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m03:57:23.186565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now model.dbt_lab2_1.lab2_stock_data)
[0m03:57:23.187003 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m03:57:23.202978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:57:23.203735 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m03:57:23.227832 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m03:57:23.228663 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m03:57:23.228952 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m03:57:23.975225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m03:57:24.006017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaeca10>]}
[0m03:57:24.006695 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 0.82s]
[0m03:57:24.007227 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m03:57:24.007945 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:24.008440 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m03:57:24.008910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m03:57:24.009164 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:24.011177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:57:24.012071 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:24.028463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:57:24.029355 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m03:57:24.029631 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date
  );
[0m03:57:24.377675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m03:57:24.381760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08959ce-2c12-42e6-87ec-fa74288d4558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab01860>]}
[0m03:57:24.382768 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.37s]
[0m03:57:24.383555 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m03:57:24.385009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:24.385442 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m03:57:24.385917 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m03:57:24.615092 [info ] [MainThread]: 
[0m03:57:24.615806 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m03:57:24.617027 [debug] [MainThread]: Command end result
[0m03:57:24.645227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:24.646667 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:24.651033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:57:24.651297 [info ] [MainThread]: 
[0m03:57:24.651594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:24.651815 [info ] [MainThread]: 
[0m03:57:24.652053 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:57:24.653849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0630007, "process_in_blocks": "0", "process_kernel_time": 0.250666, "process_mem_max_rss": "143425536", "process_out_blocks": "0", "process_user_time": 1.808811}
[0m03:57:24.654197 [debug] [MainThread]: Command `dbt run` succeeded at 03:57:24.654107 after 3.06 seconds
[0m03:57:24.654506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa7e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107102fd0>]}
[0m03:57:24.654789 [debug] [MainThread]: Flushing usage events
[0m03:57:24.990128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:30.071592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cee510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bbed0>]}


============================== 03:57:30.075046 | b6917c14-0ef9-49dd-af30-970d2fe5e1a5 ==============================
[0m03:57:30.075046 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:57:30.075506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:57:30.357402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbbbb0>]}
[0m03:57:30.399764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be2580>]}
[0m03:57:30.400721 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:57:30.489859 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:57:30.592061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:57:30.592397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:57:30.596644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m03:57:30.689785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c2b750>]}
[0m03:57:30.771165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:30.773492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:30.785575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cb6d50>]}
[0m03:57:30.786046 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m03:57:30.786364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7b770>]}
[0m03:57:30.787667 [info ] [MainThread]: 
[0m03:57:30.787935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:57:30.788139 [info ] [MainThread]: 
[0m03:57:30.788481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:57:30.789089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m03:57:30.831552 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m03:57:30.831903 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m03:57:30.832139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:31.403830 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.572 seconds
[0m03:57:31.408830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_dev)
[0m03:57:31.417393 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m03:57:31.417684 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m03:57:31.544313 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.126 seconds
[0m03:57:31.546438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now list_USER_DB_MARMOT_snapshot)
[0m03:57:31.548889 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m03:57:31.549162 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m03:57:31.654310 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m03:57:31.656685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106feb040>]}
[0m03:57:31.659150 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:57:31.660277 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m03:57:31.661000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m03:57:31.661627 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:57:31.674530 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:57:31.744846 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:31.745438 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:31.988817 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.243 seconds
[0m03:57:31.999124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:32.000536 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:57:32.098511 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.097 seconds
[0m03:57:32.114572 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:32.115071 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:57:32.218785 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.103 seconds
[0m03:57:32.274711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:32.275285 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:57:32.934316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m03:57:32.938990 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:32.939618 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:57:33.033038 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.093 seconds
[0m03:57:33.038163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.038744 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:57:33.177320 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.138 seconds
[0m03:57:33.183014 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.183553 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:57:33.292842 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.109 seconds
[0m03:57:33.299967 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.301318 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m03:57:33.391384 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.089 seconds
[0m03:57:33.403848 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.404324 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m03:57:33.486850 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.082 seconds
[0m03:57:33.512297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.513037 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:33.798126 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.284 seconds
[0m03:57:33.804128 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.804700 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:57:33.891026 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m03:57:33.891823 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.893672 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:33.894033 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m03:57:34.010372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m03:57:34.011568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:34.012291 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:57:34.547558 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.534 seconds
[0m03:57:34.548873 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m03:57:34.549696 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
COMMIT
[0m03:57:34.991666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m03:57:35.027923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6917c14-0ef9-49dd-af30-970d2fe5e1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f69fd0>]}
[0m03:57:35.029478 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.lab2_stock_moving_avg_snapshot .................. [[32mSUCCESS 0[0m in 3.36s]
[0m03:57:35.030344 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m03:57:35.032391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:35.032739 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m03:57:35.033035 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m03:57:35.193030 [info ] [MainThread]: 
[0m03:57:35.194650 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m03:57:35.196132 [debug] [MainThread]: Command end result
[0m03:57:35.249816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m03:57:35.254479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m03:57:35.260372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m03:57:35.260701 [info ] [MainThread]: 
[0m03:57:35.261093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:35.261355 [info ] [MainThread]: 
[0m03:57:35.261622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:57:35.264028 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.2411027, "process_in_blocks": "0", "process_kernel_time": 0.31942, "process_mem_max_rss": "141033472", "process_out_blocks": "0", "process_user_time": 2.024846}
[0m03:57:35.264446 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:57:35.264357 after 5.24 seconds
[0m03:57:35.264909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117001d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170a4870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170a5950>]}
[0m03:57:35.265243 [debug] [MainThread]: Flushing usage events
[0m03:57:35.605808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:40.333390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111396510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126bbed0>]}


============================== 02:19:40.385913 | a102f3ed-7707-45f4-9326-ed387e1a3fef ==============================
[0m02:19:40.385913 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:19:40.386284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:19:41.125414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c13bb0>]}
[0m02:19:41.149188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e2580>]}
[0m02:19:41.149744 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:19:41.209879 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:19:41.296859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:19:41.297042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:19:41.299579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:19:41.349926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b83750>]}
[0m02:19:41.393380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:19:41.395159 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:19:41.406745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c0ed50>]}
[0m02:19:41.406964 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m02:19:41.407122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bd2270>]}
[0m02:19:41.407887 [info ] [MainThread]: 
[0m02:19:41.408054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:41.408175 [info ] [MainThread]: 
[0m02:19:41.408379 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:19:41.410253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:19:41.446682 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:19:41.446940 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:19:41.447098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:42.178667 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.731 seconds
[0m02:19:42.183700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m02:19:42.199367 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m02:19:42.199834 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m02:19:42.319359 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m02:19:42.322823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m02:19:42.326646 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:19:42.327125 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:19:42.472989 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.145 seconds
[0m02:19:42.478200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169e3110>]}
[0m02:19:42.481853 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_data
[0m02:19:42.482520 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.lab2_stock_data ............................... [RUN]
[0m02:19:42.483063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now model.dbt_lab2_1.lab2_stock_data)
[0m02:19:42.483475 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_data
[0m02:19:42.493234 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:19:42.494609 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_data
[0m02:19:42.517666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_data"
[0m02:19:42.518342 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_data"
[0m02:19:42.518577 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_data"} */
create or replace transient table USER_DB_MARMOT.dev.lab2_stock_data
         as
        (

-- Select relevant columns from the stock data source
select
    symbol,
    date,
    open,
    close,
    high,
    low,
    volume
from
    USER_DB_MARMOT.dev.lab2_stock_data  -- Ensure the source name and table match your source definition
        );
[0m02:19:43.523168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m02:19:43.551496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f89190>]}
[0m02:19:43.552281 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.lab2_stock_data .......................... [[32mSUCCESS 1[0m in 1.07s]
[0m02:19:43.552798 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_data
[0m02:19:43.553751 [debug] [Thread-1 (]: Began running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:19:43.554286 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.lab2_stock_moving_avg .......................... [RUN]
[0m02:19:43.554703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2_1.lab2_stock_data, now model.dbt_lab2_1.lab2_stock_moving_avg)
[0m02:19:43.555006 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:19:43.557174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:19:43.558127 [debug] [Thread-1 (]: Began executing node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:19:43.574465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:19:43.576584 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2_1.lab2_stock_moving_avg"
[0m02:19:43.576889 [debug] [Thread-1 (]: On model.dbt_lab2_1.lab2_stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "model.dbt_lab2_1.lab2_stock_moving_avg"} */
create or replace   view USER_DB_MARMOT.dev.lab2_stock_moving_avg
  
   as (
    SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30
FROM USER_DB_MARMOT.dev.lab2_stock_data
ORDER BY symbol, date
  );
[0m02:19:43.929007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m02:19:43.932683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a102f3ed-7707-45f4-9326-ed387e1a3fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fda150>]}
[0m02:19:43.933547 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.lab2_stock_moving_avg ..................... [[32mSUCCESS 1[0m in 0.38s]
[0m02:19:43.934332 [debug] [Thread-1 (]: Finished running node model.dbt_lab2_1.lab2_stock_moving_avg
[0m02:19:43.935875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:43.936320 [debug] [MainThread]: Connection 'model.dbt_lab2_1.lab2_stock_moving_avg' was left open.
[0m02:19:43.936744 [debug] [MainThread]: On model.dbt_lab2_1.lab2_stock_moving_avg: Close
[0m02:19:44.107876 [info ] [MainThread]: 
[0m02:19:44.108926 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m02:19:44.110279 [debug] [MainThread]: Command end result
[0m02:19:44.139277 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:19:44.141079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:19:44.145611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:19:44.145867 [info ] [MainThread]: 
[0m02:19:44.146171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:19:44.146367 [info ] [MainThread]: 
[0m02:19:44.146591 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:19:44.164985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8756518, "process_in_blocks": "0", "process_kernel_time": 0.285553, "process_mem_max_rss": "145866752", "process_out_blocks": "0", "process_user_time": 1.284016}
[0m02:19:44.165324 [debug] [MainThread]: Command `dbt run` succeeded at 02:19:44.165261 after 3.88 seconds
[0m02:19:44.165624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ea3cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fd6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b2a50>]}
[0m02:19:44.165852 [debug] [MainThread]: Flushing usage events
[0m02:19:44.612336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:47.866516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbbed0>]}


============================== 02:19:47.869479 | 0f18d5f7-6ca6-418c-94b5-9e10c6b858e5 ==============================
[0m02:19:47.869479 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:19:47.869833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:19:48.118155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f18d5f7-6ca6-418c-94b5-9e10c6b858e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bbbb0>]}
[0m02:19:48.142042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f18d5f7-6ca6-418c-94b5-9e10c6b858e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e2580>]}
[0m02:19:48.142606 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:19:48.193060 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:19:48.278060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:19:48.278257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:19:48.280741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.input
- models.dbt_lab2_1.output
[0m02:19:48.330695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f18d5f7-6ca6-418c-94b5-9e10c6b858e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892b750>]}
[0m02:19:48.369286 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:19:48.370715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:19:48.391419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f18d5f7-6ca6-418c-94b5-9e10c6b858e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099216d0>]}
[0m02:19:48.391721 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m02:19:48.391980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f18d5f7-6ca6-418c-94b5-9e10c6b858e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109971710>]}
[0m02:19:48.392785 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:19:48.393662 [debug] [MainThread]: Command end result
[0m02:19:48.408540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:19:48.409462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:19:48.411005 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:19:48.411859 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5745136, "process_in_blocks": "0", "process_kernel_time": 0.161501, "process_mem_max_rss": "130449408", "process_out_blocks": "0", "process_user_time": 0.945473}
[0m02:19:48.412082 [debug] [MainThread]: Command `dbt test` succeeded at 02:19:48.412042 after 0.57 seconds
[0m02:19:48.412256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997bba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d5c10>]}
[0m02:19:48.412423 [debug] [MainThread]: Flushing usage events
[0m02:19:48.755619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:56.748976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107baa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a57c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a57ed0>]}


============================== 02:19:56.751814 | 229efaf0-5d5c-43cf-b4b3-783c48e04dcf ==============================
[0m02:19:56.751814 [info ] [MainThread]: Running with dbt=1.9.3
[0m02:19:56.752122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:57.003159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995bbb0>]}
[0m02:19:57.032180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980a580>]}
[0m02:19:57.032945 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:19:57.098170 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m02:19:57.190963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:19:57.191202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:19:57.193866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab2_1.output
- models.dbt_lab2_1.input
[0m02:19:57.248114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cb750>]}
[0m02:19:57.286550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:19:57.287920 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:19:57.299552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109956d50>]}
[0m02:19:57.299779 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 474 macros
[0m02:19:57.299938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991b770>]}
[0m02:19:57.300702 [info ] [MainThread]: 
[0m02:19:57.300863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:57.300983 [info ] [MainThread]: 
[0m02:19:57.301192 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:19:57.301569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MARMOT'
[0m02:19:57.330113 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT"
[0m02:19:57.330350 [debug] [ThreadPool]: On list_USER_DB_MARMOT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT"} */
show terse schemas in database USER_DB_MARMOT
    limit 10000
[0m02:19:57.330492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:57.760014 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.429 seconds
[0m02:19:57.782870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT, now list_USER_DB_MARMOT_snapshot)
[0m02:19:57.809679 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_snapshot"
[0m02:19:57.810270 [debug] [ThreadPool]: On list_USER_DB_MARMOT_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_snapshot"} */
show objects in USER_DB_MARMOT.snapshot limit 10000;
[0m02:19:57.914690 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m02:19:57.917565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_snapshot, now list_USER_DB_MARMOT_dev)
[0m02:19:57.920778 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MARMOT_dev"
[0m02:19:57.921227 [debug] [ThreadPool]: On list_USER_DB_MARMOT_dev: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "connection_name": "list_USER_DB_MARMOT_dev"} */
show objects in USER_DB_MARMOT.dev limit 10000;
[0m02:19:58.031192 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.109 seconds
[0m02:19:58.035804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898b040>]}
[0m02:19:58.039059 [debug] [Thread-1 (]: Began running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m02:19:58.039721 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.lab2_stock_moving_avg_snapshot .................. [RUN]
[0m02:19:58.040257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MARMOT_dev, now snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot)
[0m02:19:58.040685 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m02:19:58.054298 [debug] [Thread-1 (]: Began executing node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m02:19:58.098066 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:58.098351 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select close from (
                



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m02:19:58.309591 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.211 seconds
[0m02:19:58.322077 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:58.323335 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m02:19:58.415422 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.091 seconds
[0m02:19:58.428322 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:58.428884 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m02:19:58.534731 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.105 seconds
[0m02:19:58.583552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:58.583915 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
create or replace temporary table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m02:19:59.597388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m02:19:59.602563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:59.603151 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m02:19:59.686827 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.083 seconds
[0m02:19:59.690747 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:59.691115 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m02:19:59.771889 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.080 seconds
[0m02:19:59.773750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:59.773938 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m02:19:59.879417 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.105 seconds
[0m02:19:59.882280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:59.882549 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
[0m02:19:59.966815 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.084 seconds
[0m02:19:59.975099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:19:59.975515 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
describe table "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp"
[0m02:20:00.057037 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.081 seconds
[0m02:20:00.078539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:20:00.078887 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT 
    *,
    ROW_NUMBER() OVER (PARTITION BY symbol, date ORDER BY date) AS row_id
FROM USER_DB_MARMOT.dev.lab2_stock_data


    ),

    snapshotted_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    

        from "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        
            symbol as dbt_unique_key_1 ,
        
            date as dbt_unique_key_2
        
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

            where 
    
        snapshotted_data.dbt_unique_key_1 is null
    

            or (
    
        snapshotted_data.dbt_unique_key_1 is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        
	    
	    
	    (snapshotted_data.dbt_unique_key_1 = source_data.dbt_unique_key_1)
 and
        
	    
	    
	    (snapshotted_data.dbt_unique_key_2 = source_data.dbt_unique_key_2)

        
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m02:20:00.217862 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.138 seconds
[0m02:20:00.221558 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:20:00.222051 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:20:00.306623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m02:20:00.307670 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:20:00.310030 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:20:00.310491 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
BEGIN
[0m02:20:00.439100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m02:20:00.440037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:20:00.440705 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
merge into "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MARMOT"."SNAPSHOT"."LAB2_STOCK_MOVING_AVG_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "HIGH", "LOW", "VOLUME", "ROW_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:20:01.132017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m02:20:01.132908 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"
[0m02:20:01.133456 [debug] [Thread-1 (]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_lab2_1", "target_name": "dev", "node_id": "snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot"} */
COMMIT
[0m02:20:01.440759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m02:20:01.468788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '229efaf0-5d5c-43cf-b4b3-783c48e04dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab35fd0>]}
[0m02:20:01.469999 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.lab2_stock_moving_avg_snapshot .................. [[32mSUCCESS 1[0m in 3.43s]
[0m02:20:01.470607 [debug] [Thread-1 (]: Finished running node snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot
[0m02:20:01.472145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:01.472398 [debug] [MainThread]: Connection 'snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot' was left open.
[0m02:20:01.472628 [debug] [MainThread]: On snapshot.dbt_lab2_1.lab2_stock_moving_avg_snapshot: Close
[0m02:20:01.617398 [info ] [MainThread]: 
[0m02:20:01.618265 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m02:20:01.619575 [debug] [MainThread]: Command end result
[0m02:20:01.646857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/manifest.json
[0m02:20:01.648804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/semantic_manifest.json
[0m02:20:01.653655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/leali/Downloads/226/sjsu-data226-SP25/dbt_lab2_1/target/run_results.json
[0m02:20:01.653914 [info ] [MainThread]: 
[0m02:20:01.654191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:01.654383 [info ] [MainThread]: 
[0m02:20:01.654586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:20:01.656572 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.942872, "process_in_blocks": "0", "process_kernel_time": 0.220886, "process_mem_max_rss": "143343616", "process_out_blocks": "0", "process_user_time": 1.351058}
[0m02:20:01.656888 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:20:01.656832 after 4.94 seconds
[0m02:20:01.657170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac70230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac71950>]}
[0m02:20:01.657351 [debug] [MainThread]: Flushing usage events
[0m02:20:01.991971 [debug] [MainThread]: An error was encountered while trying to flush usage events
